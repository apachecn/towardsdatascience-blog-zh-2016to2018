# åœ¨ Python ä¸­æå–å’Œè½¬æ¢æ•°æ®

> åŸæ–‡ï¼š<https://towardsdatascience.com/extracting-and-transforming-data-in-python-63291f63d350?source=collection_archive---------8----------------------->

![](img/fcfc11b4a63659dc29a0446620531267.png)

[(Source)](https://unsplash.com/photos/ZGnC2gOvzKw)

## ä¸ºäº†ä»æ•°æ®ä¸­è·å¾—æ´å¯ŸåŠ›ï¼Œä½ å¿…é¡»å¯¹å®ƒç¨åŠ å¤„ç†..

é‡è¦çš„æ˜¯èƒ½å¤Ÿä»æ•°æ®å¸§ä¸­æå–ã€è¿‡æ»¤å’Œè½¬æ¢æ•°æ®ï¼Œä»¥ä¾¿æ·±å…¥åˆ°çœŸæ­£é‡è¦çš„æ•°æ®ä¸­ã€‚ç†ŠçŒ«å›¾ä¹¦é¦†æœ‰è®¸å¤šæŠ€æœ¯ä½¿è¿™ä¸€è¿‡ç¨‹é«˜æ•ˆè€Œç›´è§‚ã€‚åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘å°†åˆ—å‡ºè¿™äº›æŠ€æœ¯ï¼Œå¹¶é™„æœ‰ä»£ç ç¤ºä¾‹å’Œä¸€äº›è§£é‡Šã€‚è®©æˆ‘ä»¬å¼€å§‹å§ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ç”¨éšæœºæ•°åˆ›å»ºäº†ä¸€ä¸ªæ ·æœ¬æ•°æ®å¸§æ¥ç©å®ƒã€‚åœ¨æœ¬æ–‡çš„è§£é‡Šè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›æ•°æ®ä½œä¸ºä¾‹å­ã€‚

```
import pandas as pd
import numpy as np
cols = ['col0', 'col1', 'col2', 'col3', 'col4']
rows = ['row0', 'row1', 'row2', 'row3', 'row4']
data = np.random.randint(0, 100, size=(5, 5))
df = pd.DataFrame(data, columns=cols, index=rows)df.head()**Out[2]: 
      col0  col1  col2  col3  col4
row0    24    78    42     7    96
row1    40     4    80    12    84
row2    83    17    80    26    15
row3    92    68    58    93    33
row4    78    63    35    70    95**
```

# ç´¢å¼•æ•°æ®å¸§

ä¸ºäº†ä» pandas æ•°æ®å¸§ä¸­æå–æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›´æ¥ç´¢å¼•æˆ–è®¿é—®å™¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å¿…è¦çš„è¡Œå’Œåˆ—:

```
df['col1']['row1']**Out[3]: 4**
```

è¯·æ³¨æ„è¿™ç§ç´¢å¼•çš„é¡ºåº:é¦–å…ˆæŒ‡å®šåˆ—æ ‡ç­¾ï¼Œç„¶åæŒ‡å®šè¡Œã€‚ä½†äº‹å®æ˜¯ï¼Œæ•°æ®é›†å¾ˆå°‘ï¼Œè€Œä¸”å¾ˆå°ï¼Œè€Œåœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æœºå™¨è¦é‡å¾—å¤šã€‚ä½¿ç”¨è®¿é—®å™¨â€” *æ¥é€‰æ‹©æ•°æ®è¦å¥½å¾—å¤šã€‚é”å®š*å’Œ*ã€‚iloc* ã€‚ä»–ä»¬çš„åŒºåˆ«åœ¨äº*ã€‚loc* æ¥å—æ ‡ç­¾ï¼Œè€Œ*æ¥å—æ ‡ç­¾ã€‚iloc* â€”ç´¢å¼•ã€‚åŒæ ·ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨è®¿é—®å™¨æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆæŒ‡å®šè¡Œï¼Œç„¶åæŒ‡å®šåˆ—ã€‚ä¸€å¼€å§‹æˆ‘å¾ˆéš¾é€‚åº”å®ƒâ€”â€”SQL èƒŒæ™¯ï¼Œä½ è¿˜èƒ½è¯´ä»€ä¹ˆ..

![](img/976e1b03f91603fc0ac973eb46c91a6b.png)

å› æ­¤ï¼Œè¦ä½¿ç”¨è®¿é—®å™¨é€‰æ‹©å•ä¸ªå€¼ï¼Œæ‚¨éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œ:

```
df.loc['row4', 'col2']
**Out[4]: 35** df.iloc[4, 2]
**Out[5]: 35**
```

ä½¿ç”¨ç´¢å¼•ï¼Œæˆ‘ä»¬å¯ä»¥ä»æ•°æ®å¸§ä¸­é€‰æ‹©å•ä¸ªå€¼ã€ç³»åˆ—æˆ–æ•°æ®å¸§(æŠ±æ­‰ï¼Œè¿™æ˜¯åŒä¹‰åå¤)ã€‚ä¸Šé¢æˆ‘å·²ç»å±•ç¤ºäº†å¦‚ä½•é€‰æ‹©ä¸€ä¸ªå€¼ã€‚

è¦å†é€‰æ‹©å‡ åˆ—ï¼Œåªéœ€ä¼ é€’å…¶æ ‡ç­¾çš„åµŒå¥—åˆ—è¡¨ï¼ŒDataFrame å°†è¢«è¿”å›:

```
df_new = df[['col1','col2']]
df_new.head(3)

**Out[6]: 
      col1  col2
row0    78    42
row1     4    80
row2    17    80**
```

å¦‚æœæ‚¨è¿˜æƒ³é€‰æ‹©ç‰¹å®šçš„è¡Œï¼Œæ·»åŠ å®ƒçš„ç´¢å¼•ï¼Œæ‚¨å°†å†æ¬¡è·å¾—ä¸€ä¸ªæ•°æ®å¸§ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºåˆ‡ç‰‡ï¼Œä¸‹é¢ä¼šæœ‰æ›´è¯¦ç»†çš„ä»‹ç»ã€‚

```
df_new = df[['col1','col2']][1:4]
df_new.head(3)

**Out[7]: 
      col1  col2
row1     4    80
row2    17    80
row3    68    58**
```

è¦é€‰æ‹©ä¸€ä¸ªç³»åˆ—ï¼Œæ‚¨å¿…é¡»é€‰æ‹©åŒ…å«æ‰€æœ‰è¡Œæˆ–ä¸€ç³»åˆ—è¡Œçš„å•ä¸ªåˆ—ã€‚æ¯ä¸€è¡Œä»£ç éƒ½ä¼šäº§ç”Ÿç›¸åŒçš„è¾“å‡º:

```
df['col0']
df.loc[:,'col0']
df.iloc[:, 0]

**Out[8]: 
row0    24
row1    40
row2    83
row3    92
row4    78
Name: col0, dtype: int32**
```

å†’å·æ„å‘³ç€æˆ‘ä»¬è¦é€‰æ‹©æ‰€æœ‰è¡Œæˆ–æ‰€æœ‰åˆ—â€” *df.loc[:ï¼Œ:]* æˆ– *df.iloc[:ï¼Œ:]* å°†è¿”å›æ‰€æœ‰å€¼ã€‚æ…¢æ…¢åœ°ï¼Œæˆ‘ä»¬è¿›å…¥äº†åˆ‡ç‰‡é˜¶æ®µâ€”â€”ä»æ•°æ®ä¸­é€‰æ‹©ç‰¹å®šçš„èŒƒå›´ã€‚è¦å¯¹ä¸€ä¸ªç³»åˆ—è¿›è¡Œåˆ‡ç‰‡ï¼Œæ‚¨åªéœ€æ·»åŠ è¦ä½¿ç”¨å…¶ç´¢å¼•é€‰æ‹©çš„ä¸€ç³»åˆ—è¡Œ:

```
df['col3'][2:5]

**Out[12]: 
row2    26
row3    93
row4    70
Name: col3, dtype: int32**
```

ä¸è¦å¿˜è®° Python ä¸­çš„èŒƒå›´â€”â€”ç¬¬ä¸€ä¸ªå…ƒç´ è¢«åŒ…å«ï¼Œç¬¬äºŒä¸ªè¢«æ’é™¤ã€‚æ‰€ä»¥ä¸Šé¢çš„ä»£ç å°†è¿”å›ç´¢å¼•ä¸º 5ã€6ã€7ã€8 å’Œ 9 çš„è¡Œã€‚ç´¢å¼•ä» 0 å¼€å§‹ã€‚

![](img/76a1f3aeab2ff73ee6a03bc686b9ff30.png)

åˆ‡ç‰‡æ•°æ®å¸§çš„å·¥ä½œæ–¹å¼ç›¸åŒã€‚åªæœ‰ä¸€ä¸ªç»†å¾®çš„å·®åˆ«ã€‚ä½¿ç”¨*æ—¶ã€‚loc* (æ ‡ç­¾)åŒ…æ‹¬ä¸¤ä¸ªè¾¹æ¡†ã€‚ä¾‹å¦‚ï¼Œé€‰æ‹©ä»æ ‡ç­¾â€œè¡Œ 1â€åˆ°æ ‡ç­¾â€œè¡Œ 4â€çš„è¡Œæˆ–ä»è¡Œç´¢å¼• 1 åˆ°ç´¢å¼• 4 çš„è¡Œä»¥åŠæ‰€æœ‰åˆ—:

```
df.loc['row1':'row4', :]
**Out[20]: 
      col0  col1  col2  col3  col4
row1    40     4    80    12    84
row2    83    17    80    26    15
row3    92    68    58    93    33
row4    78    63    35    70    95** df.iloc[1:4, :]
**Out[21]: 
      col0  col1  col2  col3  col4
row1    40     4    80    12    84
row2    83    17    80    26    15
row3    92    68    58    93    33**
```

ä¸Šé¢çš„ç¬¬ä¸€è¡Œä»£ç é€‰æ‹©äº† row1ã€row2ã€row3 å’Œ row4ã€‚è€Œç¬¬äºŒä¸ªâ€”ä»…è¡Œ 1ã€è¡Œ 2 å’Œè¡Œ 3ã€‚ä¸‹é¢å†ä¸¾å‡ ä¸ªä¾‹å­ã€‚

é€‰æ‹©ä»æ ‡ç­¾â€œåˆ— 1â€åˆ°æ ‡ç­¾â€œåˆ— 4â€æˆ–ä»åˆ—ç´¢å¼• 1 åˆ°ç´¢å¼• 4 çš„åˆ—ä»¥åŠæ‰€æœ‰è¡Œ:

```
df.loc[:, 'col1':'col4']
**Out[22]: 
      col1  col2  col3  col4
row0    78    42     7    96
row1     4    80    12    84
row2    17    80    26    15
row3    68    58    93    33
row4    63    35    70    95** df.iloc[:, 1:4]
**Out[23]: 
      col1  col2  col3
row0    78    42     7
row1     4    80    12
row2    17    80    26
row3    68    58    93
row4    63    35    70**
```

é€‰æ‹©ä»æ ‡ç­¾â€œè¡Œ 1â€åˆ°æ ‡ç­¾â€œè¡Œ 4â€æˆ–ä»è¡Œç´¢å¼• 1 åˆ°ç´¢å¼• 4 çš„è¡Œï¼Œä»¥åŠä»æ ‡ç­¾â€œåˆ— 1â€åˆ°æ ‡ç­¾â€œåˆ— 4â€æˆ–ä»åˆ—ç´¢å¼• 1 åˆ°ç´¢å¼• 4 çš„åˆ—:

```
df.loc['row1':'row4', 'col1':'col4']
**Out[24]: 
      col1  col2  col3  col4
row1     4    80    12    84
row2    17    80    26    15
row3    68    58    93    33
row4    63    35    70    95** df.iloc[1:4,1:4] **Out[25]: 
      col1  col2  col3
row1     4    80    12
row2    17    80    26
row3    68    58    93**
```

ä½¿ç”¨åˆ—è¡¨é€‰æ‹©ä¸åœ¨èŒƒå›´å†…çš„ç‰¹å®šåˆ—æˆ–è¡Œã€‚

```
df.loc['row2':'row4', ['col1','col3']]
**Out[28]: 
      col1  col3
row2    17    26
row3    68    93
row4    63    70** df.iloc[[2,4], 0:4]
**Out[30]: 
      col0  col1  col2  col3
row2    83    17    80    26
row4    78    63    35    70**
```

# è¿‡æ»¤æ•°æ®å¸§

è¿‡æ»¤æ˜¯ä¸€ç§æ›´é€šç”¨çš„å·¥å…·ï¼Œå®ƒæ ¹æ®æ•°æ®æœ¬èº«çš„æ„Ÿå…´è¶£çš„å±æ€§è€Œä¸æ˜¯ç´¢å¼•æˆ–æ ‡ç­¾æ¥é€‰æ‹©æ•°æ®çš„ä¸€éƒ¨åˆ†ã€‚æ•°æ®å¸§æœ‰å‡ ç§è¿‡æ»¤æ–¹æ³•ã€‚æ‰€æœ‰è¿™äº›æ–¹æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯å¸ƒå°”çº§æ•°ã€‚åœ¨è¿™ä¸ªæ¡ä»¶ä¸ºçœŸçš„æƒ…å†µä¸‹ï¼Œ *df['col1'] > 20* (æˆ‘ä»¬å‡è®¾ col1 çš„ç±»å‹æ˜¯ integer)å°†è¿”å›ä¸€ä¸ªå¸ƒå°”åºåˆ—ã€‚æˆ‘å°†åœ¨è¿™é‡Œè¾“å…¥ã€‚head()æ–¹æ³•ï¼Œæ‰€ä»¥ä¸éœ€è¦å‘ä¸Šæ»šåŠ¨æ¥åŒ¹é…æ•°å­—ã€‚

```
**Out[2]: 
      col0  col1  col2  col3  col4
row0    24    78    42     7    96
row1    40     4    80    12    84
row2    83    17    80    26    15
row3    92    68    58    93    33
row4    78    63    35    70    95**
```

å› æ­¤ï¼Œè¦é€‰æ‹©æ•°æ®å¸§ä¸­ col1 çš„å€¼å¤§äº 20 çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹ä»£ç :

```
df[df['col1'] > 20]
*# assigning variable also works*
condition = df['col1'] > 20
df[condition]

**Out[31]: 
      col0  col1  col2  col3  col4
row0    24    78    42     7    96
row3    92    68    58    93    33
row4    78    63    35    70    95**
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„é€»è¾‘è¿ç®—ç¬¦(and â€” &ï¼Œor â€” |ï¼Œnot â€” ~)æ¥ç»„åˆè¿™äº›è¿‡æ»¤å™¨ã€‚è¯·æ³¨æ„æ‹¬å·åœ¨è¿™äº›æ“ä½œä¸­çš„ç”¨æ³•ã€‚

```
df[(df['col1'] > 25) & (df['col3'] < 30)] # logical and
**Out[33]: 
      col0  col1  col2  col3  col4
row0    24    78    42     7    96** df[(df['col1'] > 25) | (df['col3'] < 30)] # logical or
**Out[34]: 
      col0  col1  col2  col3  col4
row0    24    78    42     7    96
row1    40     4    80    12    84
row2    83    17    80    26    15
row3    92    68    58    93    33
row4    78    63    35    70    95** df[~(df['col1'] > 25)] # logical not
**Out[35]: 
      col0  col1  col2  col3  col4
row1    40     4    80    12    84
row2    83    17    80    26    15**
```

## å¤„ç† 0 å’Œ NaN å€¼

å‡ ä¹æ‰€æœ‰çš„æ•°æ®é›†éƒ½æœ‰é›¶å€¼æˆ– NaN å€¼ï¼Œæˆ‘ä»¬è‚¯å®šæƒ³çŸ¥é“å®ƒä»¬åœ¨å“ªé‡Œã€‚æˆ‘ä»¬çš„æ¯”è¾ƒç‰¹æ®Šï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šç¨å¾®ä¿®æ”¹ä¸€ä¸‹:

```
df.iloc[3, 3] = 0
df.iloc[1, 2] = np.nan
df.iloc[4, 0] = np.nan
df['col5'] = 0
df['col6'] = np.NaN
df.head()

**Out[57]: 
      col0  col1  col2  col3  col4  col5  col6
row0  24.0    78  42.0     7    96     0   NaN
row1  40.0     4   NaN    12    84     0   NaN
row2  83.0    17  80.0    26    15     0   NaN
row3  92.0    68  58.0     0    33     0   NaN
row4   NaN    63  35.0    70    95     0   NaN**
```

è¦é€‰æ‹©æ²¡æœ‰ä»»ä½•é›¶å€¼çš„åˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨*ã€‚all()* æ–¹æ³•(æ‰€æœ‰æ•°æ®éƒ½å­˜åœ¨):

```
df.loc[:, df.all()] **Out[43]: 
      col0  col1  col2  col4  col6
row0  24.0    78  42.0    96   NaN
row1  40.0     4   NaN    84   NaN
row2  83.0    17  80.0    15   NaN
row3  92.0    68  58.0    33   NaN
row4   NaN    63  35.0    95   NaN**
```

å¦‚æœæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°è‡³å°‘æœ‰ä¸€ä¸ªéé›¶(ä»»æ„)å€¼çš„åˆ—ï¼Œè¿™å°†æœ‰åŠ©äº:

```
df.loc[:, df.any()]

**Out[47]: 
      col0  col1  col2  col3  col4
row0  24.0    78  42.0     7    96
row1  40.0     4   NaN    12    84
row2  83.0    17  80.0    26    15
row3  92.0    68  58.0     0    33
row4   NaN    63  35.0    70    95**
```

è¦é€‰æ‹©å…·æœ‰ä»»ä½• NaN çš„åˆ—:

```
df.loc[:, df.isnull().any()]

**Out[48]: 
      col0  col2  col6
row0  24.0  42.0   NaN
row1  40.0   NaN   NaN
row2  83.0  80.0   NaN
row3  92.0  58.0   NaN
row4   NaN  35.0   NaN**
```

é€‰æ‹©ä¸å¸¦ nan çš„è‰²è°±æŸ±:

```
df.loc[:, df.notnull().all()]

**Out[49]: 
      col1  col3  col4  col5
row0    78     7    96     0
row1     4    12    84     0
row2    17    26    15     0
row3    68     0    33     0
row4    63    70    95     0**
```

æˆ‘ä»¬å¯ä»¥åˆ é™¤é‚£äº›åŒ…å« nan çš„è¡Œï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªå±é™©çš„æ¸¸æˆâ€”â€”åˆ é™¤é€šå¸¸ä¸æ˜¯ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚æ‚¨å¿…é¡»ç†è§£æ‚¨çš„æ•°æ®ï¼Œå¹¶æ˜æ™ºåœ°å¤„ç†è¿™æ ·çš„è¡Œã€‚æˆ‘è­¦å‘Šè¿‡ä½ ã€‚

![](img/1fd4635c0c025b9b2fa7a46e4c90bab1.png)

ä½ ç¡®å®šä½ æƒ³çŸ¥é“å—ï¼Ÿå¥½..ğŸ˜€

```
df.dropna(how='all', axis=1) # if all values in a column are NaN it will be dropped
**Out[69]: 
      col0  col1  col2  col3  col4  col5
row0  24.0    78  42.0     7    96     0
row1  40.0     4   NaN    12    84     0
row2  83.0    17  80.0    26    15     0
row3  92.0    68  58.0     0    33     0
row4   NaN    63  35.0    70    95     0** df.dropna(how='any', axis=1) # if any value in a row is NaN it will be dropped
**Out[71]: 
      col1  col3  col4  col5
row0    78     7    96     0
row1     4    12    84     0
row2    17    26    15     0
row3    68     0    33     0
row4    63    70    95     0**
```

è¿™ç§æ–¹æ³•ä¸ä¼šä¿®æ”¹åŸå§‹æ•°æ®å¸§ï¼Œå› æ­¤è¦ç»§ç»­å¤„ç†è¿‡æ»¤åçš„æ•°æ®ï¼Œå¿…é¡»å°†å…¶åˆ†é…ç»™æ–°çš„æ•°æ®å¸§æˆ–é‡æ–°åˆ†é…ç»™ç°æœ‰çš„æ•°æ®å¸§

```
df = df.dropna(how='any', axis=1)
```

è¿‡æ»¤çš„ç¾å¦™ä¹‹å¤„åœ¨äºï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥æ ¹æ®ä¸€åˆ—çš„å€¼æ¥é€‰æ‹©æˆ–ä¿®æ”¹å¦ä¸€åˆ—çš„å€¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä» col1 ä¸­é€‰æ‹©å€¼ï¼Œå…¶ä¸­ col2 å¤§äº 35ï¼Œå¹¶é€šè¿‡ç»™æ¯ä¸ªå€¼åŠ  5 æ¥æ›´æ–°è¿™äº›å€¼:

```
*# Find a column based on another*
df['col1'][df['col2'] > 35]
**Out[74]: 
row0    78
row2    17
row3    68
Name: col1, dtype: int32**

*# Modify a column based on another*
df['col1'][df['col2'] > 35] += 5
df['col1']
**Out[77]: 
row0    83
row1     4
row2    22
row3    73
row4    63
Name: col1, dtype: int32**
```

è¿™è®©æˆ‘ä»¬è¿›å…¥ä¸‹ä¸€éƒ¨åˆ†â€”â€”

# è½¬æ¢æ•°æ®å¸§

ä¸€æ—¦æˆ‘ä»¬é€‰æ‹©æˆ–è¿‡æ»¤äº†æˆ‘ä»¬çš„æ•°æ®ï¼Œæˆ‘ä»¬æƒ³ä»¥æŸç§æ–¹å¼è½¬æ¢å®ƒã€‚æœ€å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ç»§æ‰¿åˆ° DataFrames æˆ– numpy universal funcs çš„æ–¹æ³•ï¼Œå®ƒä»¬æŒ‰å…ƒç´ æ–¹å¼è½¬æ¢æ•´åˆ—æ•°æ®ã€‚ç†ŠçŒ«*å°±æ˜¯ä¾‹å­ã€‚floordiv()* å‡½æ•°(æ¥è‡ªæ–‡æ¡£:
â€˜data frame å’Œå…¶ä»–å…ƒç´ çš„æ•´æ•°é™¤æ³•â€™)æˆ– numpy çš„*ã€‚floor_divide()* (doc:'è¿”å›å°äºæˆ–ç­‰äºè¾“å…¥çš„é™¤æ³•çš„æœ€å¤§æ•´æ•°ã€‚').

å¦‚æœè¿™äº›å‡½æ•°ä¸å¯ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è‡ªå·±çš„å‡½æ•°å¹¶ä¸*ä¸€èµ·ä½¿ç”¨ã€‚åº”ç”¨()*æ–¹æ³•ã€‚

```
def some_func(x): 
    return x * 2df.apply(some_func) -- *# update each entry of a DataFrame without any loops**# lambda also works* 
df.apply(lambda n: n*2) -- *# the same*
```

è¿™äº›å‡½æ•°ä¸è¿”å›è½¬æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ˜¾å¼åœ°å­˜å‚¨å®ƒ:

```
df['new_col'] = df['col4'].apply(lambda n: n*2)
df.head()

**Out[82]: 
      col0  col1  col2  col3  col4  col5  col6  new_col
row0  24.0    83  42.0     7    96     0   NaN      192
row1  40.0     4   NaN    12    84     0   NaN      168
row2  83.0    22  80.0    26    15     0   NaN       30
row3  92.0    73  58.0     0    33     0   NaN       66
row4   NaN    63  35.0    70    95     0   NaN      190**
```

å¦‚æœ index æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒæœ‰ä¸€ä¸ª*ã€‚å…è®¸æˆ‘ä»¬ä¸€æ¬¡ä¿®æ”¹æ•´ä¸ªç´¢å¼•çš„è®¿é—®å™¨:*

```
df.index.str.upper()
**Out[83]: Index(['ROW0', 'ROW1', 'ROW2', 'ROW3', 'ROW4'], dtype='object')**
```

åŒæ ·ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨*ã€‚å¯¹ç´¢å¼•åº”ç”¨()*æ–¹æ³•â€”å®ƒçš„æ›¿ä»£æ–¹æ³•æ˜¯*ã€‚map()*

```
df.index = df.index.map(str.lower)
**Out[85]: Index(['row0', 'row1', 'row2', 'row3', 'row4'], dtype='object')**
```

ä½†æ˜¯*ã€‚map()* ä¹Ÿå¯ä»¥ç”¨åœ¨åˆ—ä¸Šã€‚ä¾‹å¦‚:

```
*# Create the dictionary: red_vs_blue*
red_vs_blue = {0:'blue', 12:'red'}

*# Use the dictionary to map the 'col3' column to the new column df['color']*
df['color'] = df['col3'].map(red_vs_blue)
df.head()

**Out[92]: 
      col0  col1  col2  col3  col4  col5  col6  new_col color
row0  24.0    83  42.0     7    96     0   NaN      192   NaN
row1  40.0     4   NaN    12    84     0   NaN      168   red
row2  83.0    22  80.0    26    15     0   NaN       30   NaN
row3  92.0    73  58.0     0    33     0   NaN       66  blue
row4   NaN    63  35.0    70    95     0   NaN      190   NaN**
```

åºåˆ—å’Œæ•°æ®å¸§ä¸Šçš„ç®—æœ¯è¿ç®—ç›´æ¥èµ·ä½œç”¨ã€‚ä¸‹é¢çš„è¡¨è¾¾å¼å°†åˆ›å»ºä¸€ä¸ªæ–°åˆ—ï¼Œå…¶ä¸­ç´¢å¼•ä¸º *n* çš„æ¯ä¸ªå€¼æ˜¯æ¥è‡ª*â€˜col 3â€™*å’Œ*â€˜col 7â€™çš„ç´¢å¼•ä¸º *n* çš„å€¼çš„æ€»å’Œã€‚*

```
df['col7'] = df['col3'] + df['col4'] 
df.head()

**Out[94]: 
      col0  col1  col2  col3  col4  col5  col6  new_col color  col7
row0  24.0    83  42.0     7    96     0   NaN      192   NaN   103
row1  40.0     4   NaN    12    84     0   NaN      168   red    96
row2  83.0    22  80.0    26    15     0   NaN       30   NaN    41
row3  92.0    73  58.0     0    33     0   NaN       66  blue    33
row4   NaN    63  35.0    70    95     0   NaN      190   NaN   165**
```

è¿™æ˜¯æ–‡ç« çš„ç¬¬äºŒä¸ªç‰ˆæœ¬ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå®Œå…¨æ˜¯ä¸€å›¢ç³Ÿâ€”â€”ä»£ç ä¸­æœ‰é”™è¯¯ï¼Œæ²¡æœ‰ä¾‹å­ï¼Œä¹Ÿæ²¡æœ‰å…¶ä»–ä¸œè¥¿ã€‚æ„Ÿè°¢åé¦ˆï¼Œæˆ‘åˆçœ‹äº†ä¸€éè¿™ç¯‡æ–‡ç« ï¼Œæˆ‘è§‰å¾—ç°åœ¨çœ‹èµ·æ¥å¥½å¤šäº†ã€‚æˆ‘åœ¨è¿™é‡Œç”¨ä»£ç ç‰‡æ®µå’Œä¾‹å­è®²è¿°äº†ç”¨ Python è½¬æ¢å’Œæå–æ•°æ®çš„åŸºç¡€çŸ¥è¯†ï¼Œå¸Œæœ›å¯¹åˆšå¼€å§‹æ¶‰è¶³è¿™ä¸€é¢†åŸŸçš„äººæœ‰ç”¨ã€‚

åŒæ—¶ï¼Œçƒ­çˆ±æ•°æ®ç§‘å­¦ï¼Œå¤šç¬‘ç¬‘ã€‚æˆ‘ä»¬å¿…é¡»ä¹è§‚ï¼Œå› ä¸ºæˆ‘ä»¬æ‹¥æœ‰ 21 ä¸–çºªæœ€æ€§æ„Ÿçš„å·¥ä½œğŸ˜€

*åŸè½½äº*[*sergilehkyi.com*](http://sergilehkyi.com/extracting-and-transforming-data-in-python/)*ã€‚*