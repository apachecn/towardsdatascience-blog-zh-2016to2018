# ä»Žæ— åˆ°æœ‰:50 è¡Œ Python ä¸­çš„äººå·¥æ™ºèƒ½å¹³è¡¡æœ¯

> åŽŸæ–‡ï¼š<https://towardsdatascience.com/from-scratch-ai-balancing-act-in-50-lines-of-python-7ea67ef717?source=collection_archive---------3----------------------->

![](img/f476f108e92c87b13118b632385cd30c.png)

Ours will do a little bit better than this in the end :)

å¤§å®¶å¥½ï¼ä»Šå¤©æˆ‘æƒ³å±•ç¤ºå¦‚ä½•ç”¨ 50 è¡Œ Python è¯­è¨€æ•™ä¼šä¸€å°æœºå™¨å¹³è¡¡ä¸€æ ¹æ†å­ï¼æˆ‘ä»¬å°†ä½¿ç”¨æ ‡å‡†çš„ [OpenAI Gym](https://gym.openai.com/) ä½œä¸ºæˆ‘ä»¬çš„æµ‹è¯•çŽ¯å¢ƒï¼Œå¹¶ä¸”åªç”¨ numpy åˆ›å»ºæˆ‘ä»¬çš„ä»£ç†ã€‚

æ‰‹æŽ¨è½¦æ†å­é—®é¢˜æ˜¯æˆ‘ä»¬å¿…é¡»å·¦å³æŽ¨åŠ¨æ‰‹æŽ¨è½¦æ¥å¹³è¡¡ä¸Šé¢çš„æ†å­ã€‚è¿™ç±»ä¼¼äºŽåœ¨æˆ‘ä»¬çš„æŒ‡å°–åž‚ç›´å¹³è¡¡ä¸€æ”¯é“…ç¬”ï¼Œé™¤äº†ä¸€ç»´(ç›¸å½“æœ‰æŒ‘æˆ˜æ€§ï¼)

åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œä½ å¯ä»¥åœ¨ repl.it æŸ¥çœ‹[çš„æœ€ç»ˆæ¼”ç¤ºã€‚](https://repl.it/@MikeShi42/CartPole)

# RL é€Ÿæˆç­

å¦‚æžœè¿™æ˜¯ä½ ç¬¬ä¸€æ¬¡å­¦ä¹ æœºå™¨å­¦ä¹ æˆ–å¼ºåŒ–å­¦ä¹ ï¼Œæˆ‘ä¼šåœ¨è¿™é‡Œä»‹ç»ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œè¿™æ ·ä½ å°±ä¼šå¯¹æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨çš„æœ¯è¯­æœ‰æ‰€äº†è§£:)ã€‚å¦‚æžœè¿™ä¸æ˜¯ä½ çš„ç¬¬ä¸€æ¬¡ï¼Œä½ å¯ä»¥ç»§ç»­å¾€ä¸‹è·³ï¼Œåˆ¶å®šæˆ‘ä»¬çš„æ”¿ç­–ï¼

**å¼ºåŒ–å­¦ä¹ **

å¼ºåŒ–å­¦ä¹ (RL)æ˜¯ä¸€ä¸ªç ”ç©¶é¢†åŸŸï¼Œè‡´åŠ›äºŽæ•™å¯¼ä»£ç†(æˆ‘ä»¬çš„ç®—æ³•/æœºå™¨)æ‰§è¡ŒæŸäº›ä»»åŠ¡/åŠ¨ä½œï¼Œè€Œä¸æ˜Žç¡®å‘Šè¯‰å®ƒå¦‚ä½•åšã€‚æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªå©´å„¿ï¼Œéšæ„åœ°ç§»åŠ¨å®ƒçš„è…¿ï¼›å¹¸è¿çš„æ˜¯ï¼Œå¦‚æžœå©´å„¿ç«™ç›´äº†ï¼Œæˆ‘ä»¬ä¼šç»™å®ƒä¸€é¢—ç³–/å¥–åŠ±ã€‚åŒæ ·ï¼Œä»£ç†äººçš„ç›®æ ‡å°†æ˜¯åœ¨å…¶ä¸€ç”Ÿä¸­æœ€å¤§åŒ–æ€»æŠ¥é…¬ï¼Œæˆ‘ä»¬å°†å†³å®šä¸Žæˆ‘ä»¬æƒ³è¦å®Œæˆçš„ä»»åŠ¡ç›¸ä¸€è‡´çš„æŠ¥é…¬ã€‚å¯¹äºŽç«™ç«‹çš„ä¾‹å­ï¼Œå½“ç›´ç«‹æ—¶å¥–åŠ± 1ï¼Œå¦åˆ™å¥–åŠ± 0ã€‚

ä¸€ä¸ª RL ä»£ç†çš„ä¾‹å­æ˜¯ AlphaGoï¼Œä»£ç†å·²ç»å­¦ä¼šäº†å¦‚ä½•çŽ©å›´æ£‹æ¥æœ€å¤§åŒ–å®ƒçš„å¥–åŠ±(èµ¢å¾—æ¯”èµ›)ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä»£ç†ï¼Œå®ƒå¯ä»¥é€šè¿‡å‘å·¦æˆ–å‘å³æŽ¨æ‰‹æŽ¨è½¦æ¥è§£å†³å¹³è¡¡æ‰‹æŽ¨è½¦ä¸Šçš„æ†å­çš„é—®é¢˜ã€‚

**çŠ¶æ€**

![](img/26ea8db8bd0f1077fa0ee060db9141e5.png)

What a game of pong looks like, in case you need a refresher

ä¸€ä¸ª**çŠ¶æ€**å°±æ˜¯æ¸¸æˆç›®å‰çš„æ ·å­ã€‚æˆ‘ä»¬é€šå¸¸å¤„ç†æ¸¸æˆçš„æ•°å­—è¡¨ç¤ºã€‚åœ¨ä¹’ä¹“æ¸¸æˆä¸­ï¼Œå¯èƒ½æ˜¯æ¯ä¸ªçƒæ‹çš„åž‚ç›´ä½ç½®å’Œ xï¼Œy åæ ‡+çƒçš„é€Ÿåº¦ã€‚åœ¨å°è½¦æ†çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„çŠ¶æ€ç”± 4 ä¸ªæ•°å­—ç»„æˆ:å°è½¦çš„ä½ç½®ï¼Œå°è½¦çš„é€Ÿåº¦ï¼Œæ†çš„ä½ç½®(ä½œä¸ºä¸€ä¸ªè§’åº¦)å’Œæ†çš„è§’é€Ÿåº¦ã€‚è¿™ 4 ä¸ªæ•°å­—ä½œä¸ºä¸€ä¸ªæ•°ç»„(æˆ–å‘é‡)æä¾›ç»™æˆ‘ä»¬ã€‚è¿™å¾ˆé‡è¦ï¼›ç†è§£çŠ¶æ€æ˜¯ä¸€ç»„æ•°å­—æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å¯¹å®ƒåšä¸€äº›æ•°å­¦è¿ç®—ï¼Œä»¥å†³å®šæˆ‘ä»¬æƒ³è¦æ ¹æ®çŠ¶æ€é‡‡å–ä»€ä¹ˆè¡ŒåŠ¨ã€‚

**æ”¿ç­–**

ç­–ç•¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥èŽ·å–æ¸¸æˆçš„çŠ¶æ€(ä¾‹å¦‚æ£‹ç›˜æ£‹å­çš„ä½ç½®ï¼Œæˆ–è€…æ‰‹æŽ¨è½¦å’Œæ†å­çš„ä½ç½®)å¹¶è¾“å‡ºä»£ç†åœ¨è¯¥ä½ç½®åº”è¯¥é‡‡å–çš„åŠ¨ä½œ(ä¾‹å¦‚ç§»åŠ¨éª‘å£«ï¼Œæˆ–è€…æŠŠè½¦æŽ¨åˆ°å·¦è¾¹)ã€‚åœ¨ä»£ç†é‡‡å–æˆ‘ä»¬é€‰æ‹©çš„è¡ŒåŠ¨åŽï¼Œæ¸¸æˆå°†æ›´æ–°ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬å°†å†æ¬¡å°†å®ƒè¾“å…¥ç­–ç•¥ä»¥åšå‡ºå†³å®šã€‚è¿™ç§æƒ…å†µä¸€ç›´æŒç»­åˆ°æ¸¸æˆä»¥æŸç§æ–¹å¼ç»“æŸã€‚æ”¿ç­–éžå¸¸é‡è¦ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æ‰€å¯»æ±‚çš„ï¼Œå› ä¸ºå®ƒæ˜¯ä»£ç†èƒŒåŽçš„å†³ç­–èƒ½åŠ›ã€‚

**ç‚¹ç§¯**

ä¸¤ä¸ªæ•°ç»„(å‘é‡)ä¹‹é—´çš„ç‚¹ç§¯å°±æ˜¯å°†ç¬¬ä¸€ä¸ªæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ä¹˜ä»¥ç¬¬äºŒä¸ªæ•°ç»„çš„ç›¸åº”å…ƒç´ ï¼Œç„¶åŽå°†æ‰€æœ‰å…ƒç´ ç›¸åŠ ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°æ•°ç»„ A å’Œ B çš„ç‚¹ç§¯ï¼Œå®ƒå°†ç®€å•åœ°æ˜¯ A[0]*B[0] + A[1]*B[1]â€¦æˆ‘ä»¬å°†ä½¿ç”¨æ­¤æ“ä½œå°†çŠ¶æ€(è¿™æ˜¯ä¸€ä¸ªæ•°ç»„)ä¹˜ä»¥å¦ä¸€ä¸ªæ•°ç»„(è¿™å°†æ˜¯æˆ‘ä»¬çš„ç­–ç•¥)ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚

# å‘å±•æˆ‘ä»¬çš„æ”¿ç­–

ä¸ºäº†è§£å†³æˆ‘ä»¬çš„è½¦æ†æ¸¸æˆï¼Œæˆ‘ä»¬å¸Œæœ›è®©æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ ä¸€ç§ç­–ç•¥æˆ–æ”¿ç­–æ¥èµ¢å¾—æ¸¸æˆæˆ–æœ€å¤§åŒ–æˆ‘ä»¬çš„å¥–åŠ±ã€‚

å¯¹äºŽæˆ‘ä»¬ä»Šå¤©è¦å¼€å‘çš„ä»£ç†ï¼Œæˆ‘ä»¬å°†æŠŠæˆ‘ä»¬çš„ç­–ç•¥è¡¨ç¤ºä¸ºä¸€ä¸ªç”± 4 ä¸ªæ•°å­—ç»„æˆçš„æ•°ç»„ï¼Œè¿™äº›æ•°å­—è¡¨ç¤ºçŠ¶æ€çš„æ¯ä¸ªç»„æˆéƒ¨åˆ†æœ‰å¤šâ€œé‡è¦â€(æ‰‹æŽ¨è½¦ä½ç½®ã€æ†å­ä½ç½®ç­‰)ã€‚)ç„¶åŽæˆ‘ä»¬å°†ç­–ç•¥æ•°ç»„ä¸ŽçŠ¶æ€è¿›è¡Œç‚¹ç§¯ï¼Œä»¥è¾“å‡ºä¸€ä¸ªæ•°å­—ã€‚æ ¹æ®æ•°å­—æ˜¯æ­£æ•°è¿˜æ˜¯è´Ÿæ•°ï¼Œæˆ‘ä»¬å°†å‘å·¦æˆ–å‘å³æŽ¨æ‰‹æŽ¨è½¦ã€‚

å¦‚æžœè¿™å¬èµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Œè®©æˆ‘ä»¬æŒ‘é€‰ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

å‡è®¾æ‰‹æŽ¨è½¦åœ¨æ¸¸æˆä¸­å¤„äºŽä¸­å¿ƒä½ç½®ï¼Œå¹¶ä¸”é™æ­¢ä¸åŠ¨ï¼Œæ†å­å‘å³å€¾æ–œï¼Œå¹¶ä¸”ä¹Ÿå‘å³å€¾æ–œã€‚å®ƒçœ‹èµ·æ¥ä¼šåƒè¿™æ ·:

![](img/085a72489e5027e159fed5cf87296fdc.png)

å…³è”çš„çŠ¶æ€å¯èƒ½å¦‚ä¸‹æ‰€ç¤º:

![](img/83392c3e9a1eeb1261f668098e8584a9.png)

é‚£ä¹ˆçŠ¶æ€æ•°ç»„å°†æ˜¯[0ï¼Œ0ï¼Œ0.2ï¼Œ0.05]ã€‚

çŽ°åœ¨ï¼Œå‡­ç›´è§‰ï¼Œæˆ‘ä»¬ä¼šæƒ³é€šè¿‡å‘å³æŽ¨æ‰‹æŽ¨è½¦ï¼ŒæŠŠæ†å­æ‹‰ç›´ã€‚æˆ‘ä»Žä¸€æ¬¡è®­ç»ƒä¸­èŽ·å¾—äº†ä¸€ä¸ªå¥½çš„ç­–ç•¥ï¼Œå®ƒçš„ç­–ç•¥æ•°ç»„æ˜¯:[-0.116ï¼Œ0.332ï¼Œ0.207 0.352]ã€‚è®©æˆ‘ä»¬æ‰‹åŠ¨å¿«é€Ÿè®¡ç®—ä¸€ä¸‹ï¼Œçœ‹çœ‹è¿™ä¸ªç­–ç•¥ä½œä¸ºè¿™ä¸ªå·žçš„ä¸€ä¸ªåŠ¨ä½œä¼šè¾“å‡ºä»€ä¹ˆã€‚

è¿™é‡Œæˆ‘ä»¬å°†ç‚¹ç§¯çŠ¶æ€æ•°ç»„[0ï¼Œ0ï¼Œ0.2ï¼Œ0.05]å’Œç­–ç•¥æ•°ç»„(ç²˜è´´åœ¨ä¸Šé¢)ã€‚å¦‚æžœæ•°å­—æ˜¯æ­£æ•°ï¼Œæˆ‘ä»¬å‘å³æŽ¨ï¼Œå¦‚æžœæ•°å­—æ˜¯è´Ÿæ•°ï¼Œæˆ‘ä»¬å‘å·¦æŽ¨ã€‚

![](img/733bf05f9791fc8a05c1bdfb050c9630.png)

ç»“æžœæ˜¯è‚¯å®šçš„ï¼Œè¿™æ„å‘³ç€åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”¿ç­–ä¹Ÿä¼šæŠŠè½¦æŽ¨åˆ°å³è¾¹ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æžœã€‚

çŽ°åœ¨è¿™ä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Œå¾ˆæ˜Žæ˜¾ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ 4 ä¸ªåƒä¸Šé¢è¿™æ ·çš„ç¥žå¥‡æ•°å­—æ¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬å¦‚ä½•å¾—åˆ°è¿™äº›æ•°å­—ï¼Ÿå¦‚æžœæˆ‘ä»¬åªæ˜¯éšæœºæŒ‘é€‰å‘¢ï¼Ÿæ•ˆæžœå¦‚ä½•ï¼Ÿè®©æˆ‘ä»¬æ‰¾å‡ºç­”æ¡ˆï¼Œå¹¶å¼€å§‹æŒ–æŽ˜ä»£ç ï¼

# å¯åŠ¨ä½ çš„ç¼–è¾‘å™¨ï¼

è®©æˆ‘ä»¬åœ¨ [repl.it](https://repl.it/) ä¸Šæ‰“å¼€ä¸€ä¸ª Python å®žä¾‹ã€‚å®ƒå…è®¸æ‚¨å¿«é€Ÿè°ƒç”¨å¤§é‡ä¸åŒç¼–ç¨‹çŽ¯å¢ƒçš„äº‘å®žä¾‹ï¼Œå¹¶åœ¨ä¸€ä¸ªå¼ºå¤§çš„äº‘ IDE ä¸­ç¼–è¾‘ä»£ç ï¼Œè¯¥ IDE åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è®¿é—®ï¼

![](img/df00f212ede518cbe92b8e67bceab847.png)

# å®‰è£…è½¯ä»¶åŒ…

æˆ‘ä»¬å°†ä»Žå®‰è£…è¿™ä¸ªé¡¹ç›®æ‰€éœ€çš„ä¸¤ä¸ªåŒ…å¼€å§‹:numpy å¸®åŠ©è¿›è¡Œæ•°å€¼è®¡ç®—ï¼ŒOpenAI Gym ä½œä¸ºæˆ‘ä»¬ä»£ç†çš„æ¨¡æ‹Ÿå™¨ã€‚

![](img/00395e479a1c47f8108591800a2c13f6.png)

åªéœ€åœ¨ç¼–è¾‘å™¨å·¦ä¾§çš„åŒ…æœç´¢å·¥å…·ä¸­é”®å…¥`gym`å’Œ`numpy`ï¼Œç„¶åŽå•å‡»åŠ å·æŒ‰é’®å®‰è£…åŒ…ã€‚

# å¥ å®šåŸºç¡€

è®©æˆ‘ä»¬é¦–å…ˆå°†åˆšåˆšå®‰è£…çš„ä¸¤ä¸ªä¾èµ–é¡¹å¯¼å…¥åˆ°æˆ‘ä»¬çš„`main.py`è„šæœ¬ä¸­ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªæ–°çš„å¥èº«æˆ¿çŽ¯å¢ƒ:

æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªåä¸ºâ€œplayâ€çš„å‡½æ•°ï¼Œå®ƒå°†è¢«ç»™äºˆä¸€ä¸ªçŽ¯å¢ƒå’Œä¸€ä¸ªç­–ç•¥æ•°ç»„ï¼Œå¹¶å°†åœ¨è¯¥çŽ¯å¢ƒä¸­æ’­æ”¾è¯¥ç­–ç•¥æ•°ç»„å¹¶è¿”å›žåˆ†æ•°ï¼Œä»¥åŠåœ¨æ¯ä¸ªæ—¶é—´æ­¥é•¿çš„æ¸¸æˆå¿«ç…§(è§‚å¯Ÿ)ã€‚æˆ‘ä»¬å°†ä½¿ç”¨åˆ†æ•°æ¥å‘Šè¯‰æˆ‘ä»¬è¯¥ç­–ç•¥çš„æ‰§è¡Œæƒ…å†µï¼Œå¹¶ä½¿ç”¨å¿«ç…§æ¥è§‚å¯Ÿè¯¥ç­–ç•¥åœ¨å•ä¸ªæ¸¸æˆä¸­çš„è¡¨çŽ°ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸åŒçš„æ”¿ç­–ï¼Œçœ‹çœ‹ä»–ä»¬åœ¨æ¸¸æˆä¸­è¡¨çŽ°å¦‚ä½•ï¼

è®©æˆ‘ä»¬ä»Žå‡½æ•°å®šä¹‰å¼€å§‹ï¼Œå¹¶å°†æ¸¸æˆé‡ç½®ä¸ºå¼€å§‹çŠ¶æ€ã€‚

æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆå§‹åŒ–ä¸€äº›å˜é‡æ¥è·Ÿè¸ªæ¸¸æˆæ˜¯å¦å·²ç»ç»“æŸï¼Œç­–ç•¥çš„æ€»å¾—åˆ†ï¼Œä»¥åŠæ¸¸æˆè¿‡ç¨‹ä¸­æ¯ä¸€æ­¥çš„å¿«ç…§(è§‚å¯Ÿ)ã€‚

çŽ°åœ¨æˆ‘ä»¬å°†ç®€å•åœ°çŽ©æ¸¸æˆå¾ˆå¤šæ—¶é—´æ­¥éª¤ï¼Œç›´åˆ°å¥èº«æˆ¿å‘Šè¯‰æˆ‘ä»¬æ¸¸æˆç»“æŸã€‚

ä¸Šé¢çš„å¤§éƒ¨åˆ†ä»£ç ä¸»è¦åªæ˜¯åœ¨çŽ©æ¸¸æˆå’Œè®°å½•ç»“æžœã€‚æˆ‘ä»¬æ”¿ç­–çš„å®žé™…ä»£ç åªæœ‰è¿™ä¸¤è¡Œ:

æˆ‘ä»¬åœ¨è¿™é‡Œåšçš„åªæ˜¯ç­–ç•¥æ•°ç»„å’ŒçŠ¶æ€(è§‚å¯Ÿ)æ•°ç»„ä¹‹é—´çš„ç‚¹ç§¯è¿ç®—ï¼Œå°±åƒæˆ‘ä»¬åœ¨å‰é¢çš„å…·ä½“ä¾‹å­ä¸­å±•ç¤ºçš„é‚£æ ·ã€‚ç„¶åŽæˆ‘ä»¬æ ¹æ®ç»“æžœæ˜¯ç§¯æžçš„è¿˜æ˜¯æ¶ˆæžçš„æ¥é€‰æ‹© 1 æˆ– 0(å·¦æˆ–å³)çš„è¡ŒåŠ¨ã€‚

åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬çš„`main.py`åº”è¯¥æ˜¯è¿™æ ·çš„:

çŽ°åœ¨æˆ‘ä»¬è¦å¼€å§‹çŽ©ä¸€äº›æ¸¸æˆï¼Œæ‰¾åˆ°æˆ‘ä»¬çš„æœ€ä¼˜ç­–ç•¥ï¼

# çŽ©ç¬¬ä¸€ä¸ªæ¸¸æˆ

çŽ°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°æ¥çŽ©è¿™ä¸ªæ¸¸æˆï¼Œå¹¶å‘Šè¯‰æˆ‘ä»¬çš„ç­–ç•¥æœ‰å¤šå¥½ï¼Œæˆ‘ä»¬å°†å¸Œæœ›å¼€å§‹ç”Ÿæˆä¸€äº›ç­–ç•¥ï¼Œå¹¶çœ‹çœ‹å®ƒä»¬åšå¾—æœ‰å¤šå¥½ã€‚

å¦‚æžœæˆ‘ä»¬ä¸€å¼€å§‹åªæ˜¯å°è¯•æ’å…¥ä¸€äº›éšæœºç­–ç•¥ä¼šæ€Žä¹ˆæ ·ï¼Ÿæˆ‘ä»¬èƒ½èµ°å¤šè¿œï¼Ÿè®©æˆ‘ä»¬ä½¿ç”¨`numpy`æ¥ç”Ÿæˆæˆ‘ä»¬çš„ç­–ç•¥ï¼Œè¿™æ˜¯ä¸€ä¸ª 4 å…ƒç´ æ•°ç»„æˆ– 1x4 çŸ©é˜µã€‚å®ƒå°†åœ¨ 0 å’Œ 1 ä¹‹é—´é€‰æ‹© 4 ä¸ªæ•°å­—ä½œä¸ºæˆ‘ä»¬çš„ç­–ç•¥ã€‚

æœ‰äº†è¿™ä¸ªç­–ç•¥ï¼Œä»¥åŠæˆ‘ä»¬åœ¨ä¸Šé¢åˆ›å»ºçš„çŽ¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥è®©ä»–ä»¬å‚ä¸Žè¿›æ¥å¹¶èŽ·å¾—åˆ†æ•°ã€‚

åªéœ€ç‚¹å‡» run æ¥è¿è¡Œæˆ‘ä»¬çš„è„šæœ¬ã€‚å®ƒåº”è¯¥è¾“å‡ºæˆ‘ä»¬çš„ç­–ç•¥å¾—åˆ°çš„åˆ†æ•°ã€‚

![](img/6155eb61ddce2967c3e90f68b697e0ea.png)

è¿™ä¸ªæ¸¸æˆçš„æœ€é«˜åˆ†æ•°æ˜¯ 500ï¼Œå¾ˆæœ‰å¯èƒ½ä½ çš„æ”¿ç­–å¹¶ä¸é¡ºåˆ©ã€‚å¦‚æžœä½ çš„æœ‰ï¼Œæ­å–œä½ ï¼ä»Šå¤©ä¸€å®šæ˜¯ä½ çš„å¹¸è¿æ—¥ï¼è™½ç„¶ä»…ä»…çœ‹åˆ°ä¸€ä¸ªæ•°å­—å¹¶ä¸æ˜¯å¾ˆæœ‰ä»·å€¼ï¼Œä½†æ˜¯å¦‚æžœæˆ‘ä»¬èƒ½æƒ³è±¡æˆ‘ä»¬çš„ä»£ç†å¦‚ä½•çŽ©æ¸¸æˆï¼Œé‚£å°±å¤ªå¥½äº†ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°†è®¾ç½®å®ƒï¼

# ç›‘è§†æˆ‘ä»¬çš„ç‰¹å·¥

ä¸ºäº†è§‚å¯Ÿæˆ‘ä»¬çš„ä»£ç†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [Flask](http://flask.pocoo.org/) æ¥è®¾ç½®ä¸€ä¸ªè½»é‡çº§æœåŠ¡å™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°ä»£ç†çš„è¡¨çŽ°ã€‚Flask æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Python HTTP æœåŠ¡å™¨æ¡†æž¶ï¼Œå¯ä»¥æœåŠ¡äºŽæˆ‘ä»¬çš„ HTML UI å’Œæ•°æ®ã€‚æˆ‘å°†ä¿æŒè¿™ä¸€éƒ¨åˆ†çš„ç®€çŸ­ï¼Œå› ä¸ºæ¸²æŸ“å’Œ HTTP æœåŠ¡å™¨èƒŒåŽçš„ç»†èŠ‚å¯¹äºŽåŸ¹è®­æˆ‘ä»¬çš„ä»£ç†å¹¶ä¸é‡è¦ã€‚

æˆ‘ä»¬é¦–å…ˆè¦å°†`Flask`å®‰è£…æˆä¸€ä¸ª Python åŒ…ï¼Œå°±åƒæˆ‘ä»¬åœ¨å‰é¢å‡ èŠ‚ä¸­å®‰è£…`gym`å’Œ`numpy`ä¸€æ ·ã€‚

![](img/708ef24f03abdf8a02794383f16194da.png)

æŽ¥ä¸‹æ¥ï¼Œåœ¨è„šæœ¬çš„åº•éƒ¨ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª flask æœåŠ¡å™¨ã€‚å®ƒå°†åœ¨`/data`ç«¯ç‚¹ä¸Šå…¬å¼€æ¸¸æˆçš„æ¯ä¸€å¸§è®°å½•ï¼Œå¹¶åœ¨`/`ä¸Šæ‰˜ç®¡ UIã€‚

æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸¤ä¸ªæ–‡ä»¶ã€‚ä¸€ä¸ªæ˜¯é¡¹ç›®çš„ç©ºç™½ Python æ–‡ä»¶ã€‚è¿™æ˜¯ repl.it å¦‚ä½•æ£€æµ‹ repl æ˜¯å¤„äºŽ[è¯„ä¼°æ¨¡å¼è¿˜æ˜¯é¡¹ç›®æ¨¡å¼](https://repl.it/site/docs/repls/files)çš„æŠ€æœ¯é—®é¢˜ã€‚åªéœ€ä½¿ç”¨â€œæ–°å»ºæ–‡ä»¶â€æŒ‰é’®æ·»åŠ ä¸€ä¸ªç©ºç™½ Python è„šæœ¬ã€‚

ä¹‹åŽï¼Œæˆ‘ä»¬è¿˜æƒ³åˆ›å»ºä¸€ä¸ª`index.html`æ¥æ‰˜ç®¡æ¸²æŸ“ UIã€‚è¿™é‡Œå°±ä¸æ·±ç©¶ç»†èŠ‚äº†ï¼Œåªæ˜¯ç®€å•çš„**æŠŠè¿™ä¸ª**[**index.html**](https://gist.github.com/MikeShi42/7b5ff55e2320e41228b5c25ad1113321)**ä¸Šä¼ åˆ°ä½ çš„ repl.it é¡¹ç›®**ã€‚

æ‚¨çŽ°åœ¨åº”è¯¥æœ‰ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„é¡¹ç›®ç›®å½•:

![](img/3e1ecc64c0e0660d002af7b736690443.png)

çŽ°åœ¨æœ‰äº†è¿™ä¸¤ä¸ªæ–°æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬è¿è¡Œ repl æ—¶ï¼Œå®ƒåº”è¯¥ä¹Ÿèƒ½å›žæ”¾æˆ‘ä»¬çš„ç­–ç•¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ã€‚æœ‰äº†è¿™äº›ï¼Œè®©æˆ‘ä»¬è¯•ç€æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜ç­–ç•¥ï¼

![](img/a78e8f2cd249c57e6c9dcdc9b787a2ff.png)

# ç­–ç•¥æœç´¢

åœ¨ç¬¬ä¸€éä¸­ï¼Œæˆ‘ä»¬ç®€å•åœ°éšæœºé€‰æ‹©äº†ä¸€ä¸ªç­–ç•¥ï¼Œä½†æ˜¯å¦‚æžœæˆ‘ä»¬é€‰æ‹©äº†å‡ ä¸ªç­–ç•¥ï¼Œå¹¶ä¸”åªä¿ç•™äº†åšå¾—æœ€å¥½çš„ä¸€ä¸ªï¼Œé‚£ä¼šæ€Žä¹ˆæ ·å‘¢ï¼Ÿ

è®©æˆ‘ä»¬å›žåˆ°æ’­æ”¾ç­–ç•¥çš„é‚£ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸åªæ˜¯ç”Ÿæˆä¸€ä¸ªç­–ç•¥ï¼Œè€Œæ˜¯ç¼–å†™ä¸€ä¸ªå¾ªçŽ¯æ¥ç”Ÿæˆå‡ ä¸ªç­–ç•¥ï¼Œå¹¶è·Ÿè¸ªæ¯ä¸ªç­–ç•¥çš„è¡¨çŽ°ï¼Œåªä¿å­˜æœ€ä½³ç­–ç•¥ã€‚

æˆ‘ä»¬å°†é¦–å…ˆåˆ›å»ºä¸€ä¸ªåä¸º`max`çš„å…ƒç»„ï¼Œå®ƒå°†å­˜å‚¨ç›®å‰ä¸ºæ­¢æˆ‘ä»¬çœ‹åˆ°çš„æœ€ä½³ç­–ç•¥çš„åˆ†æ•°ã€è§‚å¯Ÿå€¼å’Œç­–ç•¥æ•°ç»„ã€‚

æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆå¹¶è¯„ä¼° 10 ä¸ªç­–ç•¥ï¼Œå¹¶å°†æœ€ä½³ç­–ç•¥ä¿å­˜åœ¨ max ä¸­ã€‚

æˆ‘ä»¬è¿˜å¿…é¡»å‘Šè¯‰æˆ‘ä»¬çš„`/data`ç«¯ç‚¹è¿”å›žæœ€ä½³ç­–ç•¥çš„å›žæ”¾ã€‚

æ­¤ç«¯ç‚¹:

åº”æ”¹ä¸º:

ä½ çš„ main.py çœ‹èµ·æ¥åº”è¯¥ç±»ä¼¼äºŽ [this now](https://gist.github.com/MikeShi42/3c270ce2d13f2709ef2d5983492a1693) :

å¦‚æžœæˆ‘ä»¬çŽ°åœ¨è¿è¡Œ replï¼Œæˆ‘ä»¬åº”è¯¥å¾—åˆ° 500 çš„æœ€é«˜åˆ†ï¼Œå¦‚æžœä¸æ˜¯ï¼Œå°è¯•å†è¿è¡Œä¸€æ¬¡ replï¼æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°æ”¿ç­–å¹³è¡¡çš„æžç‚¹å®Œç¾Žæ— ç¼ºï¼å“‡ï¼Œå¤ªç®€å•äº†ï¼

# æ²¡é‚£ä¹ˆå¿«

ä¹Ÿå¯èƒ½ä¸æ˜¯ã€‚åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬åœ¨å‡ ä¸ªæ–¹é¢åšäº†äº›æ‰‹è„šã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åªåœ¨ 0 åˆ° 1 çš„èŒƒå›´å†…éšæœºåˆ›å»ºç­–ç•¥æ•°ç»„ã€‚è¿™åªæ˜¯å‘ç”Ÿäº†å·¥ä½œï¼Œä½†æ˜¯å¦‚æžœæˆ‘ä»¬æŠŠå¤§äºŽæ“ä½œç¬¦åè¿‡æ¥ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä»£ç†å°†ä¼šç¾éš¾æ€§åœ°å¤±è´¥ã€‚è¦äº²è‡ªå°è¯•ï¼Œè¯·å°†`action = 1 if outcome > 0 else 0`æ›´æ”¹ä¸º`action = 1 if outcome < 0 else 0`ã€‚

è¿™ä¼¼ä¹Žä¸å¤ªå¯é ï¼Œå› ä¸ºå¦‚æžœæˆ‘ä»¬åªæ˜¯ç¢°å·§é€‰æ‹©äº†å°äºŽè€Œä¸æ˜¯å¤§äºŽï¼Œæˆ‘ä»¬å°±æ°¸è¿œæ‰¾ä¸åˆ°å¯ä»¥è§£å†³è¿™ä¸ªæ¸¸æˆçš„ç­–ç•¥ã€‚ä¸ºäº†ç¼“è§£è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å®žé™…ä¸Šä¹Ÿåº”è¯¥ç”Ÿæˆå¸¦æœ‰è´Ÿæ•°çš„ç­–ç•¥ã€‚è¿™å°†ä½¿æ‰¾åˆ°ä¸€ä¸ªå¥½çš„æ”¿ç­–å˜å¾—æ›´åŠ å›°éš¾(å› ä¸ºè®¸å¤šè´Ÿé¢çš„æ”¿ç­–éƒ½ä¸æ˜¯å¥½çš„)ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸å†é€šè¿‡å°†æˆ‘ä»¬çš„ç‰¹å®šç®—æ³•é€‚ç”¨äºŽè¿™ä¸ªç‰¹å®šçš„æ¸¸æˆæ¥â€œä½œå¼Šâ€ã€‚å¦‚æžœæˆ‘ä»¬è¯•å›¾åœ¨ OpenAI å¥èº«æˆ¿çš„å…¶ä»–çŽ¯å¢ƒä¸­è¿™æ ·åšï¼Œæˆ‘ä»¬çš„ç®—æ³•è‚¯å®šä¼šå¤±è´¥ã€‚

ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œè€Œä¸æ˜¯æœ‰`policy = np.random.rand(1,4)`ï¼Œæˆ‘ä»¬å°†æ”¹å˜ä¸º`policy = np.random.rand(1,4) - 0.5`ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬ç­–ç•¥ä¸­çš„æ¯ä¸ªæ•°å­—å°†ä»‹äºŽ-0.5 å’Œ 0.5 ä¹‹é—´ï¼Œè€Œä¸æ˜¯ 0 åˆ° 1ã€‚ä½†æ˜¯å› ä¸ºè¿™æ›´å›°éš¾ï¼Œæˆ‘ä»¬è¿˜æƒ³æœç´¢æ›´å¤šçš„ç­–ç•¥ã€‚åœ¨ä¸Šé¢çš„ for å¾ªçŽ¯ä¸­ï¼Œæˆ‘ä»¬ä¸éåŽ† 10 ä¸ªç­–ç•¥ï¼Œè€Œæ˜¯é€šè¿‡å°†ä»£ç æ”¹ä¸º`for _ in range(100):`æ¥å°è¯• 100 ä¸ªç­–ç•¥ã€‚æˆ‘ä¹Ÿé¼“åŠ±ä½ å…ˆå°è¯•éåŽ† 10 ä¸ªç­–ç•¥ï¼Œçœ‹çœ‹çŽ°åœ¨ç”¨è´Ÿæ•°å¾—åˆ°å¥½çš„ç­–ç•¥æœ‰å¤šéš¾ã€‚

çŽ°åœ¨æˆ‘ä»¬çš„ main.py åº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·:

å¦‚æžœä½ çŽ°åœ¨è¿è¡Œ replï¼Œä¸ç®¡æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å¤§äºŽè¿˜æ˜¯å°äºŽï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä¸ºæ¸¸æˆæ‰¾åˆ°ä¸€ä¸ªå¥½çš„ç­–ç•¥ã€‚

# æ²¡é‚£ä¹ˆå¿« Ptã€‚2

ä½†æ˜¯ç­‰ç­‰ï¼Œè¿˜æœ‰å‘¢ï¼å³ä½¿æˆ‘ä»¬çš„æ”¿ç­–å¯èƒ½èƒ½å¤Ÿåœ¨ä¸€æ¬¡è¿è¡Œä¸­è¾¾åˆ°æœ€é«˜ 500 åˆ†ï¼Œå®ƒèƒ½æ¯æ¬¡éƒ½åšåˆ°å—ï¼Ÿå½“æˆ‘ä»¬ç”Ÿæˆäº† 100 ä¸ªç­–ç•¥ï¼Œå¹¶é€‰æ‹©åœ¨å•æ¬¡è¿è¡Œä¸­è¡¨çŽ°æœ€å¥½çš„ç­–ç•¥æ—¶ï¼Œè¯¥ç­–ç•¥å¯èƒ½åªæ˜¯éžå¸¸å¹¸è¿ï¼Œä¹Ÿå¯èƒ½æ˜¯éžå¸¸ç³Ÿç³•çš„ç­–ç•¥ï¼Œåªæ˜¯ç¢°å·§è¡¨çŽ°éžå¸¸å¥½ã€‚è¿™æ˜¯å› ä¸ºæ¸¸æˆæœ¬èº«å…·æœ‰éšæœºæ€§(æ¯æ¬¡çš„èµ·å§‹ä½ç½®éƒ½ä¸åŒ)ï¼Œæ‰€ä»¥ä¸€é¡¹æ”¿ç­–å¯èƒ½åªåœ¨ä¸€ä¸ªèµ·å§‹ä½ç½®æœ‰æ•ˆï¼Œè€Œåœ¨å…¶ä»–ä½ç½®æ— æ•ˆã€‚

å› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è¯„ä¼°ä¸€é¡¹æ”¿ç­–åœ¨å¤šæ¬¡è¯•éªŒä¸­çš„è¡¨çŽ°ã€‚çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬é‡‡ç”¨ä¹‹å‰å‘çŽ°çš„æœ€ä½³ç­–ç•¥ï¼Œçœ‹çœ‹å®ƒåœ¨ 100 æ¬¡è¯•éªŒä¸­è¡¨çŽ°å¦‚ä½•ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çŽ© 100 æ¬¡æœ€ä½³ç­–ç•¥(`max`çš„ç´¢å¼• 2)ï¼Œå¹¶è®°å½•æ¯æ¬¡çš„åˆ†æ•°ã€‚ç„¶åŽï¼Œæˆ‘ä»¬ä½¿ç”¨`numpy`è®¡ç®—å¹³å‡åˆ†æ•°ï¼Œå¹¶å°†å…¶æ‰“å°åˆ°æˆ‘ä»¬çš„ç»ˆç«¯ã€‚â€œå·²è§£å†³â€æ²¡æœ‰æ˜Žç¡®çš„å®šä¹‰ï¼Œä½†åº”è¯¥åªæ¯” 500 å·®å‡ åˆ†ã€‚ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œæœ‰æ—¶å€™æœ€å¥½çš„æ”¿ç­–å®žé™…ä¸Šå¯èƒ½æ˜¯ä¸åˆæ ¼çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘å°†æŠŠä¿®å¤å·¥ä½œç•™ç»™æ‚¨æ¥å†³å®šï¼

# å®Œæˆ=çœŸ

*ç¥è´ºä½ ï¼*ðŸŽ‰æˆ‘ä»¬å·²ç»æˆåŠŸåœ°åˆ›é€ äº†ä¸€ä¸ªäººå·¥æ™ºèƒ½ï¼Œå¯ä»¥éžå¸¸æœ‰æ•ˆåœ°è§£å†³ cart poleï¼Œè€Œä¸”ç›¸å½“é«˜æ•ˆã€‚çŽ°åœ¨æœ‰å¾ˆå¤§çš„æ”¹è¿›ç©ºé—´ï¼Œè¿™å°†æ˜¯åŽç»­ç³»åˆ—æ–‡ç« çš„ä¸€éƒ¨åˆ†ã€‚æœ‰äº›äº‹æƒ…æˆ‘ä»¬å¯ä»¥æ·±å…¥è°ƒæŸ¥:

*   æ‰¾åˆ°ä¸€ä¸ªâ€œçœŸæ­£çš„â€æœ€ä¼˜ç­–ç•¥(å°†åœ¨ 100 ä¸ªå•ç‹¬çš„è¡ŒåŠ¨ä¸­è¡¨çŽ°è‰¯å¥½)
*   ä¼˜åŒ–æˆ‘ä»¬å¿…é¡»æœç´¢ä»¥æ‰¾åˆ°æœ€ä½³ç­–ç•¥çš„æ¬¡æ•°(â€œæ ·æœ¬æ•ˆçŽ‡â€)
*   å¯¹ä¿å•è¿›è¡Œé€‚å½“çš„æœç´¢ï¼Œè€Œä¸æ˜¯éšæ„æŒ‘é€‰ã€‚
*   è§£å†³[å…¶ä»–çŽ¯å¢ƒ](https://gym.openai.com/envs/#classic_control)ã€‚

å¦‚æžœæ‚¨æœ‰å…´è¶£åœ¨æ‚¨çš„ä¸‹ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨é¢„è®­ç»ƒæ¨¡åž‹å’Œå¼€ç®±å³ç”¨çš„å·¥ä½œä»£ç æ¥å°è¯•æ›´å¤šçš„ MLï¼Œè¯·æŸ¥çœ‹ [ModelDepot](https://modeldepot.io) ï¼