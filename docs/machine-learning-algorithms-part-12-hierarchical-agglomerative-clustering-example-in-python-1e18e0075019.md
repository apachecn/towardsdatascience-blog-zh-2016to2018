# Python ä¸­çš„å±‚æ¬¡å‡èšèšç±»ç®—æ³•å®ä¾‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/machine-learning-algorithms-part-12-hierarchical-agglomerative-clustering-example-in-python-1e18e0075019?source=collection_archive---------1----------------------->

![](img/8feabc19987671e04e93ef482cece815.png)

åˆ†å±‚èšç±»ç®—æ³•å°†ç›¸ä¼¼çš„å¯¹è±¡åˆ†ç»„ä¸ºç§°ä¸º**ç°‡**çš„ç»„ã€‚æœ‰ä¸¤ç§ç±»å‹çš„åˆ†å±‚èšç±»ç®—æ³•:

*   å‡èšâ€”è‡ªä¸‹è€Œä¸Šçš„æ–¹æ³•ã€‚ä»è®¸å¤šå°é›†ç¾¤å¼€å§‹ï¼Œå°†å®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·ä»¥åˆ›å»ºæ›´å¤§çš„é›†ç¾¤ã€‚
*   åˆ†è£‚â€”â€”è‡ªä¸Šè€Œä¸‹çš„æ–¹æ³•ã€‚ä»å•ä¸ªé›†ç¾¤å¼€å§‹ï¼Œç„¶åå°†å®ƒåˆ†æˆæ›´å°çš„é›†ç¾¤ã€‚

![](img/796857193ebf025e200232005c1b9af4.png)

# åˆ†å±‚èšç±»çš„ä¸€äº›ä¼˜ç‚¹å’Œç¼ºç‚¹

## èµæˆçš„æ„è§

*   ä¸å‡è®¾ç‰¹å®šæ•°é‡çš„èšç±»(å³ k å‡å€¼)
*   å¯èƒ½å¯¹åº”æœ‰æ„ä¹‰çš„åˆ†ç±»æ³•

## éª—å±€

*   ä¸€æ—¦å†³å®šåˆå¹¶ä¸¤ä¸ªé›†ç¾¤ï¼Œå°±æ— æ³•æ’¤é”€
*   å¯¹äºå¤§å‹æ•°æ®é›†å¤ªæ…¢ï¼ŒO(ğ‘›2 log(ğ‘›))

# å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„

1.  ä½¿æ¯ä¸ªæ•°æ®ç‚¹æˆä¸ºä¸€ä¸ªç¾¤é›†

![](img/00217283049a1a8fed4d240d41a34f8b.png)

2.å–ä¸¤ä¸ªæœ€è¿‘çš„é›†ç¾¤ï¼Œå¹¶ä½¿å®ƒä»¬æˆä¸ºä¸€ä¸ªé›†ç¾¤

![](img/e8e2f1b1a1df10677ab5cb9e6c4ef0a8.png)

3.é‡å¤æ­¥éª¤ 2ï¼Œç›´åˆ°åªæœ‰ä¸€ä¸ªé›†ç¾¤

![](img/642725a05cbb0a3c3f91b49a1d7fbd52.png)

# ç³»ç»Ÿæ ‘å›¾

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‘çŠ¶å›¾æ¥å¯è§†åŒ–åˆ†ç»„çš„å†å²ï¼Œå¹¶è®¡ç®—å‡ºæœ€ä½³çš„èšç±»æ•°ã€‚

1.  ç¡®å®šä¸ä¸ä»»ä½•å…¶ä»–èšç±»ç›¸äº¤çš„æœ€å¤§å‚ç›´è·ç¦»
2.  åœ¨ä¸¤ç«¯ç”»ä¸€æ¡æ°´å¹³çº¿
3.  èšç±»çš„æœ€ä½³æ•°é‡ç­‰äºç©¿è¿‡æ°´å¹³çº¿çš„å‚ç›´çº¿çš„æ•°é‡

ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„æƒ…å†µä¸­ï¼Œé›†ç¾¤æ•°é‡çš„æœ€ä½³é€‰æ‹©å°†æ˜¯ ***4*** ã€‚

![](img/ec56162d4a5199c252463480ee6cfb1e.png)

# é“¾æ¥æ ‡å‡†

ç±»ä¼¼äºæ¢¯åº¦ä¸‹é™ï¼Œæ‚¨å¯ä»¥è°ƒæ•´æŸäº›å‚æ•°ï¼Œä»¥è·å¾—æˆªç„¶ä¸åŒçš„ç»“æœã€‚

![](img/b7e090012a98aa711842aa40b3174459.png)

é“¾æ¥æ ‡å‡†æŒ‡çš„æ˜¯å¦‚ä½•è®¡ç®—èšç±»ä¹‹é—´çš„è·ç¦»ã€‚

![](img/986a94a8b6a7ce2fc07082c4dd8aa899.png)

## å•é”®

ä¸¤ä¸ªèšç±»ä¹‹é—´çš„è·ç¦»æ˜¯æ¯ä¸ªèšç±»ä¸­ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·ç¦»

![](img/affa5d8207412d8312682c4dd96510e7.png)

## å®Œå…¨è¿é”

ä¸¤ä¸ªèšç±»ä¹‹é—´çš„è·ç¦»æ˜¯æ¯ä¸ªèšç±»ä¸­ä¸¤ç‚¹ä¹‹é—´çš„æœ€é•¿è·ç¦»

![](img/e39d1e2589b69d0f1d9c0436b098e1f0.png)

## å¹³å‡è¿é”

èšç±»ä¹‹é—´çš„è·ç¦»æ˜¯ä¸€ä¸ªèšç±»ä¸­çš„æ¯ä¸ªç‚¹åˆ°å¦ä¸€ä¸ªèšç±»ä¸­çš„æ¯ä¸ªç‚¹çš„å¹³å‡è·ç¦»

![](img/6e5a20be7aa9b2c904d1ab2dbdcabad8.png)

## **ç—…æˆ¿**è”åŠ¨

èšç±»ä¹‹é—´çš„è·ç¦»æ˜¯æ‰€æœ‰èšç±»å†…çš„å¹³æ–¹å·®ä¹‹å’Œ

![](img/ff5993ff947efd0042576347a079cf02.png)

# è·ç¦»åº¦é‡

æ‚¨ç”¨æ¥è®¡ç®—æ•°æ®ç‚¹ä¹‹é—´è·ç¦»çš„æ–¹æ³•å°†å½±å“æœ€ç»ˆç»“æœã€‚

## æ¬§å‡ é‡Œå¾—è·ç¦»

ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·ç¦»ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ x=(aï¼Œb)ä¸” y=(cï¼Œd)ï¼Œåˆ™ x å’Œ y ä¹‹é—´çš„æ¬§å‡ é‡Œå¾·è·ç¦»ä¸ºâˆš(a c)+(b d)

![](img/807c2a314cfe5608874ab7e4c1a1a0dd.png)

## æ›¼å“ˆé¡¿è·ç¦»

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨ä¸€ä¸ªå¤§åŸå¸‚çš„å¸‚ä¸­å¿ƒï¼Œä½ æƒ³ä» A ç‚¹åˆ° b ç‚¹ã€‚ä½ ä¸èƒ½ç©¿è¿‡å»ºç­‘ç‰©ï¼Œè€Œæ˜¯å¿…é¡»æ²¿ç€ä¸åŒçš„è¡—é“è¡Œèµ°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ x=(aï¼Œb)ä¸” y=(cï¼Œd)ï¼Œåˆ™ x å’Œ y ä¹‹é—´çš„æ›¼å“ˆé¡¿è·ç¦»ä¸º| a c |+| b d |

![](img/7e8f51cebfb60c3775bb1a999e4e1bb2.png)

# python ä¸­çš„ç¤ºä¾‹

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œçœ‹çœ‹æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å±‚æ¬¡å‡èšèšç±»æ¥æ ‡è®°æ•°æ®ã€‚

```
import pandas as pd
import numpy as np
from matplotlib import pyplot as plt
from sklearn.cluster import AgglomerativeClustering
import scipy.cluster.hierarchy as sch
```

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ csv æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå®¢æˆ·åˆ—è¡¨ï¼ŒåŒ…æ‹¬ä»–ä»¬çš„æ€§åˆ«ã€å¹´é¾„ã€å¹´æ”¶å…¥å’Œæ”¯å‡ºåˆ†æ•°ã€‚

![](img/09dd4168c8ac8da636d466d417829c66.png)

å¦‚æœä½ æƒ³è·Ÿè¿›ï¼Œä½ å¯ä»¥ä» *superdatascience* ç½‘ç«™è·å¾—æ•°æ®é›†ã€‚

[](https://www.superdatascience.com/machine-learning/) [## æœºå™¨å­¦ä¹  A-Z:ä¸‹è½½å®è·µæ•°æ®é›†-è¶…çº§æ•°æ®ç§‘å­¦-å¤§æ•°æ®|åˆ†æèŒä¸šç”Ÿæ¶¯â€¦

### æ¬¢è¿æ¥åˆ°æœºå™¨å­¦ä¹ è¯¾ç¨‹çš„æ•°æ®ä»“åº“ï¼Œä½œè€…æ˜¯åŸºé‡Œå°”Â·å¶åˆ—ç¼…ç§‘å’Œå“ˆå¾·ç³Â·å¾·Â·åºç‰¹ç»´æ–¯â€¦

www.superdatascience.com](https://www.superdatascience.com/machine-learning/) 

ä¸ºäº†ç¨ååœ¨å›¾è¡¨ä¸Šæ˜¾ç¤ºæˆ‘ä»¬çš„æ•°æ®ï¼Œæˆ‘ä»¬åªèƒ½å–ä¸¤ä¸ªå˜é‡(å¹´æ”¶å…¥å’Œæ”¯å‡ºåˆ†æ•°)ã€‚

```
dataset = pd.read_csv('./data.csv')

X = dataset.iloc[:, [3, 4]].values
```

æŸ¥çœ‹æ ‘çŠ¶å›¾ï¼Œä¸ä¸ä»»ä½•é›†ç¾¤ç›¸äº¤çš„æœ€é«˜å‚ç›´è·ç¦»æ˜¯ä¸­é—´çš„ç»¿è‰²ã€‚å‡è®¾æœ‰ 5 æ¡å‚ç›´çº¿ç©¿è¿‡é˜ˆå€¼ï¼Œåˆ™æœ€ä½³èšç±»æ•°æ˜¯ 5ã€‚

```
dendrogram = sch.dendrogram(sch.linkage(X, method='ward'))
```

![](img/1ffdf76806fa8925f2fd23506e2c3997.png)

æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹`AgglomerativeClustering`,ä½¿ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»ä½œä¸ºç‚¹ä¹‹é—´è·ç¦»çš„åº¦é‡ï¼Œå¹¶ä½¿ç”¨ ward è¿æ¥æ¥è®¡ç®—èšç±»çš„é‚»è¿‘åº¦ã€‚

```
model = AgglomerativeClustering(n_clusters=5, affinity='euclidean', linkage='ward')
model.fit(X)
labels = model.labels_
```

å±æ€§è¿”å›ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œå…¶ä¸­çš„å€¼å¯¹åº”äºä¸åŒçš„ç±»åˆ«ã€‚

![](img/edcd2b5be2896c71e615cb7888547b80.png)

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç®€å†™ç¬¦å·å°†å±äºæŸä¸€ç±»åˆ«çš„æ‰€æœ‰æ ·æœ¬æ˜¾ç¤ºä¸ºç‰¹å®šçš„é¢œè‰²ã€‚

```
plt.scatter(X[labels==0, 0], X[labels==0, 1], s=50, marker='o', color='red')
plt.scatter(X[labels==1, 0], X[labels==1, 1], s=50, marker='o', color='blue')
plt.scatter(X[labels==2, 0], X[labels==2, 1], s=50, marker='o', color='green')
plt.scatter(X[labels==3, 0], X[labels==3, 1], s=50, marker='o', color='purple')
plt.scatter(X[labels==4, 0], X[labels==4, 1], s=50, marker='o', color='orange')
plt.show()
```

![](img/446365021d5477a81c2305ca1c49fc34.png)