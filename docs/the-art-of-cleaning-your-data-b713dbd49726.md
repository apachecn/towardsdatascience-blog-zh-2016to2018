# æ¸…ç†æ•°æ®çš„è‰ºæœ¯

> åŸæ–‡ï¼š<https://towardsdatascience.com/the-art-of-cleaning-your-data-b713dbd49726?source=collection_archive---------2----------------------->

## åƒå¥¥å·´é©¬æ”¾å¼ƒéº¦å…‹é£ä¸€æ ·æ”¾å¼ƒé‚£äº›ç³Ÿç³•çš„æ•°æ®

> æƒ³è·å¾—çµæ„Ÿï¼Ÿå¿«æ¥åŠ å…¥æˆ‘çš„ [**è¶…çº§è¡Œæƒ…å¿«è®¯**](https://www.superquotes.co/?utm_source=mediumtech&utm_medium=web&utm_campaign=sharing) ã€‚ğŸ˜

æ¸…ç†æ•°æ®åº”è¯¥æ˜¯æ•°æ®ç§‘å­¦(DS)æˆ–æœºå™¨å­¦ä¹ (ML)å·¥ä½œæµç¨‹çš„ç¬¬ä¸€æ­¥ã€‚æ²¡æœ‰å¹²å‡€çš„æ•°æ®ï¼Œä½ å°†å¾ˆéš¾çœ‹åˆ°æ¢ç´¢ä¸­çœŸæ­£é‡è¦çš„éƒ¨åˆ†ã€‚ä¸€æ—¦ä½ æœ€ç»ˆå¼€å§‹è®­ç»ƒä½ çš„ ML æ¨¡å‹ï¼Œå®ƒä»¬å°†ä¸å¿…è¦åœ°å˜å¾—æ›´å…·æŒ‘æˆ˜æ€§ã€‚æœ€ä¸»è¦çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœä½ æƒ³å……åˆ†åˆ©ç”¨ä½ çš„æ•°æ®ï¼Œå®ƒåº”è¯¥æ˜¯å¹²å‡€çš„ã€‚

åœ¨æ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ çš„èƒŒæ™¯ä¸‹ï¼Œæ•°æ®æ¸…ç†æ„å‘³ç€è¿‡æ»¤å’Œä¿®æ”¹æ•°æ®ï¼Œä»¥ä¾¿æ›´å®¹æ˜“æ¢ç´¢ã€ç†è§£å’Œå»ºæ¨¡ã€‚*è¿‡æ»¤æ‰*ä½ ä¸æƒ³è¦æˆ–ä¸éœ€è¦çš„éƒ¨åˆ†ï¼Œè¿™æ ·ä½ å°±ä¸éœ€è¦æŸ¥çœ‹æˆ–å¤„ç†å®ƒä»¬ã€‚*ä¿®æ”¹*æ‚¨*ç¡®å®éœ€è¦*çš„éƒ¨ä»¶ï¼Œä½†è¿™äº›éƒ¨ä»¶ä¸æ˜¯æ‚¨éœ€è¦çš„æ ¼å¼ï¼Œå› æ­¤æ‚¨å¯ä»¥æ­£ç¡®åœ°ä½¿ç”¨å®ƒä»¬ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†çœ‹çœ‹ä¸€äº›æˆ‘ä»¬é€šå¸¸æƒ³è¦åœ¨æˆ‘ä»¬çš„æ•°æ®ä¸­æ¸…ç†çš„ä¸œè¥¿ï¼Œä»¥åŠå¯ä»¥ç”¨æ¥åšè¿™ä»¶äº‹çš„ pandas ä»£ç ï¼

# ç¼ºå¤±æ•°æ®

å¤§å‹æ•°æ®é›†å¾ˆå°‘å®Œå…¨å¡«æ»¡ã€‚æˆ‘æ‰€è¯´çš„å®Œæ•´æ˜¯æŒ‡æ‰€æœ‰çš„æ•°æ®ç‚¹éƒ½æœ‰å…¶æ‰€æœ‰ç‰¹å¾å˜é‡çš„å€¼ã€‚é€šå¸¸ä¼šæœ‰ä¸€äº›ç¼ºå¤±çš„å€¼ï¼Œå½“åœ¨ pandas ä¸­åŠ è½½ç±»ä¼¼äº`pd.read_csv()`çš„ä¸œè¥¿æ—¶ï¼Œè¿™äº›å€¼ä¼šè¢«æ ‡è®°ä¸º NaN æˆ– Noneã€‚è¿™ç±»æ•°æ®ä¸¢å¤±æœ‰è®¸å¤šå®é™…åŸå› ã€‚æ”¶é›†æ•°æ®çš„äººå¯èƒ½åªæ˜¯å¿˜è®°äº†ï¼Œæˆ–è€…ä»–ä»¬ç›´åˆ°æ•°æ®æ”¶é›†è¿‡ç¨‹è¿›è¡Œåˆ°ä¸€åŠæ‰å¼€å§‹æ”¶é›†è¯¥ç‰¹å¾å˜é‡ã€‚

åœ¨å¤„ç†æ•°æ®é›†ä¹‹å‰ï¼Œç»å¯¹éœ€è¦å¤„ç†ç¼ºå¤±æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æ­£å¤„äºæ•°æ®æ¢ç´¢è¿‡ç¨‹ä¸­ï¼Œæ‚¨å‘ç°äº†æ¥è‡ªæŸä¸ªç‰¹å¾å˜é‡(æ¯”å¦‚â€œå˜é‡ Fâ€)çš„æ•°æ®çš„ä¸€äº›å…³é”®ä¿¡æ¯ã€‚ä½†æ˜¯åæ¥ä½ å‘ç°æ•°æ®é›†ä¸­â€œå˜é‡ Fâ€çš„ 95%çš„å€¼éƒ½æ˜¯ NaNs ä½ ä¸å¯èƒ½ä»ä¸€ä¸ªä»…ä»…ä»£è¡¨æ•°æ®é›† 5%çš„å˜é‡ä¸­å¾—å‡ºä»»ä½•å…³äºæ•°æ®é›†çš„å…·ä½“ç»“è®ºï¼å½“ä½ å¼€å§‹è®­ç»ƒä½ çš„ ML æ¨¡å‹æ—¶ï¼ŒNaNs ä¹Ÿå¯èƒ½è¢«ä½ çš„ç¨‹åºå½“ä½œ 0 æˆ–æ— ç©·å¤§ï¼Œå®Œå…¨æ‰“ä¹±äº†ä½ çš„è®­ç»ƒï¼

æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å¤„ç†ç†ŠçŒ«ä¸¢å¤±çš„æ•°æ®:

*   **æ£€æŸ¥ nan:**`pd.isnull(object)`æ£€æµ‹æ•°æ®ä¸­ç¼ºå¤±çš„å€¼ï¼›è¿™å°†æ£€æµ‹â€œNaNâ€å’Œâ€œNoneâ€
*   **åˆ é™¤ç¼ºå¤±æ•°æ®:** `df.dropna(axis=0, how='any')`è¿”å›åŒ…å« nan çš„æ•°æ®ç‚¹å·²è¢«åˆ é™¤çš„æ•°æ®æ¡†ã€‚
*   **æ›¿æ¢ç¼ºå¤±æ•°æ®:** `df.replace(to_replace=None, value=None)`ç”¨â€œå€¼â€æ›¿æ¢â€œto_replaceâ€ä¸­ç»™å®šçš„å€¼ã€‚å¦‚æœä½ çŸ¥é“ä½ å¸Œæœ›è¿™ä¸ªç‰¹å¾å˜é‡æ˜¯ä»€ä¹ˆå€¼ï¼Œè¿™æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚
*   **åˆ é™¤ä¸€ä¸ªç‰¹å¾:** `df.drop('feature_variable_name', axis=1)`å¦‚æœæ‚¨å‘ç°æŸä¸ªç‰¹å¾å˜é‡åœ¨æ•°æ®é›†ä¸­æœ‰> 90%çš„ NaN å€¼ï¼Œé‚£ä¹ˆä»æ‚¨çš„æ•°æ®ä¸­åˆ é™¤æ•´ä¸ªä¸œè¥¿æ˜¯æœ‰æ„ä¹‰çš„ã€‚

![](img/f411a6aeee8c496f2257d4e62842f77f.png)

Drop those bad features like an Obama mic drop

# æç«¯å€¼

æ•°æ®é›†ä¸­çš„å¼‚å¸¸å€¼æ˜¯ä¸€ä¸ªå¤§æ‚çƒ©ã€‚ä¸€æ–¹é¢ï¼Œå®ƒä»¬å¯èƒ½åŒ…å«å…³é”®ä¿¡æ¯ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¸»è¦ç¾¤ä½“æœ‰å¾ˆå¤§ä¸åŒã€‚å¦ä¸€æ–¹é¢ï¼Œå®ƒä»¬è®©æˆ‘ä»¬çœ‹ä¸åˆ°ä¸»è¦ç¾¤ä½“ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»çœ‹å¾—å¾ˆè¿œæ‰èƒ½çœ‹åˆ°ç¦»ç¾¤å€¼ï¼åœ¨æœ€å¤§ä¼¼ç„¶æ–¹é¢ï¼ŒåŒ…å«ç¦»ç¾¤å€¼çš„è®­ç»ƒå¯èƒ½ä¼šè®©ä½ çš„æ¨¡å‹æ›´å¥½åœ°æ³›åŒ–ï¼Œä½†ä¹Ÿä¼šæŠŠå®ƒä»ä½ çš„å¤§éƒ¨åˆ†æ•°æ®æ‰€åœ¨çš„ä¸»è¦ç»„ä¸­åˆ†ç¦»å‡ºæ¥ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œé€šå¸¸å»ºè®®ä¸¤é¢çœ‹ã€‚æ¢ç´¢æœ‰æ— å¼‚å¸¸å€¼çš„æ•°æ®ã€‚å¦‚æœæ‚¨å†³å®šæ‚¨çš„ ML æ¨¡å‹éœ€è¦å®ƒä»¬ï¼Œé‚£ä¹ˆé€‰æ‹©ä¸€ä¸ªè¶³å¤Ÿå¥å£®çš„æ–¹æ³•æ¥å¤„ç†å®ƒä»¬ã€‚å¦‚æœæ‚¨å‘ç°è¿™äº›å¼‚å¸¸å€¼ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”å¯¹è·å–å¤§å›¾ä¿¡æ¯å’Œæ•°æ®å»ºæ¨¡æ²¡æœ‰ç”¨å¤„ï¼Œé‚£ä¹ˆæœ€å¥½å°±åƒä¸Šä¸€èŠ‚æ‰€ç¤ºçš„é‚£æ ·ä¸¢å¼ƒå®ƒä»¬ã€‚

æ­¤å¤–ï¼Œå¦‚æœæ‚¨æƒ³è¦è¿‡æ»¤æ‰é‚£äº›å¼‚å¸¸å€¼ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•:

```
# Get the 98th and 2nd percentile as the limits of our outliers
upper_limit = np.percentile(train_df.logerror.values, 98) 
lower_limit = np.percentile(train_df.logerror.values, 2) # Filter the outliers from the dataframe
data[â€˜targetâ€™].loc[train_df[â€˜targetâ€™]>upper_limit] = upper_limit data[â€˜targetâ€™].loc[train_df[â€˜targetâ€™]<lower_limit] = lower_limit
```

![](img/73f53c986a07f5823b8f672b95c4e6a4.png)![](img/e3f9e73dd5ada9c3f89ffebe0d4d4c4d.png)

A plot with outliers included (left) and a histogram with outliers removed (right)

# é”™è¯¯æ•°æ®å’Œé‡å¤æ•°æ®

åæ•°æ®æ˜¯æŒ‡ä»»ä½•ä¸åº”è¯¥å­˜åœ¨çš„æ•°æ®ç‚¹æˆ–å€¼ï¼Œæˆ–è€…å®Œå…¨é”™è¯¯çš„æ•°æ®ç‚¹æˆ–å€¼ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨çš„ä¸€ä¸ªç‰¹å¾å˜é‡ç§°ä¸ºâ€œæ€§åˆ«â€ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†å€¼ä¸ºâ€œç”·æ€§â€æˆ–â€œå¥³æ€§â€ã€‚ä½†æ˜¯å½“ä½ æµè§ˆæ•°æ®é›†æ—¶ï¼Œä½ ä¼šæ³¨æ„åˆ°æœ‰å‡ ä¸ªæ•°æ®ç‚¹çš„æ€§åˆ«å€¼ä¸º 67.3ï¼æ˜¾ç„¶ï¼Œ67.3 åœ¨è¿™ä¸ªå˜é‡çš„ä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚æ­¤å¤–ï¼Œå¦‚æœæ‚¨å°è¯•å°†â€œæ€§åˆ«â€ç‰¹å¾å˜é‡è½¬æ¢ä¸ºåˆ†ç±»æµ®ç‚¹æ•°:ç”·æ€§= 0.0ï¼Œå¥³æ€§= 1.0ï¼Œæ‚¨å°†å¾—åˆ°ä¸€ä¸ªé¢å¤–çš„æ•°å­—:67.3 = 2.0ï¼

é‡å¤åªæ˜¯æ•°æ®é›†ä¸­å®Œå…¨é‡å¤çš„æ•°æ®ç‚¹ã€‚å¦‚æœæœ‰å¤ªå¤šè¿™æ ·çš„é—®é¢˜ï¼Œå°±ä¼šå½±å“ä½ çš„ ML æ¨¡å‹çš„è®­ç»ƒã€‚å°±åƒæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„é‚£æ ·ï¼Œå¯ä»¥ç®€å•åœ°ä»æ•°æ®ä¸­åˆ é™¤é‡å¤é¡¹ã€‚

å¯ä»¥é€šè¿‡ä¸¢å¼ƒæˆ–ä½¿ç”¨ä¸€äº›æ™ºèƒ½æ›¿æ¢æ¥å¤„ç†åæ•°æ®ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæŸ¥çœ‹æ€§åˆ«å€¼ä¸º 67.3 çš„æ•°æ®ç‚¹ï¼Œå¹¶çœ‹åˆ°æ‰€æœ‰è¿™äº›æ•°æ®ç‚¹çš„æ­£ç¡®å€¼éƒ½åº”è¯¥æ˜¯â€œå¥³æ€§â€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†æ‰€æœ‰ 67.3 çš„å€¼è½¬æ¢ä¸ºâ€œå¥³æ€§â€ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬æœ‰æ•ˆåœ°ä¸º ML è®­ç»ƒè·å¾—äº†è¿™äº›æ•°æ®ç‚¹ï¼Œè€Œä¸æ˜¯æŠŠå®ƒä»¬æ‰”æ‰ã€‚ä½ å¯ä»¥åœ¨ç†ŠçŒ«èº«ä¸Šåšè¿™æ ·çš„è½¬æ¢:

```
value_map = {'male': 'male', 'female': 'female', '67.3': 'female'}pd_dataframe['gender'].map(value_map)
```

![](img/613645b1803cb472d6d90a5d83681a87.png)

Watch out for that duplicate Loki data

# æ— å…³çš„ç‰¹å¾

å¹¶éæ‰€æœ‰åŠŸèƒ½éƒ½æ˜¯ç›¸åŒçš„ã€‚æœ‰äº›ä¸œè¥¿ä½ å¯èƒ½æ ¹æœ¬ä¸éœ€è¦ï¼ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½æ­£åœ¨æŸ¥çœ‹è¿‡å»ä¸€å¹´ä» Amazon è´­ä¹°çš„å›¾ä¹¦æ•°æ®é›†ï¼Œå…¶ä¸­ä¸€ä¸ªç‰¹å¾å˜é‡ç§°ä¸ºâ€œfont-type â€,è¡¨ç¤ºä¹¦ä¸­ä½¿ç”¨çš„å­—ä½“ç±»å‹ã€‚è¿™ä¸é¢„æµ‹ä¸€æœ¬ä¹¦çš„é”€é‡å®Œå…¨æ— å…³ï¼æ‚¨å¯ä»¥åƒè¿™æ ·å®‰å…¨åœ°åˆ é™¤æ‰€æœ‰è¿™äº›ç‰¹æ€§:

`df.drop('feature_variable_name', axis=1)`

è¿™æ ·åšå¯ä»¥è®©ä½ çš„æ•°æ®æ¢ç´¢å˜å¾—æ›´å®¹æ˜“ï¼Œå› ä¸ºä½ ä¸éœ€è¦æµè§ˆå¤ªå¤šçš„ä¸œè¥¿ã€‚è¿™ä¹Ÿæœ‰åŠ©äºè®­ç»ƒä½ çš„ ML æ¨¡å‹æ›´å®¹æ˜“å’Œæ›´å¿«ï¼Œå› ä¸ºä½ ä¸éœ€è¦å¤„ç†å¤ªå¤šçš„æ•°æ®ã€‚å¦‚æœæ‚¨ä¸ç¡®å®šå˜é‡æ˜¯å¦é‡è¦ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ç­‰åˆ°å¼€å§‹ç ”ç©¶æ•°æ®é›†æ—¶å†åšå†³å®šã€‚è®¡ç®—ç‰¹å¾å˜é‡å’Œç›®æ ‡è¾“å‡ºä¹‹é—´çš„ç›¸å…³çŸ©é˜µæœ‰åŠ©äºç¡®å®šå˜é‡çš„é‡è¦æ€§ã€‚

![](img/dde9294242dac538666f2831cee013d1.png)

When your feature variable is useless â€¦

# æ ‡å‡†åŒ–

æ¯ä¸ªç‰¹å¾å˜é‡ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½åº”è¯¥é‡‡ç”¨ç›¸åŒçš„æ ‡å‡†åŒ–æ ¼å¼ã€‚å®ƒå°†ä½¿æ•°æ®æ¢ç´¢å’Œå»ºæ¨¡çš„æŠ€æœ¯æ–¹é¢å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬å†æ¬¡ä»¥å€¼ä¸ºâ€œç”·æ€§â€æˆ–â€œå¥³æ€§â€çš„â€œæ€§åˆ«â€å˜é‡ä¸ºä¾‹ã€‚å¦‚æœæ•°æ®æ˜¯ç”±ä¸€ä¸ªäººæ”¶é›†çš„ï¼Œæ‚¨å¯èƒ½ä¼šå¾—åˆ°è®¸å¤šæ‚¨æ²¡æœ‰é¢„æ–™åˆ°çš„ä¸åŒå€¼:

*   ç”·ï¼Œå¥³(è¿™ä¸ªä¸é”™)
*   ç”·æ€§ï¼Œå¥³æ€§(è¾“å…¥æ—¶å¤§å†™é”å®š)
*   ç”·æ€§ï¼Œå¥³æ€§(æœ‰äº›äººä¼šå¤§å†™)
*   Makeï¼ŒFemall(é”™åˆ«å­—ï¼)

å¦‚æœæˆ‘ä»¬ç»§ç»­å°†ç‰¹å¾å˜é‡è½¬æ¢æˆåˆ†ç±»æµ®ç‚¹æ•°ï¼Œæˆ‘ä»¬å°†å¾—åˆ°æ¯”æˆ‘ä»¬æƒ³è¦çš„ 0 å’Œ 1 æ›´å¤šçš„å€¼ï¼æˆ‘ä»¬å®é™…ä¸Šä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœ:

```
{
    'male': 0,
    'female': 1,
    'MALE': 2,
    'FEMALE': 3,
    'Male': 4,
    'Female': 5,
    'Make': 6,
    'Femall': 7
}
```

æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å¤„ç†è¿™ç§æƒ…å†µã€‚å¦‚æœäº‹æƒ…å¾ˆç®€å•ï¼Œæ¯”å¦‚å…¨éƒ¨å°å†™æˆ–é¦–å­—æ¯å¤§å†™ï¼Œå°±åƒè¿™æ ·åš:

```
# Make the whole string lower case
s.lower()# Make the first letter capitalised
s.capitalize()
```

å¦‚æœæœ‰é”™åˆ«å­—ï¼Œæ‚¨éœ€è¦ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„æ˜ å°„åŠŸèƒ½:

```
value_map = {'Make': 'male', 'Femall': 'female'}pd_dataframe['gender'].map(value_map)
```

# å–œæ¬¢å­¦ä¹ ï¼Ÿ

åœ¨ [twitter](https://twitter.com/GeorgeSeif94) ä¸Šå…³æ³¨æˆ‘ï¼Œæˆ‘ä¼šåœ¨é‚£é‡Œå‘å¸ƒæ‰€æœ‰æœ€æ–°æœ€æ£’çš„äººå·¥æ™ºèƒ½ã€æŠ€æœ¯å’Œç§‘å­¦ï¼