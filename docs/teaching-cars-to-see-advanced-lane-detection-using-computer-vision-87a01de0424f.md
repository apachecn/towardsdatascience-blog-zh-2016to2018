# æ•™æ±½è½¦çœ‹ä¸œè¥¿â€”â€”ä½¿ç”¨è®¡ç®—æœºè§†è§‰è¿›è¡Œé«˜çº§è½¦é“æ£€æµ‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/teaching-cars-to-see-advanced-lane-detection-using-computer-vision-87a01de0424f?source=collection_archive---------0----------------------->

![](img/0be032361ba078aa1fab816080fc3df9.png)

Lane With Motion Blur (from Pexels)

*è¿™æ˜¯* [*Udacity è‡ªåŠ¨é©¾é©¶æ±½è½¦å·¥ç¨‹å¸ˆçº³ç±³å­¦ä½*](https://www.udacity.com/course/self-driving-car-engineer-nanodegree--nd013) *ç¬¬ä¸€å­¦æœŸçš„é¡¹ç›® 4ã€‚ä½ å¯ä»¥åœ¨*[*github*](https://github.com/kenshiro-o/CarND-Advanced-Lane-Lines)*ä¸Šæ‰¾åˆ°ä¸è¿™ä¸ªé¡¹ç›®ç›¸å…³çš„æ‰€æœ‰ä»£ç ã€‚ä½ ä¹Ÿå¯ä»¥é˜…è¯»æˆ‘ä»¥å‰é¡¹ç›®çš„å¸–å­:*

*   *é¡¹ç›® 1:* [*åˆ©ç”¨è®¡ç®—æœºè§†è§‰æ£€æµ‹è½¦é“çº¿*](https://medium.com/computer-car/udacity-self-driving-car-nanodegree-project-1-finding-lane-lines-9cd6a846c58c)
*   *é¡¹ç›®äºŒ:* [*äº¤é€šæ ‡å¿—åˆ†ç±»ä½¿ç”¨æ·±åº¦å­¦ä¹ *](https://medium.com/towards-data-science/recognizing-traffic-signs-with-over-98-accuracy-using-deep-learning-86737aedc2ab)
*   *é¡¹ç›®ä¸‰:* [*è½¬å‘è§’åº¦é¢„æµ‹åˆ©ç”¨æ·±åº¦å­¦ä¹ *](https://medium.com/towards-data-science/teaching-cars-to-drive-using-deep-learning-steering-angle-prediction-5773154608f2)

è¯†åˆ«é“è·¯ä¸Šçš„è½¦é“æ˜¯æ‰€æœ‰äººç±»é©¾é©¶å‘˜æ‰§è¡Œçš„å…±åŒä»»åŠ¡ï¼Œä»¥ç¡®ä¿ä»–ä»¬çš„è½¦è¾†åœ¨è¡Œé©¶æ—¶å¤„äºè½¦é“é™åˆ¶å†…ï¼Œä»è€Œç¡®ä¿äº¤é€šé¡ºç•…ï¼Œå¹¶å°†ä¸é™„è¿‘è½¦é“ä¸Šçš„å…¶ä»–è½¦è¾†å‘ç”Ÿç¢°æ’çš„å¯èƒ½æ€§é™è‡³æœ€ä½ã€‚åŒæ ·ï¼Œè¿™ä¹Ÿæ˜¯è‡ªåŠ¨é©¾é©¶æ±½è½¦è¦å®Œæˆçš„ä¸€é¡¹å…³é”®ä»»åŠ¡ã€‚äº‹å®è¯æ˜ï¼Œä½¿ç”¨ä¼—æ‰€å‘¨çŸ¥çš„è®¡ç®—æœºè§†è§‰æŠ€æœ¯æ¥è¯†åˆ«é“è·¯ä¸Šçš„è½¦é“æ ‡å¿—æ˜¯å¯èƒ½çš„ã€‚æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨å„ç§æŠ€æœ¯æ¥è¯†åˆ«å’Œç»˜åˆ¶è½¦é“å†…ä¾§ï¼Œè®¡ç®—è½¦é“æ›²ç‡ï¼Œç”šè‡³ä¼°è®¡è½¦è¾†ç›¸å¯¹äºè½¦é“ä¸­å¿ƒçš„ä½ç½®ã€‚

ä¸ºäº†æ£€æµ‹å¹¶ç»˜åˆ¶ä¸€ä¸ªå‘ˆç°æ±½è½¦å½“å‰æ‰€åœ¨è½¦é“å½¢çŠ¶çš„å¤šè¾¹å½¢ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç”±ä»¥ä¸‹æ­¥éª¤ç»„æˆçš„ç®¡é“:

*   ä»ä¸€ç»„æ£‹ç›˜å›¾åƒè®¡ç®—æ‘„åƒæœºæ ‡å®šçŸ©é˜µå’Œç•¸å˜ç³»æ•°
*   å›¾åƒå¤±çœŸæ¶ˆé™¤
*   åº”ç”¨é¢œè‰²å’Œæ¢¯åº¦é˜ˆå€¼æ¥èšç„¦è½¦é“çº¿
*   é€šè¿‡é€è§†å˜æ¢ç”Ÿæˆ*é¸Ÿç°å›¾*å›¾åƒ
*   ä½¿ç”¨æ»‘åŠ¨çª—å£å¯»æ‰¾*çƒ­ç‚¹*è½¦é“çº¿åƒç´ 
*   æ‹ŸåˆäºŒæ¬¡å¤šé¡¹å¼ä»¥è¯†åˆ«æ„æˆè½¦é“çš„å·¦çº¿å’Œå³çº¿
*   è½¦é“æ›²ç‡å’Œåç¦»è½¦é“ä¸­å¿ƒçš„è®¡ç®—
*   åœ¨å›¾åƒä¸Šæ‰­æ›²å’Œç»˜åˆ¶è½¦é“è¾¹ç•Œä»¥åŠè½¦é“æ›²ç‡ä¿¡æ¯

æˆ‘ç›¸ä¿¡ä¸€å¼ å›¾èƒœè¿‡åƒè¨€ä¸‡è¯­ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œ:

![](img/416c04d909aa7ef7646d5d8d0c67587d.png)

Diagram of our Lane Detection Pipeline

# ç›¸æœºæ ¡å‡†å’Œå›¾åƒå¤±çœŸæ¶ˆé™¤

æˆ‘ä»¬å°†é‡‡å–çš„ç¬¬ä¸€æ­¥æ˜¯æ‰¾åˆ°æ ¡å‡†çŸ©é˜µï¼Œä»¥åŠç”¨äºæ‹æ‘„é“è·¯ç…§ç‰‡çš„æ‘„åƒæœºçš„å¤±çœŸç³»æ•°ã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºç›¸æœºé•œå¤´çš„å‡¸é¢å½¢çŠ¶ä½¿å…‰çº¿åœ¨è¿›å…¥é’ˆå­”æ—¶å‘ç”Ÿå¼¯æ›²ï¼Œä»è€Œå¯¼è‡´çœŸå®å›¾åƒå¤±çœŸã€‚å› æ­¤ï¼Œç°å®ä¸–ç•Œä¸­çš„ç›´çº¿å¯èƒ½ä¸ä¼šå†å‡ºç°åœ¨æˆ‘ä»¬çš„ç…§ç‰‡ä¸Šã€‚

ä¸ºäº†è®¡ç®—ç›¸æœºçš„å˜æ¢çŸ©é˜µå’Œå¤±çœŸç³»æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒä¸€å°ç›¸æœºæ‹æ‘„çš„ä¸€ä¸ª*æ£‹ç›˜*åœ¨ä¸€ä¸ªå¹³é¢ä¸Šçš„å¤šå¼ ç…§ç‰‡ã€‚OpenCV æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•å«åš[findchesboardcorners](http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#cv2.findChessboardCorners)ï¼Œå®ƒå°†è¯†åˆ«é»‘ç™½æ–¹å—ç›¸äº¤çš„ç‚¹ï¼Œå¹¶ä»¥è¿™ç§æ–¹å¼é€†å‘å·¥ç¨‹æ‰­æ›²çŸ©é˜µã€‚ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨æ ·æœ¬å›¾åƒä¸Šè·Ÿè¸ªçš„å·²è¯†åˆ«æ£‹ç›˜è§’:

![](img/80ea68f6456917e506a28e488db849aa.png)

9x6 corners of chessboard found

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è§’ç‚¹éå¸¸æ¸…æ™°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ä»ä¸åŒè§’åº¦æ‹æ‘„çš„å¤šä¸ªæ£‹ç›˜å›¾åƒä¸Šè¿è¡Œæˆ‘ä»¬çš„æ£‹ç›˜å¯»æ‰¾ç®—æ³•ï¼Œä»¥è¯†åˆ«å›¾åƒå’Œå¯¹è±¡ç‚¹æ¥æ ¡å‡†ç›¸æœºã€‚å‰è€…æŒ‡çš„æ˜¯æˆ‘ä»¬çš„ 2D æ˜ å°„ä¸­çš„åæ ‡ï¼Œè€Œåè€…è¡¨ç¤ºè¿™äº›å›¾åƒç‚¹åœ¨ 3D ç©ºé—´ä¸­çš„çœŸå®åæ ‡(å¯¹äºæˆ‘ä»¬çš„æ£‹ç›˜å›¾åƒï¼Œz è½´æˆ–æ·±åº¦= 0)ã€‚è¿™äº›æ˜ å°„ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ‰¾å‡ºå¦‚ä½•æ­£ç¡®åœ°æ¶ˆé™¤ä»åŒä¸€å°ç›¸æœºæ‹æ‘„çš„å›¾åƒä¸Šçš„å¤±çœŸã€‚ä½ å¯ä»¥åœ¨ä¸‹å›¾ä¸­çœ‹åˆ°å®ƒçš„æœ‰æ•ˆæ€§:

![](img/cf51e3222ad8941372cce1dcfda1f17a.png)

original vs undistorted chessboard images

æˆ‘ä»¬ç°åœ¨å¯ä»¥æ‰­è½¬æ‰€æœ‰å›¾åƒçš„å¤±çœŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:

![](img/dfe74417aa6d44045fc13e78c11314e0.png)

sample of original vs undistorted images

# é˜ˆå€¼å¤„ç†

æˆ‘ä»¬åœ¨è¿™ä¸€éƒ¨åˆ†åº”ç”¨é¢œè‰²å’Œè¾¹ç¼˜é˜ˆå€¼æ¥æ›´å¥½åœ°æ£€æµ‹çº¿æ¡ï¼Œå¹¶ä½¿å…¶æ›´å®¹æ˜“æ‰¾åˆ°æœ€å¥½åœ°æè¿°æˆ‘ä»¬çš„å·¦å³è½¦é“çš„å¤šé¡¹å¼ã€‚

æˆ‘ä»¬é¦–å…ˆæ¢ç´¢æˆ‘ä»¬åº”è¯¥é‡‡ç”¨å“ªäº›é¢œè‰²ç©ºé—´æ¥å¢åŠ æˆ‘ä»¬æ£€æµ‹è½¦é“çš„æœºä¼šå¹¶ä¿ƒè¿›æ¢¯åº¦é˜ˆå€¼æ­¥éª¤çš„ä»»åŠ¡ã€‚

## é¢œè‰²é˜ˆå€¼

æˆ‘ä»¬å¯¹ä¸åŒçš„è‰²å½©ç©ºé—´è¿›è¡Œäº†å®éªŒï¼Œä»¥äº†è§£æˆ‘ä»¬åº”è¯¥ä½¿ç”¨å“ªç§è‰²å½©ç©ºé—´å’Œé€šé“æ¥æœ€æœ‰æ•ˆåœ°åˆ†ç¦»è½¦é“çº¿:

![](img/efd3b4d1d0ebe9cfee4273da66642e6b.png)

from top to bottom: RGB, HLS, HSV, LAB color spaces split in their 3 channels

åœ¨ RGB åˆ†é‡ä¸Šï¼Œæˆ‘ä»¬çœ‹åˆ°è“è‰²é€šé“åœ¨è¯†åˆ«é»„çº¿æ–¹é¢æœ€å·®ï¼Œè€Œçº¢è‰²é€šé“ä¼¼ä¹ç»™å‡ºäº†æœ€å¥½çš„ç»“æœã€‚

å¯¹äº HLS å’Œ HSVï¼Œè‰²è°ƒé€šé“äº§ç”Ÿæå…¶å˜ˆæ‚çš„è¾“å‡ºï¼Œè€Œ HLS çš„é¥±å’Œé€šé“ä¼¼ä¹ç»™å‡ºäº†å¼ºæœ‰åŠ›çš„ç»“æœï¼›æ¯” HSV çš„é¥±å’Œé€šé“è¦å¥½ã€‚ç›¸åï¼ŒHSV çš„å€¼é€šé“ç»™å‡ºäº†éå¸¸æ¸…æ™°çš„ç°åº¦å›¾åƒï¼Œç‰¹åˆ«æ˜¯åœ¨é»„çº¿ä¸Šï¼Œæ¯” HLS çš„äº®åº¦é€šé“å¥½å¾—å¤šã€‚

æœ€åï¼Œå®éªŒå®¤çš„ A é€šé“è¡¨ç°ä¸ä½³ï¼Œè€Œ B é€šé“æ“…é•¿è¯†åˆ«é»„çº¿ã€‚ä½†æ˜¯ï¼Œåœ¨è¯†åˆ«é»„çº¿å’Œç™½çº¿æ—¶å‘å…‰çš„æ˜¯äº®åº¦é€šé“(æ²¡æœ‰åŒå…³çš„æ„æ€)ã€‚

åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬é¢ä¸´ç€å„ç§æœ‰åˆ©æœ‰å¼Šçš„é€‰æ‹©ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨ç»™å®šçš„é¢œè‰²é€šé“ä¸Šæ‰¾åˆ°åˆé€‚çš„é˜ˆå€¼æ¥çªå‡ºè½¦é“çš„é»„çº¿å’Œç™½çº¿ã€‚å®é™…ä¸Šï¼Œæœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å®ç°è¿™ä¸€ç»“æœï¼Œä½†æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ HLSï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•ä»[é¡¹ç›® 1:ç®€å•è½¦é“æ£€æµ‹](https://github.com/kenshiro-o/CarND-LaneLines-P1)ä¸­è®¾ç½®é»„è‰²å’Œç™½è‰²è½¦é“çº¿çš„é˜ˆå€¼ã€‚

ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†æˆ‘ä»¬å¦‚ä½•å¯¹ HLS ä¸Šçš„ç™½è‰²å’Œé»„è‰²(æˆ‘ä»¬çš„è½¦é“é¢œè‰²)è¿›è¡Œé˜ˆå€¼å¤„ç†ï¼Œå¹¶ç”ŸæˆäºŒè¿›åˆ¶å›¾åƒ:

```
def compute_hls_white_yellow_binary(rgb_img):
    """
    Returns a binary thresholded image produced retaining only white and yellow elements on the picture
    The provided image should be in RGB format
    """
    hls_img = to_hls(rgb_img)

    # Compute a binary thresholded image where yellow is isolated from HLS components
    img_hls_yellow_bin = np.zeros_like(hls_img[:,:,0])
    img_hls_yellow_bin[((hls_img[:,:,0] >= 15) & (hls_img[:,:,0] <= 35))
                 & ((hls_img[:,:,1] >= 30) & (hls_img[:,:,1] <= 204))
                 & ((hls_img[:,:,2] >= 115) & (hls_img[:,:,2] <= 255))                
                ] = 1

    # Compute a binary thresholded image where white is isolated from HLS components
    img_hls_white_bin = np.zeros_like(hls_img[:,:,0])
    img_hls_white_bin[((hls_img[:,:,0] >= 0) & (hls_img[:,:,0] <= 255))
                 & ((hls_img[:,:,1] >= 200) & (hls_img[:,:,1] <= 255))
                 & ((hls_img[:,:,2] >= 0) & (hls_img[:,:,2] <= 255))                
                ] = 1

    # Now combine both
    img_hls_white_yellow_bin = np.zeros_like(hls_img[:,:,0])
    img_hls_white_yellow_bin[(img_hls_yellow_bin == 1) | (img_hls_white_bin == 1)] = 1

    return img_hls_white_yellow_bin
```

ç»“æœå¦‚ä¸‹æ‰€ç¤º:

![](img/9e009fbd1d8a076611762f172e0b8cad.png)

undistorted vs HLS binary color image (filtering for yellow and white)

æ­£å¦‚ä½ åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬çš„ HLS é¢œè‰²é˜ˆå€¼åœ¨å›¾åƒä¸Šå–å¾—äº†å¾ˆå¥½çš„æ•ˆæœã€‚é˜ˆå€¼å¤„ç†ä¸å‰é¢é»„çº¿ä¸Šçš„æ ‘çš„é˜´å½±æœ‰ç‚¹å†²çªã€‚æˆ‘ä»¬è®¤ä¸ºæ¢¯åº¦é˜ˆå€¼åœ¨è¿™ç§æƒ…å†µä¸‹ä¼šæœ‰æ‰€å¸®åŠ©ã€‚

## æ¢¯åº¦é˜ˆå€¼

æˆ‘ä»¬ä½¿ç”¨ [Sobel](https://en.wikipedia.org/wiki/Sobel_operator) ç®—å­æ¥è¯†åˆ«*æ¢¯åº¦*ï¼Œå³å›¾åƒä¸­*é¢œè‰²å¼ºåº¦*çš„å˜åŒ–ã€‚è¾ƒé«˜çš„å€¼è¡¨ç¤ºå¼ºçƒˆçš„æ¢¯åº¦ï¼Œå› æ­¤é¢œè‰²å˜åŒ–å‰§çƒˆã€‚

æˆ‘ä»¬å†³å®šä½¿ç”¨å®éªŒå®¤çš„ L é€šé“ä½œä¸ºå•é€šé“å›¾åƒï¼Œä½œä¸ºä»¥ä¸‹ sobel å‡½æ•°çš„è¾“å…¥ã€‚

æˆ‘ä»¬è¯•éªŒäº†è®¸å¤šå‚æ•°å’Œä¸åŒçš„ Sobel æ“ä½œ(æ‰€æœ‰è¿™äº›éƒ½å¯ä»¥åœ¨è¿™ä¸ª Jupyter [ç¬”è®°æœ¬](https://github.com/kenshiro-o/CarND-Advanced-Lane-Lines/blob/master/notebook.ipynb)ä¸Šçœ‹åˆ°)ï¼Œå¾—å‡ºäº†è¿™ä¸ªæœ€ç»ˆç»“æœ:

![](img/84d482a58534ab7556f96ba8d65d4d2f.png)

Results of multiple sobel operations

æˆ‘ä»¬ä»åº•éƒ¨é€‰æ‹©ç¬¬äºŒä¸ªå›¾åƒä½œä¸ºæˆ‘ä»¬çš„æœ€ä½³ç»“æœã€‚è¯·æ³¨æ„ï¼Œåœ¨æˆ‘ä»¬é€‰æ‹©çš„å›¾åƒä¸Šï¼Œæˆ‘ä»¬åº”ç”¨äº† 15x15 åƒç´ çš„å†…æ ¸ï¼Œä»è€Œæœ‰æ•ˆåœ°å¹³æ»‘äº†åƒç´ ï¼Œäº§ç”Ÿäº†æ›´æ¸…æ™°çš„äºŒè¿›åˆ¶å›¾åƒã€‚

## ç»“åˆä¸¤è€…

æˆ‘ä»¬è‡ªç„¶åœ°å°†å½©è‰²å’Œ Sobel é˜ˆå€¼åŒ–çš„äºŒå€¼å›¾åƒç»“åˆèµ·æ¥ï¼Œå¹¶å¾—åˆ°ä»¥ä¸‹ç»“æœ:

![](img/fdab13ce71035ec5df56b37269efc8bd.png)

combined color and gradient thresholded images in (R)GB and binary formats

åœ¨å·¦è¾¹çš„å›¾åƒä¸­ï¼Œæ‰€æœ‰çš„ç»¿è‰²åƒç´ è¢«æˆ‘ä»¬çš„ Sobel é˜ˆå€¼åŒ–ä¿ç•™ï¼Œè€Œè“è‰²åƒç´ è¢«æˆ‘ä»¬çš„ HLS é¢œè‰²é˜ˆå€¼åŒ–è¯†åˆ«ã€‚ç»“æœéå¸¸ä»¤äººé¼“èˆï¼Œä¼¼ä¹æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†æ­£ç¡®çš„å‚æ•°ï¼Œä»¥ç¨³å¥çš„æ–¹å¼æ£€æµ‹è½¦é“ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹æˆ‘ä»¬çš„å›¾åƒè¿›è¡Œé€è§†å˜æ¢ï¼Œå¹¶ç”Ÿæˆè½¦é“çš„é¸Ÿç°å›¾ã€‚

# é€è§†å˜æ¢

æˆ‘ä»¬ç°åœ¨éœ€è¦åœ¨ 2D å›¾åƒä¸­å®šä¹‰ä¸€ä¸ªæ¢¯å½¢åŒºåŸŸï¼Œè¯¥åŒºåŸŸå°†é€šè¿‡é€è§†å˜æ¢è½¬æ¢ä¸ºé¸Ÿç°å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤º:

![](img/7e27894876593a2c6eba1ab3df235de3.png)

trapezoid of lane on road

ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰ 4 ä¸ªé¢å¤–çš„ç‚¹ï¼Œå®ƒä»¬å½¢æˆä¸€ä¸ªçŸ©å½¢ï¼Œæ˜ å°„åˆ°æˆ‘ä»¬çš„æºæ¢¯å½¢ä¸­çš„åƒç´ :

```
dst_pts = np.array([[200, bottom_px], [200, 0], [1000, 0], [1000, bottom_px]], np.float32)
```

é€è§†å˜æ¢äº§ç”Ÿä»¥ä¸‹ç±»å‹çš„å›¾åƒ:

![](img/3aef4c8812af0c32ddee9bec3348202d.png)

birdâ€™s eye view on both straight and curved lanes

# æŠŠæ‰€æœ‰çš„æ”¾åœ¨ä¸€èµ·

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„é€è§†å˜æ¢ä¿æŒç›´çº¿ç¬”ç›´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¿…éœ€çš„å¥å…¨æ€§æ£€æŸ¥ã€‚ç„¶è€Œï¼Œæ›²çº¿åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­å¹¶ä¸å®Œç¾ï¼Œä½†æ˜¯å®ƒä»¬ä¹Ÿä¸ä¼šç»™æˆ‘ä»¬çš„ç®—æ³•å¸¦æ¥æ— æ³•å…‹æœçš„é—®é¢˜ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†é˜ˆå€¼å¤„ç†åº”ç”¨äºé¸Ÿç°å›¾å›¾åƒ:

![](img/701afa336f7bcb03079a5d1358dd5bd4.png)

test images with perspective transform, color and gradient thresholds applied

# æŸ±çŠ¶å›¾

ç„¶åï¼Œæˆ‘ä»¬åœ¨å›¾åƒçš„ä¸‹åŠéƒ¨åˆ†è®¡ç®— y æ–¹å‘ä¸Šçš„äºŒè¿›åˆ¶é˜ˆå€¼å›¾åƒçš„ç›´æ–¹å›¾ï¼Œä»¥è¯†åˆ«åƒç´ å¼ºåº¦æœ€é«˜çš„ x ä½ç½®:

![](img/80e168f6ec8a807cf4b7b1e020274ab4.png)

Left: birds eye view binary representation of lane. Right: histogram of pixel intensities of the image

# å¯»æ‰¾çº¿æ¡å¹¶ç»˜åˆ¶è½¦é“åŒºåŸŸ

## æ¨æ‹‰çª—

å› ä¸ºæˆ‘ä»¬ç°åœ¨çŸ¥é“äº†æœ€æœ‰å¯èƒ½äº§ç”Ÿè½¦é“çº¿çš„åƒç´ çš„èµ·å§‹ x ä½ç½®(ä»å›¾åƒçš„åº•éƒ¨å¼€å§‹)ï¼Œæˆ‘ä»¬è¿è¡Œäº†ä¸€ä¸ª[æ»‘åŠ¨çª—å£æœç´¢](https://www.coursera.org/learn/machine-learning/lecture/bQhq3/sliding-windows)ï¼Œè¯•å›¾â€œæ•è·â€æˆ‘ä»¬è½¦é“çº¿çš„åƒç´ åæ ‡ã€‚

ä»é‚£æ—¶èµ·ï¼Œæˆ‘ä»¬é€šè¿‡ numpy çš„ [polyfit](https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.polyfit.html) ç®€å•åœ°è®¡ç®—ä¸€ä¸ªäºŒæ¬¡å¤šé¡¹å¼ï¼Œæ‰¾åˆ°æœ€é€‚åˆå·¦å³è½¦é“çº¿çš„æ›²çº¿ç³»æ•°ã€‚

æˆ‘ä»¬æ”¹è¿›ç®—æ³•çš„ä¸€ç§æ–¹æ³•æ˜¯ä¿å­˜å…ˆå‰ä¸ºå¸§ *t-1* è®¡ç®—çš„ç³»æ•°ï¼Œå¹¶å°è¯•ä»è¿™äº›ç³»æ•°ä¸­æ‰¾åˆ°æˆ‘ä»¬çš„è½¦é“åƒç´ ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬æ²¡æœ‰æ‰¾åˆ°è¶³å¤Ÿçš„è½¦é“çº¿åƒç´ (å°‘äºæ€»éé›¶åƒç´ çš„ 85%)æ—¶ï¼Œæˆ‘ä»¬æ¢å¤åˆ°æ»‘åŠ¨çª—å£æœç´¢ï¼Œä»¥å¸®åŠ©æé«˜æˆ‘ä»¬åœ¨è½¦é“å‘¨å›´æ‹Ÿåˆæ›´å¥½æ›²çº¿çš„æœºä¼šã€‚

## è½¦é“æ›²ç‡

æˆ‘ä»¬è¿˜é€šè¿‡è®¡ç®—ä¸è½¦é“çº¿ç›¸åˆ‡çš„æœ€å°åœ†çš„åŠå¾„æ¥è®¡ç®—è½¦é“æ›²ç‡ï¼Œåœ¨ç›´çº¿è½¦é“ä¸Šï¼ŒåŠå¾„ä¼šå¾ˆå¤§ã€‚æˆ‘ä»¬å¿…é¡»é€šè¿‡å®šä¹‰é€‚å½“çš„åƒç´ é«˜åº¦ä¸è½¦é“é•¿åº¦ä»¥åŠåƒç´ å®½åº¦ä¸è½¦é“å®½åº¦çš„æ¯”ç‡ï¼Œå°†åƒç´ ç©ºé—´è½¬æ¢ä¸ºç±³(ä¹Ÿç§°ä¸ºçœŸå®ä¸–ç•Œå•ä½):

```
# Height ratio: 32 meters / 720 px
self.ym_per_px = self.real_world_lane_size_meters[0] / self.img_dimensions[0]# Width ratio: 3.7 meters / 800 px
self.xm_per_px = self.real_world_lane_size_meters[1] / self.lane_width_px
```

æˆ‘è¯•å›¾é€šè¿‡å‚è€ƒæ¥è‡ªè¿™ä¸ª[èµ„æº](https://www.psychologicalscience.org/news/motr/lines-on-the-road-are-longer-than-you-think.html)çš„æ•°æ®ï¼Œåœ¨æˆ‘çš„é¸Ÿç°å›¾åƒä¸Šæ‰‹åŠ¨ä¼°è®¡é“è·¯çš„é•¿åº¦:æ¯æ¬¡æ±½è½¦è¡Œé©¶éƒ½è¶…è¿‡ 40 è‹±å°º(çº¦ 12.2 ç±³)ã€‚åœ¨æˆ‘çš„æ ·æœ¬å›¾åƒä¸Šï¼Œé¸Ÿç°å›¾ä¼¼ä¹è¦†ç›–äº†å¤§çº¦ 32 ç±³ã€‚å®½åº¦ä¿æŒåœ¨ 3.7 ç±³ï¼Œç¬¦åˆç¾å›½é«˜é€Ÿå…¬è·¯æ ‡å‡†ã€‚ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„[é“¾æ¥](https://www.intmath.com/applications-differentiation/8-radius-curvature.php)æ‰¾åˆ°æ›´å¤šå…³äºæ›²ç‡åŠå¾„çš„æ•°å­¦åŸºç¡€çš„ä¿¡æ¯ã€‚

æˆ‘ä»¬è¿˜é€šè¿‡åç§»è½¦é“å·¦å³çº¿çš„èµ·å§‹(å³åº•éƒ¨)åæ ‡çš„å¹³å‡å€¼ï¼Œå‡å»ä¸­ç‚¹ä½œä¸ºåç§»é‡ï¼Œå¹¶ä¹˜ä»¥è½¦é“çš„åƒç´ ä¸çœŸå®ä¸–ç•Œå®½åº¦çš„æ¯”ç‡ï¼Œæ¥è®¡ç®—æ±½è½¦ä¸è½¦é“ä¸­å¿ƒçš„è·ç¦»ã€‚

## å–æ¶ˆç»˜åˆ¶è½¦é“åŒºåŸŸ

æœ€åï¼Œæˆ‘ä»¬ç”¨ç»¿è‰²ç»˜åˆ¶è½¦é“çš„å†…ä¾§ï¼Œå¹¶*å–æ¶ˆæ‰­æ›²*å›¾åƒï¼Œä»è€Œä»é¸Ÿç°å›¾ç§»åŠ¨åˆ°åŸå§‹çš„æœªå¤±çœŸå›¾åƒã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ç”¨æˆ‘ä»¬çš„è½¦é“æ£€æµ‹ç®—æ³•çš„å°å›¾åƒè¦†ç›–è¿™ä¸ªå¤§å›¾åƒï¼Œä»¥ä¾¿ä¸€å¸§ä¸€å¸§åœ°æ›´å¥½åœ°æ„Ÿå—æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…*ã€‚æˆ‘ä»¬è¿˜æ·»åŠ äº†å…³äºè½¦é“æ›²ç‡å’Œè½¦è¾†ä¸­å¿ƒä½ç½®çš„æ–‡æœ¬ä¿¡æ¯:*

*![](img/5187d33c7eabb2aaff181d91ae9ef870.png)*

*Sample result of the output of detected lanes*

## *å†³èµ›æˆç»©*

*ä¸‹é¢çš„ gif æ˜¾ç¤ºäº†æˆ‘ä»¬ä¸ºé¡¹ç›®è§†é¢‘æ„å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„è½¦é“æ£€æµ‹ç®¡é“:*

*![](img/a8412f973336fb8822512dab8f1056ba.png)*

*Lane detection gif*

*æ­¤å¤–ï¼Œæˆ‘åœ¨ Youtube ä¸Šä¸Šä¼ äº†ä¸€ä¸ªè§†é¢‘ï¼Œæˆ‘åœ¨é¡¹ç›®è§†é¢‘ä¸Šç”»äº†è½¦é“ï¼Œå¹¶æ·»åŠ äº†é¢å¤–çš„ä¿¡æ¯ï¼Œå¦‚è½¦é“æ›²ç‡è¿‘ä¼¼å€¼ã€‚èƒŒæ™¯éŸ³ä¹æ˜¯*å¼—æ—çš„å„¿å­*(æ˜¾ç„¶æ¥è‡ªTron:LegacyğŸ˜).å°½æƒ…äº«å—å§ï¼*

*Video of lanes detected on project video*

# *ç»“è®º*

*è¿™æ˜¯ä¸€ä¸ªä»¤äººå…´å¥‹ä½†å›°éš¾çš„é¡¹ç›®ï¼Œæ„Ÿè§‰ä¸æˆ‘ä»¬ä¹‹å‰çš„ä¸¤ä¸ªæ·±åº¦å­¦ä¹ é¡¹ç›®éå¸¸ä¸åŒã€‚æˆ‘ä»¬å·²ç»ä»‹ç»äº†å¦‚ä½•æ‰§è¡Œç›¸æœºæ ¡å‡†ã€é¢œè‰²å’Œæ¢¯åº¦é˜ˆå€¼ï¼Œä»¥åŠé€è§†å˜æ¢å’Œæ»‘åŠ¨çª—å£æ¥è¯†åˆ«è½¦é“çº¿ï¼æ»‘åŠ¨çª—å£ä»£ç æœ€åˆç‰¹åˆ«éš¾ç†è§£ï¼Œä½†æ˜¯ç»è¿‡é•¿æ—¶é—´çš„è°ƒè¯•å’Œè¯„è®º(éƒ½åœ¨æˆ‘çš„ç¬”è®°æœ¬ä¸Š)ï¼Œæˆ‘ç»ˆäºç†è§£äº†æ¯ä¸€è¡Œï¼*

*æˆ‘ä»¬è®¤ä¸ºè¯¥é¡¹ç›®å¯ä»¥è¿›è¡Œè®¸å¤šæ”¹è¿›ï¼Œä¾‹å¦‚:*

*   *å°è¯• LAB å’Œ YUV è‰²å½©ç©ºé—´ï¼Œä»¥ç¡®å®šæˆ‘ä»¬æ˜¯å¦å¯ä»¥äº§ç”Ÿæ›´å¥½çš„è‰²å½©é˜ˆå€¼*
*   *ä½¿ç”¨å·ç§¯è€Œä¸æ˜¯æ»‘åŠ¨çª—å£æ¥è¯†åˆ«çƒ­ç‚¹åƒç´ *
*   *äº§ç”Ÿå…ˆå‰å¸§çš„è¡Œç³»æ•°çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼ï¼Œå¹¶åœ¨æˆ‘ä»¬çš„åƒç´ æ£€æµ‹å¤±è´¥æ—¶ä½¿ç”¨å®ƒ*
*   *æ›´å¥½åœ°æ£€æµ‹â€œæ•è·â€çš„åƒç´ ä¸­çš„å¼‚å¸¸(ä¾‹å¦‚ï¼Œä¸€äº›å®Œå…¨ç¦»çº¿çš„éé›¶åƒç´ )å¹¶å‰”é™¤å®ƒä»¬*
*   *åº”ç”¨æœ¬é¡¹ç›®æœªæ¶µç›–çš„å…¶ä»–ç›¸å…³è®¡ç®—æœºè§†è§‰æŠ€æœ¯*

*æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªæ›´å¼ºå¤§çš„æ¸ é“æ¥æˆåŠŸå®Œæˆè¿™ä¸ªé¡¹ç›®ä¸­çš„ä¸¤ä¸ªæŒ‘æˆ˜è§†é¢‘ã€‚*

*åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘è¦æ„Ÿè°¢æˆ‘çš„å¯¼å¸ˆè¿ªä¼¦çš„å»ºè®®å’Œæ”¯æŒï¼Œä»¥åŠæˆ‘åœ¨ Udacity çš„åŒäº‹ï¼Œä»¥å‰å’Œç°åœ¨çš„åŒäº‹ï¼Œä»–ä»¬æ•´ç†äº†å¾ˆå¤šä¼˜ç§€çš„æ–‡ç« ï¼Œæ¿€åŠ±äº†æˆ‘ã€‚*

*æ„Ÿè°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚å¸Œæœ›ä½ è§‰å¾—æœ‰ç”¨ã€‚æˆ‘ç°åœ¨æ­£åœ¨åˆ›å»ºä¸€ä¸ªåä¸º[*env sion*](https://envsion.io)*çš„æ–°å…¬å¸ï¼åœ¨ EnVsionï¼Œæˆ‘ä»¬æ­£åœ¨ä¸º UX çš„ç ”ç©¶äººå‘˜å’Œäº§å“å›¢é˜Ÿåˆ›å»ºä¸€ä¸ªä¸­å¤®å­˜å‚¨åº“ï¼Œä»¥ä»ä»–ä»¬çš„ç”¨æˆ·é‡‡è®¿è§†é¢‘ä¸­æŒ–æ˜è§è§£ã€‚å½“ç„¶æˆ‘ä»¬ç”¨äººå·¥æ™ºèƒ½æ¥åšè¿™ä¸ªã€‚).**

**å¦‚æœä½ æ˜¯ä¸€å UX çš„ç ”ç©¶äººå‘˜æˆ–äº§å“ç»ç†ï¼Œå¯¹ä¸ç”¨æˆ·å’Œå®¢æˆ·çš„è§†é¢‘é€šè¯æ„Ÿåˆ°ä¸çŸ¥æ‰€æªï¼Œé‚£ä¹ˆ EnVsion å°±æ˜¯ä¸ºä½ å‡†å¤‡çš„ï¼**

**ä½ ä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„* [*æ¨ç‰¹*](https://twitter.com/Ed_Forson) *ã€‚**