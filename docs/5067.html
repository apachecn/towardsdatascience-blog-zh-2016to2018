<html>
<head>
<title>How to create a sequential model in Keras for R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•åœ¨ Keras ä¸­ä¸º R åˆ›å»ºåºåˆ—æ¨¡å‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/how-to-create-a-sequential-model-in-keras-for-r-1437aaf778e2?source=collection_archive---------14-----------------------#2018-09-25">https://towardsdatascience.com/how-to-create-a-sequential-model-in-keras-for-r-1437aaf778e2?source=collection_archive---------14-----------------------#2018-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="fc74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">TLï¼›dr:æœ¬æ•™ç¨‹å°†ä»‹ç» Keras çš„æ·±åº¦å­¦ä¹ åˆ†ç±»ä»»åŠ¡ã€‚æˆ‘ä»¬å°†ç‰¹åˆ«å…³æ³¨æ•°ç»„çš„å½¢çŠ¶ï¼Œè¿™æ˜¯æœ€å¸¸è§çš„é™·é˜±ä¹‹ä¸€ã€‚</p><p id="fffb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å°†è®¨è®ºçš„ä¸»é¢˜æœ‰:</p><ul class=""><li id="4e9d" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">å¦‚ä½•è¿›è¡Œä¸€é”®ç¼–ç </li><li id="79cc" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">é€‰æ‹©å±‚ä¸­çš„è¾“å…¥å’Œè¾“å‡ºå½¢çŠ¶/å°ºå¯¸</li><li id="ccf5" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">å¦‚ä½•è®­ç»ƒæ¨¡å‹</li><li id="0bc2" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">å¦‚ä½•è¯„ä¼°æ¨¡å‹(åŸ¹è®­ä¸æµ‹è¯•)</li></ul><p id="e2b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ å¯ä»¥åœ¨ Github ä¸Šæ‰¾åˆ°<a class="ae kz" href="https://github.com/pablo14/Keras-R-tutorials/blob/master/keras_sequential_model.R" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªæ•™ç¨‹çš„å®Œæ•´ä»£ç ğŸ‘‡</a></p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/6014b80babba9514c4f1dc21ed691477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JND_ryB2DGSKhUTk.gif"/></div></div></figure><h1 id="a56f" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">åˆ›å»ºæ•°æ®</h1><p id="5610" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">è¾“å…¥æ•°æ®å°†æ˜¯æ¥è‡ªå‡åŒ€åˆ†å¸ƒçš„ 10000 è¡Œå’Œ 3 åˆ—ã€‚</p><h1 id="297e" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">åˆ›å»ºæ•°æ®</h1><p id="763b" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">è¾“å…¥æ•°æ®å°†æ˜¯æ¥è‡ªå‡åŒ€åˆ†å¸ƒçš„ 10000 è¡Œå’Œ 3 åˆ—ã€‚</p><p id="46d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯¥æ¨¡å‹å°†è¯†åˆ«å‡ºè¿™ä¸‰ä¸ªæ•°å­—çš„æ€»å’Œé«˜äºé˜ˆå€¼<code class="fe mp mq mr ms b">1.5</code>ï¼Œå¦åˆ™å°†ä¸º 0ã€‚</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="91c6" class="mx ln iq ms b gy my mz l na nb"># Input: 10000 rows and 3 columns of uniform distribution<br/>x_data=matrix(data=runif(30000), nrow=10000, ncol=3)</span><span id="e275" class="mx ln iq ms b gy nc mz l na nb"># Output<br/>y_data=ifelse(rowSums(x_data) &gt; 1.5, 1, 0)</span><span id="08ca" class="mx ln iq ms b gy nc mz l na nb">head(x_data)</span><span id="fa41" class="mx ln iq ms b gy nc mz l na nb">##            [,1]      [,2]      [,3]<br/>## [1,] 0.49224109 0.6096538 0.7855929<br/>## [2,] 0.56710301 0.8707570 0.3428543<br/>## [3,] 0.08246592 0.7504529 0.6979251<br/>## [4,] 0.79197829 0.6330420 0.7307403<br/>## [5,] 0.65170373 0.9052915 0.1395298<br/>## [6,] 0.23479406 0.2611791 0.2780037</span><span id="ceab" class="mx ln iq ms b gy nc mz l na nb">head(y_data)</span><span id="8d2e" class="mx ln iq ms b gy nc mz l na nb">## [1] 1 1 1 1 1 0</span></pre><h1 id="35f8" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">å®‰è£…/åŠ è½½ Keras</h1><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="6624" class="mx ln iq ms b gy my mz l na nb"># install.packages("keras")<br/>library(keras)<br/>library(tidyverse)</span></pre><h1 id="6cc1" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">Keras ä¸­çš„ä¸€é”®ç¼–ç </h1><p id="3889" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">æ·±åº¦å­¦ä¹ çš„ä¸€ä¸ªå…³é”®ç‚¹æ˜¯ç†è§£æ¨¡å‹éœ€è¦çš„å‘é‡ã€çŸ©é˜µå’Œ/æˆ–æ•°ç»„çš„ç»´æ•°ã€‚æˆ‘å‘ç°è¿™äº›éƒ½æ˜¯ Keras æ”¯æŒçš„ç±»å‹ã€‚</p><p id="10e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”¨ Python çš„è¯è¯´ï¼Œå°±æ˜¯æ•°ç»„çš„å½¢çŠ¶ã€‚</p><p id="6217" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†å®ŒæˆäºŒè¿›åˆ¶åˆ†ç±»ä»»åŠ¡ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå•çƒ­ç‚¹å‘é‡ã€‚å¯¹äº 2 ä¸ªä»¥ä¸Šçš„ç±»ï¼Œå®ƒä»¥ç›¸åŒçš„æ–¹å¼å·¥ä½œã€‚</p><p id="f4a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¾‹å¦‚:</p><ul class=""><li id="d795" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">å€¼<code class="fe mp mq mr ms b">1</code>å°†æ˜¯çŸ¢é‡<code class="fe mp mq mr ms b">[0,1]</code></li><li id="e070" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">å€¼<code class="fe mp mq mr ms b">0</code>å°†æ˜¯çŸ¢é‡<code class="fe mp mq mr ms b">[1,0]</code></li></ul><p id="2c73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Keras æä¾›äº†<code class="fe mp mq mr ms b">to_categorical</code>å‡½æ•°æ¥å®ç°è¿™ä¸ªç›®æ ‡ã€‚</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="ee53" class="mx ln iq ms b gy my mz l na nb">y_data_oneh=to_categorical(y_data, num_classes = 2)</span><span id="447d" class="mx ln iq ms b gy nc mz l na nb">head(y_data_oneh)</span><span id="a556" class="mx ln iq ms b gy nc mz l na nb">##      [,1] [,2]<br/>## [1,]    0    1<br/>## [2,]    0    1<br/>## [3,]    0    1<br/>## [4,]    0    1<br/>## [5,]    0    1<br/>## [6,]    1    0</span></pre><p id="6c25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¾ˆå®¹æ˜“å¾—åˆ°åˆ†ç±»å˜é‡ï¼Œå¦‚:â€œæ˜¯/å¦â€ã€â€œCatAã€CatBã€CatCâ€ç­‰ã€‚ä½†æ˜¯<code class="fe mp mq mr ms b">to_categorical</code>ä¸æ¥å—éæ•°å€¼ä½œä¸ºè¾“å…¥ã€‚æˆ‘ä»¬éœ€è¦é¦–å…ˆè½¬æ¢å®ƒä»¬ã€‚</p><p id="3ef0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mp mq mr ms b">num_classes</code>æ˜¯åˆ›å»ºçŸ¢é‡é•¿åº¦æ‰€å¿…éœ€çš„ã€‚</p><p id="99da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mp mq mr ms b">to_categorical</code>çš„æ›¿ä»£å“:</p><ul class=""><li id="489c" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">åŒ…<code class="fe mp mq mr ms b">CatEncoders</code>ï¼Œ<a class="ae kz" href="https://cran.r-project.org/web/packages/CatEncoders/CatEncoders.pdf" rel="noopener ugc nofollow" target="_blank"> OneHotEncoder </a>(åŒ Python <code class="fe mp mq mr ms b">scikit-learn</code>)ã€‚</li><li id="6bbc" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">å°è£…<code class="fe mp mq mr ms b">caret</code>ï¼ŒåŠŸèƒ½<a class="ae kz" href="https://amunategui.github.io/dummyVar-Walkthrough/" rel="noopener ugc nofollow" target="_blank"> dummyVars </a>ã€‚</li></ul><p id="2937" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ³¨æ„:æˆ‘ä»¬ä¸éœ€è¦è½¬æ¢<strong class="jp ir">è¾“å…¥å˜é‡</strong>ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æ•°å€¼ã€‚</p><h1 id="ef71" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">åœ¨ Keras ä¸­åˆ›å»ºé¡ºåºæ¨¡å‹</h1><p id="500b" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">Keras ä¸­æœ€ç®€å•çš„æ¨¡å‹æ˜¯<strong class="jp ir">åºåˆ—</strong>ï¼Œå®ƒæ˜¯é€šè¿‡é¡ºåºå †å å±‚è€Œæ„å»ºçš„ã€‚</p><p id="a320" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨ä¸‹ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å †å äº†ä¸‰ä¸ªå¯†é›†å›¾å±‚ï¼Œkeras ä½¿ç”¨ input_shape å‚æ•°ç”¨æ‚¨çš„æ•°æ®æ„å»ºäº†ä¸€ä¸ªéšå¼è¾“å…¥å›¾å±‚ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ€»å…±æœ‰ä¸€ä¸ªè¾“å…¥å±‚å’Œä¸€ä¸ªè¾“å‡ºå±‚ã€‚</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="75e1" class="mx ln iq ms b gy my mz l na nb">model = keras_model_sequential() %&gt;%   <br/>  layer_dense(units = 64, activation = "relu", input_shape = ncol(x_data)) %&gt;%<br/>  layer_dense(units = 64, activation = "relu") %&gt;%<br/>  layer_dense(units = ncol(y_data_oneh), activation = "softmax")</span></pre><p id="47ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç›®å‰æœ€é‡è¦çš„å‚æ•°æ˜¯:</p><ul class=""><li id="6c16" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">åœ¨ç¬¬ä¸€å±‚ä¸­ï¼Œ<code class="fe mp mq mr ms b">input_shape</code>ä»£è¡¨ä¸€ä¸ªå€¼ä¸º 3 ( <code class="fe mp mq mr ms b">ncol(x_data)</code>)çš„å‘é‡ï¼Œè¡¨ç¤ºè¾“å…¥å˜é‡çš„æ•°é‡ã€‚åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œå‡ ä¹æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯å‘é‡(æˆ–å¼ é‡)ã€‚</li><li id="2528" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">ç¬¬äºŒå±‚æ²¡æœ‰<code class="fe mp mq mr ms b">input_shape</code>ï¼Œå› ä¸º Keras æ˜¯ä»å‰ä¸€å±‚æ¨æ–­å‡ºæ¥çš„ã€‚</li><li id="8949" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">ç¬¬ä¸‰ä¸ª<code class="fe mp mq mr ms b">layer_dense</code>ï¼Œä»£è¡¨æœ€ç»ˆè¾“å‡ºï¼Œæœ‰ 2 ä¸ª(<code class="fe mp mq mr ms b">ncol(y_data_oneh)</code>)å•ä½ä»£è¡¨ä¸¤ç§å¯èƒ½çš„ç»“æœã€‚</li></ul><p id="fe7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨å¯ä»¥æ£€æŸ¥æ¯ä¸ªå›¾å±‚çš„æ¨¡å‹å’Œå½¢çŠ¶:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="ea07" class="mx ln iq ms b gy my mz l na nb">model</span><span id="2ee3" class="mx ln iq ms b gy nc mz l na nb">## Model<br/>## ___________________________________________________________________________<br/>## Layer (type)                     Output Shape                  Param #     <br/>## ===========================================================================<br/>## dense_28 (Dense)                 (None, 64)                    256         <br/>## ___________________________________________________________________________<br/>## dense_29 (Dense)                 (None, 64)                    4160        <br/>## ___________________________________________________________________________<br/>## dense_30 (Dense)                 (None, 2)                     130         <br/>## ===========================================================================<br/>## Total params: 4,546<br/>## Trainable params: 4,546<br/>## Non-trainable params: 0<br/>## ___________________________________________________________________________</span></pre><p id="6b38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æ˜¯æ—¶å€™å®šä¹‰æŸå¤±å’Œä¼˜åŒ–å™¨å‡½æ•°ï¼Œä»¥åŠè¦ä¼˜åŒ–çš„æŒ‡æ ‡äº†ã€‚</p><p id="7510" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è™½ç„¶å®ƒè¯´çš„æ˜¯â€œå‡†ç¡®æ€§â€ï¼Œä½† keras è¯†åˆ«è¾“å‡ºçš„æ€§è´¨(åˆ†ç±»)ï¼Œå¹¶åœ¨åç«¯ä½¿ç”¨<code class="fe mp mq mr ms b">categorical_accuracy</code>ã€‚</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="8d01" class="mx ln iq ms b gy my mz l na nb">compile(model, loss = "categorical_crossentropy", optimizer = optimizer_rmsprop(), metrics = "accuracy")</span></pre><p id="113a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬æ¥æ‹Ÿåˆ(è®­ç»ƒ)æ¨¡å‹:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="a148" class="mx ln iq ms b gy my mz l na nb">history = fit(model,  x_data, y_data_oneh, epochs = 20, batch_size = 128, validation_split = 0.2)</span></pre><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/e3fd0a09392b8efabbf144219aca55c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/1*WTwrb2LTuPlURDoCP3oHug.gif"/></div></figure><p id="3c6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æå®šäº†ã€‚</p><p id="b41e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç»˜å›¾ç»“æœ:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="ad61" class="mx ln iq ms b gy my mz l na nb">plot(history)</span></pre><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/58257ed6a602b2d25ede8c333af309e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*fw2CCSvOCEZCavrdrxvStA.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk">Keras results in ggplot2</figcaption></figure><h1 id="5545" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">ç”¨çœ‹ä¸è§çš„æ•°æ®éªŒè¯</h1><p id="0b31" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">åˆ›å»ºâ€œçœ‹ä¸è§çš„â€è¾“å…¥æµ‹è¯•æ•°æ®(1000 è¡Œï¼Œ3 åˆ—):</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="cb04" class="mx ln iq ms b gy my mz l na nb">x_data_test=matrix(data=runif(3000), nrow=1000, ncol=3)<br/>dim(x_data_test)</span><span id="a193" class="mx ln iq ms b gy nc mz l na nb">## [1] 1000    3</span></pre><p id="37bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é¢„æµ‹æ–°ç—…ä¾‹:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="2eeb" class="mx ln iq ms b gy my mz l na nb">y_data_pred=predict_classes(model, x_data_test)</span><span id="02c1" class="mx ln iq ms b gy nc mz l na nb">glimpse(y_data_pred)</span><span id="3f7a" class="mx ln iq ms b gy nc mz l na nb">##  num [1:1000(1d)] 0 0 1 1 1 1 0 1 0 1 ...</span></pre><p id="4e3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„ï¼Œç»´åº¦æ˜¯ 1000 è¡Œå’Œ 2 åˆ—ã€‚<code class="fe mp mq mr ms b">predict_classes</code>è‡ªåŠ¨æ‰§è¡Œä¸€é”®è§£ç ã€‚</p><p id="cf5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç›¸åï¼Œ<code class="fe mp mq mr ms b">predict</code>è¿”å›è®­ç»ƒæ—¶æ”¶åˆ°çš„ç›¸åŒç»´åº¦(n è¡Œï¼Œn ç±»é¢„æµ‹)ã€‚</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="08e8" class="mx ln iq ms b gy my mz l na nb">y_data_pred_oneh=predict(model, x_data_test)</span><span id="8ae4" class="mx ln iq ms b gy nc mz l na nb">dim(y_data_pred_oneh)</span><span id="1cd7" class="mx ln iq ms b gy nc mz l na nb">## [1] 1000    2</span><span id="05ff" class="mx ln iq ms b gy nc mz l na nb">head(y_data_pred_oneh)</span><span id="ba9d" class="mx ln iq ms b gy nc mz l na nb">##                     [,1]              [,2]<br/>## [1,] 0.99207872152328491 0.007921278476715<br/>## [2,] 1.00000000000000000 0.000000001157425<br/>## [3,] 0.00000002739444227 1.000000000000000<br/>## [4,] 0.41273152828216553 0.587268412113190<br/>## [5,] 0.03470309823751450 0.965296924114227<br/>## [6,] 0.00000000007147296 1.000000000000000</span></pre><p id="a9fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨åˆ†ç±»ä¸­ï¼Œæ€»æ˜¯å»ºè®®è¿”å›æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œå°±åƒæˆ‘ä»¬å¯¹<code class="fe mp mq mr ms b">predict</code>æ‰€åšçš„é‚£æ ·(è¡Œå’Œä¸º 1)ã€‚æ›´å¤šä¿¡æ¯è¯·è®¿é—®:<a class="ae kz" href="https://livebook.datascienceheroes.com/model-performance.html#scoring_data" rel="noopener ugc nofollow" target="_blank"> DSLB -å¾—åˆ†æ•°æ®</a>ã€‚</p><h1 id="2718" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">softmax æ¿€æ´»</h1><p id="f5f8" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">å¤šäºäº†æœ€åä¸€å±‚çš„<code class="fe mp mq mr ms b">activation = "softmax"</code>,æˆ‘ä»¬å¾—åˆ°äº†æ¦‚ç‡ã€‚</p><p id="ab39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äºæ¯ä¸ªç±»ï¼Œsoftmax çš„è¾“å‡ºèŒƒå›´ä» 0 åˆ° 1ï¼Œæ‰€æœ‰ç±»çš„æ€»å’Œè‡ªç„¶æ˜¯ 1ã€‚</p><h1 id="1aca" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">è¯„ä¼°æ¨¡å‹(åŸ¹è®­ä¸æµ‹è¯•)</h1><p id="4d57" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">åˆ›å»ºâ€œçœŸå®â€y ç›®æ ‡ï¼Œä¸é¢„æµ‹ç›®æ ‡è¿›è¡Œæ¯”è¾ƒ:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="d312" class="mx ln iq ms b gy my mz l na nb">y_data_real=ifelse(rowSums(x_data_test) &gt; 1.5, 1, 0)<br/>y_data_real_oneh=to_categorical(y_data_real)</span><span id="5e56" class="mx ln iq ms b gy nc mz l na nb">## Training data<br/>evaluate(model, x_data, y_data_oneh, verbose = 0)</span><span id="4dd1" class="mx ln iq ms b gy nc mz l na nb">## $loss<br/>## [1] 0.03008356<br/>## <br/>## $acc<br/>## [1] 0.9918</span><span id="d570" class="mx ln iq ms b gy nc mz l na nb">## Test data (we need the one-hot version)<br/>evaluate(model, x_data_test, y_data_real_oneh, verbose = 0)</span><span id="b72b" class="mx ln iq ms b gy nc mz l na nb">## $loss<br/>## [1] 0.03146484<br/>## <br/>## $acc<br/>## [1] 0.991</span></pre><p id="84e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">çœ‹ä¸è§çš„æ•°æ®çš„ç²¾åº¦å‡ ä¹æ˜¯å®Œç¾çš„:å¤§çº¦åœ¨<code class="fe mp mq mr ms b">1</code>(ä»¥åŠæ¥è¿‘ 0 çš„æŸå¤±ï¼Œè¿™æ¯”ç²¾åº¦æ›´é‡è¦)ã€‚</p><p id="193a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç¥ç»ç½‘ç»œå­¦ä¹ äº†æˆ‘ä»¬ä¸€å¼€å§‹å®šä¹‰çš„æ¨¡å¼ğŸ‰ï¼</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/713ed617989690b5b66fa33f497ba638.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/1*DN6ac4WjjCBY8mLcrkeaiQ.gif"/></div></figure><h1 id="3223" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">ä¸€äº›é—®é¢˜ğŸ¤”</h1><p id="1cc4" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated"><em class="nk">éœ€è¦å¤šå°‘å±‚ï¼Ÿ</em>æˆ‘ä»¬å°è¯•äº† 3ï¼Œä½†æ˜¯ 4 æ€ä¹ˆæ ·ï¼Ÿå®ƒå°†å­¦ä¹ åŒæ ·çš„ä¸œè¥¿ï¼Œä½†æ˜¯éœ€è¦æ›´å¤šçš„æ—¶é—´ã€‚ä½†æ˜¯åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæ€§èƒ½ä¼šæé«˜ã€‚è¿™å–å†³äºæ¯ä¸ªæ¡ˆä¾‹ã€‚</p><p id="aba2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nk">æ¯å±‚éœ€è¦å¤šå°‘ä¸ªç¥ç»å…ƒï¼Ÿ</em>å’Œä»¥å‰ä¸€æ ·çš„æ¨ç†ã€‚æˆ‘ä»¬åº”è¯¥æœŸæœ›ç”¨æœ€ç®€å•çš„ç½‘ç»œè·å¾—æœ€å¤§çš„ç²¾åº¦ã€‚å€¾å‘äºè¿›è¡Œè‰¯å¥½çš„æ ‡å‡†æ‹Ÿåˆçš„ä¸€ç§æ–¹æ³•æ˜¯ä»å…·æœ‰(å³)128 ä¸ªç¥ç»å…ƒçš„å±‚å¼€å§‹ã€‚ç„¶ååŠ ä¸€å±‚ 64ï¼Œå¦ä¸€å±‚ 16ã€‚æ¨¡å¼æ˜¯å‡å°‘æ¯å±‚ç¥ç»å…ƒçš„æ•°é‡ã€‚</p><h1 id="babc" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">ä½ è‡ªå·±è¯•è¯•ğŸ™Œ</h1><p id="362b" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">é˜…è¯»åªæ˜¯å­¦ä¹ çš„ä¸€ä¸ªå¾ˆå°çš„éƒ¨åˆ†ï¼Œä½ å¯ä»¥è‡ªå·±å°è¯•ï¼Œæ¯”å¦‚æ”¹å˜æˆ‘ä»¬ä½¿ç”¨çš„å‡½æ•°(æˆ‘ä»¬å°è¯•äº†<code class="fe mp mq mr ms b">y &gt; 1.5 = 1</code>)å¹¶è®©ç½‘ç»œæ¥å­¦ä¹ å®ƒã€‚</p><p id="d8bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é€šè¿‡ç¼–ç å­¦ä¹ ï¼Œå¹¶æš´éœ²ä½ çš„å®è·µä¸­çš„é”™è¯¯ğŸ™‚</p><h1 id="bd6b" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">è¿›ä¸€æ­¥é˜…è¯»</h1><ul class=""><li id="5636" class="kl km iq jp b jq mk ju ml jy nl kc nm kg nn kk kq kr ks kt bi translated"><a class="ae kz" href="https://keras.rstudio.com/articles/sequential_model.html" rel="noopener ugc nofollow" target="_blank">ç³»åˆ—è½¦å‹æŒ‡å—</a>(æ¥è‡ª Rstudio)</li><li id="c097" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><a class="ae kz" href="https://blog.rstudio.com/2018/09/12/getting-started-with-deep-learning-in-r" rel="noopener ugc nofollow" target="_blank">R ä¸­æ·±åº¦å­¦ä¹ å…¥é—¨</a>(æ¥è‡ª Rstudio)</li><li id="1871" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><a class="ae kz" href="https://blog.datascienceheroes.com/sample-size-and-class-balance-on-model-performance" rel="noopener ugc nofollow" target="_blank">æ ·æœ¬å¤§å°å’Œç±»åˆ«å¯¹æ¨¡å‹æ€§èƒ½çš„å¹³è¡¡</a>(åº•å±‚æ¨¡å‹æ˜¯ç”¨ Keras æ„å»ºçš„)</li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="d4a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nk">æœ¬å¸–æœ€åˆå‘å¸ƒäº:</em><a class="ae kz" href="https://blog.datascienceheroes.com/how-to-create-a-sequential-model-in-keras-for-r/" rel="noopener ugc nofollow" target="_blank"><em class="nk">https://blog . datascienceheroes . com/how-to-create-a-sequential-model-in-keras-for-r/</em></a></p><p id="7fa4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼ŸæŠŠå®ƒä»¬ç•™åœ¨ä¸‹é¢ğŸ“©</p><p id="7770" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">æ„Ÿè°¢</strong>é˜…è¯»ï¼ğŸš€</p><p id="4854" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ğŸ“—<a class="ae kz" href="http://livebook.datascienceheroes.com/" rel="noopener ugc nofollow" target="_blank">æ•°æ®ç§‘å­¦ Live Book </a> â€”å­¦ä¹ æœºå™¨å­¦ä¹ çš„åœ¨çº¿ä¹¦ç±</p><p id="2821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kz" href="https://blog.datascienceheroes.com/how-to-create-a-sequential-model-in-keras-for-r/blog.datascienceheroes.com" rel="noopener ugc nofollow" target="_blank">æ›´å¤šæ•°æ®æ•…äº‹:åšå®¢</a>|<a class="ae kz" href="https://www.linkedin.com/in/pcasas/" rel="noopener ugc nofollow" target="_blank">Linkedin</a>|<a class="ae kz" href="https://twitter.com/pabloc_ds" rel="noopener ugc nofollow" target="_blank">Twitter</a></p></div></div>    
</body>
</html>