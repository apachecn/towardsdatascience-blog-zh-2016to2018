<html>
<head>
<title>Advanced Visualization with react-vis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ react-vis å®ç°é«˜çº§å¯è§†åŒ–</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/advanced-visualization-with-react-vis-efc5c6667b4?source=collection_archive---------4-----------------------#2018-05-21">https://towardsdatascience.com/advanced-visualization-with-react-vis-efc5c6667b4?source=collection_archive---------4-----------------------#2018-05-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6053" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">ä½¿ç”¨ Voronoisã€å•ç¨‹æ¸²æŸ“å’Œç”»å¸ƒç»„ä»¶è·å¾—æƒŠäººçš„ç”¨æˆ·ä½“éªŒ</h2></div><p id="9782" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ‰€ä»¥ä½ å·²ç»å¼€å§‹ç”¨<a class="ae lb" href="https://github.com/uber/react-vis" rel="noopener ugc nofollow" target="_blank"> react-vis </a>åšä¸€äº›æ•°æ®å¯è§†åŒ–ï¼Œä½ å·²ç»å»ºç«‹äº†ä¸€äº›ä½ è‡ªå·±çš„å›¾è¡¨ï¼Œä¹Ÿè®¸ä½ å·²ç»è¯»è¿‡<a class="lc ld ep" href="https://medium.com/u/792d0122c5bb?source=post_page-----efc5c6667b4--------------------------------" rel="noopener" target="_blank">shyanovska Nataliia</a>çš„ç²¾å½©ä»‹ç»<a class="ae lb" href="https://medium.com/dailyjs/data-visualization-with-react-vis-bd2587fe1660" rel="noopener">ç”¨ react-vis </a>åšæ•°æ®å¯è§†åŒ–ï¼Œæˆ–è€…ç”šè‡³å¯èƒ½å»ºç«‹äº†ä¸€ä¸ª<a class="ae lb" href="http://www.jeromecukier.net/?p=1700" rel="noopener ugc nofollow" target="_blank">ä»ªè¡¨æ¿</a>ã€‚æ˜¯æ—¶å€™å­¦ä¹ ä¸€äº›å¤„ç†æ›´å¤§æ•°æ®é‡å’Œæ›´å¤æ‚ UI äº¤äº’çš„æŠ€æœ¯äº†ã€‚åœ¨è¿™ç¯‡æ–‡ç« çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨å•ç¨‹æ¸²æŸ“ï¼Œç”»å¸ƒéƒ¨ä»¶ï¼Œå»æŠ–åŠ¨çŠ¶æ€æ›´æ–°ï¼Œå’Œ Voronoisã€‚ç³»å¥½å®‰å…¨å¸¦ï¼Œè¿™å°†æ˜¯ä¸€æ¬¡ç–¯ç‹‚çš„æ—…ç¨‹ï¼</p><p id="a73d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">é¦–å…ˆï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<a class="ae lb" href="https://www.npmjs.com/package/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>è®¾ç½® scaffold a new appï¼Œç„¶ååœ¨ç»ˆç«¯ä¸­è¿è¡Œ</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="f407" class="ln lo iq lj b gy lp lq l lr ls">npm install react-vis --save<br/># we will also be using a few additional libraries <br/># so install these too<br/>npm install --save d3-fetch d3-scale d3-scale-chromatic debounce simplify-js</span></pre><p id="ec85" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä¸ºæˆ‘çš„åº”ç”¨ç¨‹åºä½¿ç”¨äº†ç¨å¾®ä¸åŒçš„é…ç½®ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œ<a class="ae lb" href="https://github.com/mcnuttandrew/advanced-react-vis-tutorial" rel="noopener ugc nofollow" target="_blank">æŸ¥çœ‹(ä»¥åŠæ•´ç¯‡æ–‡ç« çš„ä»£ç )ã€‚</a></p><h2 id="ba02" class="ln lo iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">è·å–å’Œå‡†å¤‡æ•°æ®</h2><p id="7442" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">å­¦ä¹ å¦‚ä½•åšä»»ä½•äº‹æƒ…çš„ä¸€ä¸ªä¼ ç»ŸæŠ€å·§æ˜¯æ¨¡ä»¿å¤§å¸ˆï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿä¸ä¾‹å¤–ã€‚æˆ‘ä»¬å°†æ¢ç´¢çº½çº¦æ—¶æŠ¥ 2016 å¹´çš„å¯è§†åŒ–â€œæ–¯è’‚èŠ¬åº“é‡Œçš„ 3 åˆ†è®°å½•â€ã€‚</p><div class="mp mq gp gr mr ms"><a href="https://www.nytimes.com/interactive/2016/04/16/upshot/stephen-curry-golden-state-warriors-3-pointers.html" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">æ–¯è’‚èŠ¬Â·åº“é‡Œçš„ 3 åˆ†è®°å½•:è¶…å‡ºå›¾è¡¨</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">è¿™å¼ å›¾è¡¨æœ‰ 752 è¡Œâ€”â€”æ¯ä¸€è¡Œä»£è¡¨ä¸€å NBA çƒå‘˜ï¼Œä»–ä»¬åœ¨æ¯åœºæ¯”èµ›ä¸­çš„ä¸‰åˆ†çƒå‘½ä¸­ç‡éƒ½æ’åœ¨å‰ 20 ä½</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">www.nytimes.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng nh ms"/></div></div></a></div><p id="11fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨è¿™ä¸ªå¯è§†åŒ–ä¸­æœ‰å¾ˆå¤šäº‹æƒ…æ­£åœ¨å‘ç”Ÿï¼æ¯ä¸€è¡Œæ˜¾ç¤ºäº†ä¸€ä¸ªç‰¹å®šçš„çƒå‘˜åœ¨ç‰¹å®šçš„èµ›å­£ä¸­æŠ•ä¸­ä¸‰åˆ†çƒçš„æ¬¡æ•°ã€‚è¿™ä¸ªä¿¡æ¯å¯ä»¥é€šè¿‡ä¸€ä¸ªåŠ¨æ€çš„é¼ æ ‡æŒ‡é’ˆæ¥è®¿é—®ï¼Œé¼ æ ‡æŒ‡é’ˆåŒæ—¶ä¼šçªå‡ºæ˜¾ç¤ºç‰¹å®šçš„ç©å®¶å¹´ä»½ï¼Œå¹¶æä¾›ä¸€ä¸ªå·¥å…·æç¤ºæ¥å‡†ç¡®æè¿°ç”¨æˆ·æ‰€åœç•™çš„è¡Œã€‚</p><p id="d757" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ä»¬çš„ç¬¬ä¸€æ­¥å°†æ˜¯è·å–æ•°æ®ã€‚ä»¤äººæ„‰å¿«çš„æ˜¯ï¼ŒNYT ä¸ºè¿™ç¯‡æ–‡ç« æä¾›äº† CSV æ ¼å¼çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°é€šè¿‡æŸ¥çœ‹ chrome ä¸­çš„ç½‘ç»œé€‰é¡¹å¡æ¥è·å–è¿™äº›æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ä¸‹è½½å®Œæ•°æ®æ–‡ä»¶åï¼Œå°†å®ƒæ”¾åœ¨åº”ç”¨ç¨‹åºä¸­çš„æŸä¸ªåœ°æ–¹ï¼Œæˆ‘å°†å®ƒæ”¾åœ¨ä¸€ä¸ªåä¸º data çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶å°†å…¶å‘½åä¸ºâ€œnyt-rip.csvâ€ã€‚</p><figure class="le lf lg lh gt nj gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi ni"><img src="../Images/f36c3f16a82425a8f774dc98deb0f0f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rjOyrSh7yw0NNecQgLWCOg.gif"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Capturing the CSV data that we will be using for our visualization by watching the network tab on Chrome. Refreshing the page triggers a lot of network calls, we then filter the network history to only CSVâ€™s, and save the relevant file by double clicking it.</figcaption></figure><p id="d7a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™ä¸ª csv çš„æ ¼å¼æœ‰ç‚¹ä¸æ–¹ä¾¿ï¼Œå®ƒæœ‰çƒå‘˜ idã€çƒå‘˜å§“åã€å¹´ä»½ä»¥åŠæœ¬èµ›å­£æ¯åœºæ¯”èµ›çš„ä¸‰æ¬¡æŠ•æ·æ¬¡æ•°ç­‰åˆ—ã€‚è®©æˆ‘ä»¬æŠŠå®ƒæ•´ç†æˆä¸€ç§æ›´å®¹æ˜“ä½¿ç”¨çš„æ ¼å¼:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="3284" class="ln lo iq lj b gy lp lq l lr ls">const nonNumericRows = {<br/>  player: true,<br/>  pname: true,<br/>  year: true<br/>};</span><span id="5738" class="ln lo iq lj b gy nt lq l lr ls">// reformats input csv so that each row <br/>// has details about the corresponding player<br/>// and an array of points describing that players record<br/>export function cleanData(data) {<br/>  return data.map(row =&gt; {<br/>    // extract all of the columns for <br/>    // this row that update that players score<br/>    const gameData = Object.keys(row)<br/>      .filter(key =&gt; !nonNumericRows[key] &amp;&amp; row[key] !== 'NA')<br/>      .map((key, x) =&gt; ({x, y: Number(row[key])}));</span><span id="defd" class="ln lo iq lj b gy nt lq l lr ls">    // return a formatted object to manipulate<br/>    return {<br/>      player: row.player,<br/>      pname: row.pname,<br/>      year: row.year,<br/>      height: gameData[gameData.length - 1],<br/>      gameData<br/>    };<br/>  });<br/>}</span></pre><p id="7ff3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¤ªå¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ç§æœºåˆ¶æ¥ä»¥å¯ç”¨çš„æ–¹å¼æ ¼å¼åŒ–æˆ‘ä»¬çš„æ•°æ®ã€‚åœ¨æˆ‘ä»¬ç¼–å†™å®ç”¨å‡½æ•°çš„åŒæ—¶ï¼Œè®©æˆ‘ä»¬ä¹Ÿç¼–å†™ä¸€ä¸ªæ¥è·å–æ•°æ®åŸŸ:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="ef7a" class="ln lo iq lj b gy lp lq l lr ls">export function getDataDomain(data) {<br/>  const {min, max} = data.reduce((acc, player) =&gt; {<br/>    return player.gameData.reduce((mem, row) =&gt; {<br/>      return {<br/>        min: Math.min(mem.min, row.y),<br/>        max: Math.max(mem.max, row.y)<br/>      };<br/>    }, acc);</span><span id="f5a8" class="ln lo iq lj b gy nt lq l lr ls">}, {min: Infinity, max: -Infinity});<br/>  return [min, max];<br/>}</span></pre><p id="87a0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å°†è¿™ä¸¤ä¸ªå‡½æ•°æ”¾å…¥ utils.js æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ¯”èµ›äº†ã€‚</p><h2 id="2924" class="ln lo iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">ç¬¬ä¸€ç§å¤©çœŸçš„æ–¹æ³•</h2><p id="da34" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">ä¸ºäº†ç»™æˆ‘ä»¬éšåçš„ä¼˜åŒ–åšå¥½å‡†å¤‡ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„æ–¹æ³•ã€‚åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­æœ‰ 750 ä¸ªçƒå‘˜å¹´ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæœ‰ 750 ä¸ªç³»åˆ—ã€‚å½“æˆ‘ä»¬æ‚¬åœåœ¨å®ƒä»¬ä¸Šæ–¹æ—¶ï¼Œè®©æˆ‘ä»¬é‡æ–°ç»˜åˆ¶çº¿æ¡å¹¶çªå‡ºæ˜¾ç¤ºé€‰ä¸­çš„çº¿æ¡ã€‚ç›¸å½“åˆç†ï¼è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•å®ç°çš„å®Œæ•´è¿‡ç¨‹ï¼Œä¹‹åæˆ‘å°†è¯¦ç»†ä»‹ç»å¹¶æè¿°æ¯ä¸ªéƒ¨åˆ†:</p><figure class="le lf lg lh gt nj"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="6556" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å“¦ï¼Œä¸€ä¸‹å­è¿™ä¹ˆå¤šï¼ä½†æ˜¯å¦‚æœæŠŠå®ƒåˆ†æˆå‡ å—å°±å¾ˆå®¹æ˜“å¤„ç†äº†ã€‚å½“æˆ‘ä»¬çš„ç»„ä»¶å‡†å¤‡å¥½æŒ‚è½½æ—¶ï¼Œå®ƒåšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯é€šè¿‡<a class="ae lb" href="https://github.com/d3/d3-fetch#csv" rel="noopener ugc nofollow" target="_blank"> d3-fetch csv </a>å‡½æ•°è°ƒç”¨æ•°æ®ï¼Œç„¶åæˆ‘ä»¬æ¸…ç†æ•°æ®å¹¶å°†å…¶ä¿å­˜åˆ°çŠ¶æ€ï¼Œä»¥ä¾¿åœ¨ä¸ä¹…çš„å°†æ¥æ¥æ”¶ã€‚</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="d394" class="ln lo iq lj b gy lp lq l lr ls">componentWillMount() {<br/>    csv('data/nyt-rip.csv')<br/>      .then(data =&gt; this.setState({<br/>        data: cleanData(data),<br/>        loading: false<br/>      }));<br/>  }</span></pre><p id="519b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¦‚æœæ•°æ®è¿˜æ²¡æœ‰è¢«åŠ è½½ï¼Œæˆ‘ä»¬é€šè¿‡æ‹’ç»å°è¯•æ¸²æŸ“æˆ‘ä»¬çš„ç»„ä»¶æ¥å¼€å§‹æˆ‘ä»¬çš„æ¸²æŸ“åŠŸèƒ½ï¼Œè€Œåªæ˜¯è¿”å›ä¸€ä¸ªåŠ è½½æ¶ˆæ¯(å°½ç®¡ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ç»™ show ä¸€ä¸ªæ—‹è½¬å™¨æˆ–è€…ä½¿ç”¨åƒ<a class="ae lb" href="https://github.com/balthazar/placeloader" rel="noopener ugc nofollow" target="_blank"> placeloader </a>è¿™æ ·çš„èŠ±å“¨ä¸œè¥¿)ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸Šä¸€èŠ‚ä¸­çš„ getDataDomain å‡½æ•°æ„å»ºä¸€ä¸ªç”±<a class="ae lb" href="https://github.com/d3/d3-scale-chromatic" rel="noopener ugc nofollow" target="_blank"> d3-scale-chromatic </a>æ”¯æŒçš„è‰²æ ‡ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦æ„Ÿå…´è¶£çš„æ˜¯é‡å»ºåŸå§‹ NYT å¯è§†åŒ–çš„æ„Ÿè§‰(è€Œä¸æ˜¯ç¡®åˆ‡çš„å¤–è§‚)ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸åŒçš„è‰²æ ‡ï¼Œå¹¶æ”¾å¼ƒäº†ä¸€äº›é¢å¤–çš„å›¾è¡¨è£…é¥°ã€‚</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="ae54" class="ln lo iq lj b gy lp lq l lr ls">const {loading, highlightSeries, data} = this.state;<br/>if (loading) {<br/>  return &lt;div&gt;&lt;h1&gt;LOADING&lt;/h1&gt;&lt;/div&gt;;<br/>}</span><span id="e90b" class="ln lo iq lj b gy nt lq l lr ls">const dataDomain = getDataDomain(data);<br/>const domainScale = scaleLinear().domain(dataDomain).range([1, 0]);<br/>const colorScale = val =&gt; interpolateWarm(domainScale(val));</span></pre><p id="b3d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹å›¾è¡¨çš„å®é™…æ¸²æŸ“ã€‚æˆ‘ä»¬é¦–å…ˆæŸ¥çœ‹æ‰€æœ‰çš„æ•°æ®è¡Œï¼Œä¸ºæ¯ä¸ªæ•°æ®è¡Œåˆ›å»ºä¸€ä¸ª LineSeriesï¼Œå¹¶å®šä¹‰ä¸€ä¸ªåŸºæœ¬çš„äº¤äº’æŠ€æœ¯ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ª LabelSeries æ¥çªå‡ºæ˜¾ç¤ºæ²¿ y è½´å’Œ x è½´çš„æŸäº›ç‚¹ï¼Œå¹¶ä½¿ç”¨ç‰¹æ®Šæ ¼å¼æ¥åŒ¹é… NYT å›¾å½¢ç»™å‡ºçš„æ ‡ç­¾ã€‚</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="a125" class="ln lo iq lj b gy lp lq l lr ls">&lt;XYPlot {...layout}&gt;<br/>  {data.map((player, idx) =&gt; {<br/>    const playerHighlightString = `${player.pname}-${player.year}`;<br/>    return (<br/>      &lt;LineSeries<br/>        key={idx}<br/>        strokeWidth="4"<br/>        curve="curveStepBefore"<br/>        data={player.gameData}<br/>        onSeriesMouseOver={() =&gt; <br/>            this.setState({highlightSeries: playerHighlightString})}<br/>        onSeriesMouseOut={() =&gt; <br/>            this.setState({highlightSeries: null})}<br/>        stroke={<br/>          playerHighlightString === highlightSeries ? 'black' :<br/>           colorScale(player.gameData[player.gameData.length - 1].y)<br/>        }<br/>        /&gt;);<br/>  })}<br/>  &lt;LabelSeries<br/>    data={data.filter(row =&gt; labelMap[`${row.pname}-${row.year}`])}<br/>    style={{fontSize: '10px', fontFamily: 'sans-serif'}}<br/>    getY={d =&gt; d.gameData[d.gameData.length - 1].y}<br/>    getX={d =&gt; 82}<br/>    labelAnchorX="start"<br/>    getLabel={d =&gt; <br/>      `${d.pname} - ${d.gameData[d.gameData.length - 1].y}`}/&gt;<br/>  &lt;XAxis<br/>    style={{ticks: {fontSize: '10px', fontFamily: 'sans-serif'}}}<br/>    tickFormat={d =&gt; <br/>       !d ? '1st game' : (!(d % 10) ? `${d}th` : '')}/&gt;<br/>&lt;/XYPlot&gt;</span></pre><p id="bd53" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ•é”çš„è¯»è€…ä¼šæ³¨æ„åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªå¸¸é‡ï¼Œå®ƒä»¬æ˜¯ä»ä¸€ä¸ªå•ç‹¬çš„ constants.js æ–‡ä»¶ä¸­å¯¼å…¥çš„ï¼Œä¸ºäº†é€»è¾‘ä¸Šçš„æ–¹ä¾¿ï¼Œå°†å®ƒä»¬æå–å‡ºæ¥:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="15ac" class="ln lo iq lj b gy lp lq l lr ls">export const desiredLabels = [<br/>  {pname: 'Brian Taylor', year: 1980},<br/>  {pname: 'Mike Bratz', year: 1981},<br/>  {pname: 'Don Buse', year: 1982},<br/>  {pname: 'Mike Dunleavy', year: 1983},<br/>  {pname: 'Larry Bird', year: 1986},<br/>  {pname: 'Danny Ainge', year: 1988},<br/>  {pname: 'Michael Adams', year: 1989},<br/>  {pname: 'Michael Adams', year: 1990},<br/>  {pname: 'Vernon Maxwell', year: 1991},<br/>  {pname: 'Vernon Maxwell', year: 1992},<br/>  {pname: 'Dan Majerle', year: 1994},<br/>  {pname: 'John Starks', year: 1995},<br/>  {pname: 'Dennis Scott', year: 1996},<br/>  {pname: 'Reggie Miller', year: 1997},<br/>  {pname: 'Dee Brown', year: 1999},<br/>  {pname: 'Gary Payton', year: 2000},<br/>  {pname: 'Antoine Walker', year: 2001},<br/>  {pname: 'Jason Richardson', year: 2008},<br/>  {pname: 'Stephen Curry', year: 2013},<br/>  {pname: 'Stephen Curry', year: 2014},<br/>  {pname: 'Stephen Curry', year: 2015},<br/>  {pname: 'Stephen Curry', year: 2016}<br/>];</span><span id="1738" class="ln lo iq lj b gy nt lq l lr ls">export const layout = {<br/>  height: 1000,<br/>  width: 800,<br/>  margin: {left: 20, right: 200, bottom: 100, top: 20}<br/>};</span><span id="99e0" class="ln lo iq lj b gy nt lq l lr ls">export const NUMBER_OF_GAMES = 82;<br/>export const MAX_NUMBER_OF_THREE_POINTERS = 405;</span></pre><p id="2ec3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™çœ‹èµ·æ¥åƒæ˜¯:</p><figure class="le lf lg lh gt nj gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/266f13250245adba88efabb17515edcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/1*UmWSUD5Ckowwn7qpFkpPJw.gif"/></div></figure><p id="4929" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç›¸å½“é…·ï¼ç„¶è€Œï¼Œå“åº”æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œå½“æˆ‘ä»¬æ¥è¿‘å®ƒä»¬æ—¶ï¼Œçº¿æ¡ä¸ä¼šçªå‡ºæ˜¾ç¤ºï¼Œæµè§ˆå™¨æ˜æ˜¾å‡ºç°æ»åã€‚è¿™ç§ç­–ç•¥ä¹Ÿé˜»æ­¢äº†æˆ‘ä»¬åœ¨è¾¹ä¸Šæ·»åŠ å·¥å…·æç¤º(è™½ç„¶æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œä½†æ˜¯å½“æˆ‘ä»¬æ‚¬åœåœ¨ä¸åŒçš„å…ƒç´ ä¸Šæ—¶ä¼šæœ‰å¾ˆå¤šæŠ–åŠ¨)ã€‚ä¸€å®šæœ‰æ›´å¥½çš„åŠæ³•ï¼</p><h2 id="d71f" class="ln lo iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">æ›´å¥½çš„å»ºç­‘</h2><p id="9abe" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨ SVG çº¿æ¸²æŸ“æˆ‘ä»¬çš„ç³»åˆ—ã€‚è™½ç„¶è¿™ç§æ–¹æ³•å¾ˆå®¹æ˜“æ¨æ–­ UI çš„çŠ¶æ€ï¼Œä½†æ¯æ¬¡éƒ½é‡æ–°ç»˜åˆ¶æ‰€æœ‰çš„çº¿æ¡ç¡®å®æ•ˆç‡å¾ˆä½ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸€è¡Œéƒ½è¢«å»ºæ¨¡ä¸ºä¸€ä¸ªéå¸¸è¯¦ç»†çš„ DOM èŠ‚ç‚¹ï¼Œè¿™å¯¹æµè§ˆå™¨æ¥è¯´éå¸¸é‡è¦ã€‚ä¸ºäº†å‡è½»è¿™ä¸€é‡é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…ç½®çš„ react-vis å¸†å¸ƒç³»åˆ— LineSeriesCanvasã€‚Canvas çš„æ¸²æŸ“é€Ÿåº¦å¾€å¾€æ¯” SVG å¿«å¾—å¤šï¼Œä½†åœ¨ DOM ä¸­æ²¡æœ‰ç›¸åŒçš„è¯¦ç»†è¡¨ç¤ºï¼Œè¿™æ„å‘³ç€ä»»ä½•äº¤äº’éƒ½å¿…é¡»æ‰‹å·¥å®Œæˆã€‚æ˜¾ç„¶ï¼Œå°†è¿™ä¸ªæ–°çš„ç³»åˆ—æ”¾åˆ°æˆ‘ä»¬å¤©çœŸçš„è§£å†³æ–¹æ¡ˆä¸­ä¼šä½¿æ•´ä¸ªé¡µé¢æ›´å¿«ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šå¤±å»æˆ‘ä»¬çš„åŠ¨æ€äº¤äº’æ€§ã€‚</p><p id="e861" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†å›¾è¡¨åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªå¤„ç†äº¤äº’æ€§ï¼Œå¦ä¸€ä¸ªå¤„ç†å…¶ä»–æ‰€æœ‰çš„äº‹æƒ…ã€‚è¿™æ˜¯ç”± React åªä¸ºå·²ç»æ›´æ–°çš„ç»„ä»¶æ‰§è¡Œæ¸²æŸ“åŠŸèƒ½çš„æƒ³æ³•æ‰€æ¿€å‘çš„ã€‚</p><figure class="le lf lg lh gt nj gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/7a7817e4b01605172fa8ed77e50abc3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*qiWMKN2emmn-9HozPZlz9w.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">The organization of our chart component after breaking out the interactive parts into a separate component</figcaption></figure><p id="33d0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">é€šè¿‡è¿™ä¸ªæ¶æ„ï¼Œæˆ‘ä»¬å°†æœ‰ä¸€ä¸ªç»„ä»¶æ¥å‘ˆç°ç”»å¸ƒçº¿æ¡ï¼Œè¿˜æœ‰ä¸€ä¸ªç»„ä»¶æ¥å‘ˆç°é«˜äº®çº¿æ¡å’Œé«˜äº®å·¥å…·æç¤ºã€‚ä»è€Œæœ‰æ•ˆåœ°å°†å¿«é€Ÿæ¸²æŸ“çš„å…ƒç´ ä¸æ˜‚è´µæˆ–è€—æ—¶æ¸²æŸ“çš„å…ƒç´ åˆ†å¼€ã€‚å¸ƒå±€çš„ä¸€äº›ä¼ªä»£ç :</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="c789" class="ln lo iq lj b gy lp lq l lr ls">&lt;div className="relative"&gt;<br/>  &lt;NonInteractiveParts /&gt;<br/>  &lt;InteractiveParts /&gt;<br/>&lt;/div&gt;</span></pre><p id="e7ee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ä»¬å¸Œæœ›è¿™äº›ç»„ä»¶çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ¼‚äº®çš„å›¾è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™äº†äº¤äº’éƒ¨åˆ† css å±æ€§</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="4cb6" class="ln lo iq lj b gy lp lq l lr ls">position: absolute;<br/>top: 0;</span></pre><p id="d92b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™å…è®¸äº¤äº’éƒ¨åˆ†â€œä½äºâ€éäº¤äº’å±æ€§ä¹‹ä¸Šï¼Œä»è€Œå®Œæˆå¤–è§‚ã€‚</p><h2 id="7a84" class="ln lo iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">é™æ€éƒ¨åˆ†</h2><p id="53d7" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">æˆ‘ä»¬ç°åœ¨çœŸçš„æœ‰æ‰€è¿›å±•äº†ã€‚æ³¨æ„åˆ°å›¾è¡¨çš„é™æ€éƒ¨åˆ†ä¸æˆ‘ä»¬åœ¨ç®€å•æ–¹æ³•ä¸­çš„éå¸¸ç›¸ä¼¼ï¼›åªæ˜¯ä¸€ä¸ªè£…ç€ä¸€äº›ç³»åˆ—çš„å®¹å™¨ã€‚ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢æ¼”ç¤ºçš„æ ¹ç»„ä»¶å’Œç”»å¸ƒéƒ¨ä»¶åˆå¹¶æˆä¸€ä¸ªç»„ä»¶ï¼Œå› ä¸ºå®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªéƒ½åªå‘ˆç°ä¸€æ¬¡ã€‚</p><figure class="le lf lg lh gt nj"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="56d0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™ä¸ªæ–°éƒ¨ä»¶ä¸æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªéå¸¸ç›¸ä¼¼ã€‚æˆ‘ä»¬çš„ mounting æ­¥éª¤åšäº†ä¸€äº›é¢å¤–çš„å·¥ä½œæ¥ä¿ƒè¿›äº¤äº’ç»„ä»¶çš„å‘ˆç°â€”â€”ç¨åä¼šè¯¦ç»†ä»‹ç»â€”â€”å¹¶è°ƒç”¨æˆ‘ä»¬å³å°†æˆä¸ºäº¤äº’ç»„ä»¶çš„ã€‚ä½†æ˜¯é™¤æ­¤ä¹‹å¤–ï¼Œæ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ï¼</p><h2 id="620d" class="ln lo iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">äº’åŠ¨éƒ¨åˆ†</h2><p id="92ef" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">é…·çš„ä¸œè¥¿æ¥äº†ã€‚æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ componentWillMount æ­¥éª¤ä¸­é¢å¤–å‡†å¤‡äº†ä¸€äº›æ•°æ®ï¼Œä»¥ä¾¿ä¸ºäº¤äº’å¼ç»„ä»¶åšå¥½å‡†å¤‡ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ›´è¯¦ç»†çš„æƒ…å†µ:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="913b" class="ln lo iq lj b gy lp lq l lr ls">componentWillMount() {<br/>    csv('data/nyt-rip.csv')<br/>      .then(data =&gt; {<br/>        const updatedData = cleanData(data);<br/>        const playerYearMap = updatedData.reduce((acc, row) =&gt; {<br/>          const {pname, year, gameData} = row;<br/>          acc[`${pname}-${year}`] = gameData[gameData.length - 1].y;<br/>          return acc;<br/>        }, {});</span><span id="c5b6" class="ln lo iq lj b gy nt lq l lr ls">        const playerMap = updatedData.reduce((acc, row) =&gt; {<br/>          acc[`${row.pname}-${row.year}`] = row;<br/>          return acc;<br/>        }, {});<br/>        this.setState({<br/>          data: updatedData,<br/>          loading: false,<br/>          allPoints: buildVoronoiPoints(updatedData),<br/>          playerYearMap,<br/>          playerMap<br/>        });<br/>      });<br/>  }</span></pre><p id="3fcb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ä»¬æ¸…ç†çš„æ•°æ®å’Œä»¥å‰ä¸€æ ·ï¼Œå±å±ä½œå“ï¼Œå¾ˆå¥½ç”¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªåä¸º playerYearMap çš„æ–°å˜é‡ï¼Œè¿™ä¸ªå¯¹è±¡çš„é”®ç­‰äºçƒå‘˜å¹´å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå€¼ç­‰äºæ¯ä¸ªçƒå‘˜è¾¾åˆ°çš„ä¸‰åˆ†çš„æœ€å¤§åˆ†æ•°ã€‚è¿™å°†ç”¨äºç®€åŒ–æ ‡ç­¾å’Œå·¥å…·æç¤ºçš„å®šä½ã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ª playerMapï¼Œå®ƒä¹Ÿæœ‰çƒå‘˜å¹´ä»½æ ‡è¯†ç¬¦ä½œä¸ºé”®ï¼Œä½†è¿™æ¬¡æ˜¯æ•´è¡Œä½œä¸ºå€¼ã€‚è¿™å°†å…è®¸å½“æˆ‘ä»¬å°†é¼ æ ‡æ”¾åœ¨äº‹ç‰©ä¸Šæ—¶å¿«é€Ÿ/æŒç»­åœ°æŸ¥æ‰¾è¡Œã€‚</p><p id="1c8b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æœ€åä¸€ä¸ªæ–°å˜é‡ç§°ä¸º allPointsï¼Œç”±ä¸€ä¸ªåä¸º buildVoronoiPoints çš„å‡½æ•°ç”Ÿæˆã€‚æˆ‘æƒ³çŸ¥é“é‚£ä¼šæ˜¯ä»€ä¹ˆï¼Ÿè¿™æ˜¯å‡½æ•°(å®ƒå­˜åœ¨äº utils ä¸­):</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="51a9" class="ln lo iq lj b gy lp lq l lr ls">export function buildVoronoiPoints(data) {<br/>  return data.reduce((acc, {player, pname, year, gameData}) =&gt; {<br/>    return acc.concat({<br/>      player,<br/>      pname,<br/>      year,<br/>      x: 41,<br/>      y: gameData[gameData.length - 1].y<br/>    });<br/>  }, []);<br/>}</span></pre><p id="32a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™å°†ä¸ºæ¯ä¸ªçƒå‘˜åœ¨è¯¥çƒå‘˜æœ€å¤§ä¸‰åˆ†ç‚¹æ•°çš„â€œé«˜åº¦â€åŒºåŸŸçš„ä¸­å¿ƒåˆ›å»ºä¸€ä¸ªå•ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ª Voronoi å›¾ã€‚Voronoi æ˜¯ç©ºé—´å¹³é¢åˆ†å‰²ï¼Œä½¿å¾—å½¢æˆç‚¹çš„é›†åˆï¼Œå…¶ä¸­æ¯ä¸ªç‚¹åŒ…å«åœ¨å…¶è‡ªå·±çš„å•å…ƒå†…ã€‚æˆ‘ä»¬ä¿è¯æ¯ä¸ªç‚¹å°†ä¸å…¶ä»–ç‚¹éš”ç¦»ã€‚è¿™ä¸ªå±æ€§å¯¹é¼ æ ‡æ‚¬åœæœ‰å¾ˆå¤§çš„å½±å“ï¼Œå› æ­¤ç”¨æˆ·ä¸€æ¬¡åªèƒ½å°†é¼ æ ‡æ‚¬åœåœ¨ä¸€ä¸ªç‚¹ä¸Šã€‚</p><figure class="le lf lg lh gt nj gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/34a290e5cf58a73d2de67b948b31e628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*wUKeEZHx328Pt6EJK4gx2w.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">A colored in voronoi diagram, source <a class="ae lb" href="https://en.wikipedia.org/wiki/Voronoi_diagram#/media/File:Euclidean_Voronoi_diagram.svg" rel="noopener ugc nofollow" target="_blank">wikipedia</a></figcaption></figure><p id="4028" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ä»¬æ­£åœ¨æ¨¡ä»¿åœ¨æœ€åˆçš„ NYT å›¾å½¢ä¸­å‘ç°çš„é¼ æ ‡æ‚¬åœè®¾ç½®ï¼Œåœ¨é‚£é‡Œé£æœºè¢«åˆ†æˆå¸¦çŠ¶ï¼Œè¿™æ ·å½“ä½ ä¸Šä¸‹ç§»åŠ¨é¼ æ ‡æ—¶ï¼Œå½“å‰é€‰æ‹©çš„ç©å®¶å¹´ä»½ä¼šæ”¹å˜ï¼Œå½“ä½ å·¦å³ç§»åŠ¨é¼ æ ‡æ—¶ï¼Œå®ƒä¿æŒä¸å˜ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ Voronoi å’Œæˆ‘ä»¬ä¹‹å‰ç‰¹åˆ«æ„å»ºçš„æ‰€æœ‰ç‚¹æ¥é‡å»ºè¿™ç§è¡Œä¸ºã€‚ä¸€æ—¦å®ç°ï¼Œvoronoi å•å…ƒçš„å¸ƒå±€å°†å¦‚ä¸‹æ‰€ç¤º:</p><figure class="le lf lg lh gt nj gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/6c90daa4cc0fc511954672dac53affb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*iAaF1xUXOyi3aL9br35rLw.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">(When weâ€™re done we will remove the stroke attribute from the Voronoi cells shown here, that way our user is none the wiser about our mouse over technique ğŸ˜‰)</figcaption></figure><p id="835e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç›¸å½“é…·ï¼ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½æŸ¥çœ‹äº¤äº’å¼ç»„ä»¶çš„ä»£ç äº†ã€‚</p><figure class="le lf lg lh gt nj"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="532b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å°±åƒæˆ‘ä»¬å¤©çœŸçš„æ–¹æ³•ä¸€æ ·ï¼Œè®©æˆ‘ä»¬ä¸€æ¬¡çœ‹ä¸€ä¸ªæœ‰è¶£çš„éƒ¨åˆ†ã€‚è®©æˆ‘ä»¬ä»æˆ¿é—´é‡Œçš„å¤§è±¡å¼€å§‹:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="de29" class="ln lo iq lj b gy lp lq l lr ls">&lt;Voronoi<br/>            extent={[<br/>              [0, y(MAX_NUMBER_OF_THREE_POINTERS)], <br/>              [width, height - margin.bottom]<br/>            ]}<br/>            nodes={allPoints}<br/>            polygonStyle={{<br/>              // UNCOMMENT BELOW TO SEE VORNOI<br/>              stroke: 'rgba(0, 0, 0, .2)'<br/>            }}<br/>            onHover={row =&gt; {<br/>              const player = playerMap[`${row.pname}-${row.year}`];<br/>              if (!player) {<br/>                this.setState({<br/>                  highlightSeries: null,<br/>                  highlightTip: null<br/>                });<br/>                return;<br/>              }<br/>              this.debouncedSetState({<br/>                highlightSeries: player.gameData,<br/>                highlightTip: {<br/>                  y: player.gameData[player.gameData.length - 1].y,<br/>                  name: row.pname<br/>                }<br/>              });<br/>            }}<br/>            x={d =&gt; x(d.x)}<br/>            y={d =&gt; y(d.y)}<br/>            /&gt;</span></pre><p id="77d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™ä¸ªæ— å®³çš„ç»„ä»¶æ¥å—ä¸€ä¸ªç‚¹åˆ—è¡¨ï¼Œå¹¶ç›´æ¥åœ¨ dom ä¸­æ„å»ºä¸€ä¸ª voronoi å›¾ã€‚ä¸ react-vis ä¸­çš„å…¶ä»–ç»„ä»¶ç›¸æ¯”ï¼Œå®ƒçš„å±æ€§ç­¾åæœ‰ç‚¹ä¸æ­£å¸¸(æ‚¨éœ€è¦æä¾›ä¸€ä¸ªåˆ»åº¦ï¼ŒèŒƒå›´),æ‰€ä»¥è¦å°å¿ƒï¼åœ¨è¿™ä¸ªç»„ä»¶ä¸­å€¼å¾—æ³¨æ„çš„å¦ä¸€ä»¶äº‹æ˜¯ä½¿ç”¨äº† debouncedSetState å‡½æ•°ï¼Œæ­£å¦‚æ‚¨ä»ä¸Šé¢æ‰€æ³¨æ„åˆ°çš„ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥å®šä¹‰å®ƒ:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="fc50" class="ln lo iq lj b gy lp lq l lr ls">componentWillMount() {<br/>    this.debouncedSetState = debounce(newState =&gt;<br/>      this.setState(newState), 40);<br/>  }</span></pre><p id="4eca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¯¥å‡½æ•°åˆ©ç”¨äº†ç§°ä¸ºå»æŠ–çš„ lodash å‡½æ•°ï¼Œè¯¥å‡½æ•°é˜²æ­¢å‡½æ•°è¢«è°ƒç”¨è¶…è¿‡ç‰¹å®šé¢‘ç‡(åœ¨æœ¬ä¾‹ä¸­ä¸ºæ¯ 40 ms ä¸€æ¬¡)ã€‚é˜²æ­¢è¿™ç§ç±»å‹çš„è¶…å¿«é€ŸçŠ¶æ€æ”¹å˜å¯¹æˆ‘ä»¬æ˜¯æœ‰åˆ©çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›æ¯æ¬¡ç”¨æˆ·åšå‡ºå¾ˆå°çš„åŠ¨ä½œå°±å¯¼è‡´çŠ¶æ€æ”¹å˜ã€‚è¿™å°†å¯¼è‡´æŠ–åŠ¨å’Œä¸å¿…è¦çš„é‡ç»˜ï¼ä¸ºäº†æ©ç›–è¿™ä¸€ç‚¹ç‚¹å»¶è¿Ÿï¼Œæˆ‘ä»¬é€šè¿‡åœ¨ LineSeries ä¸ŠåŒ…å«åŠ¨ç”»é“å…·æ¥æ·»åŠ åŠ¨ç”»ã€‚</p><p id="190f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¾—åˆ°:</p><figure class="le lf lg lh gt nj gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/4b815bc59ff4f139e0f2c9af03b4b284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/1*v_Znzq64bzZwd8Kvn9YFqQ.gif"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Our pan-ultimate draft of the visualization</figcaption></figure><p id="1eff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¨¡ä¸€äº›å°çš„é€ å‹è§¦æ‘¸ï¼Œå°±æ˜¯è¿™æ ·ï¼å®ƒè¿è¡Œå¹³ç¨³ï¼Œå‡†ç¡®åœ°å†ç°äº†åœ¨åŸå§‹å¯è§†åŒ–ä¸­å‘ç°çš„äº¤äº’ã€‚ç›¸å½“é…·ï¼</p><h2 id="fac9" class="ln lo iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">è¿˜æœ‰ä¸€ç‚¹</h2><p id="9663" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">æˆ‘ä»¬å·²ç»å¾ˆå¥½åœ°æ¨¡æ‹Ÿäº†æœ€åˆçš„ NYT å¯è§†åŒ–çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬æƒ³çŸ¥é“:æˆ‘ä»¬èƒ½åšå¾—æ›´å¥½å—ï¼Ÿä»–ä»¬å±•ç¤ºçš„é¼ æ ‡æ‚¬åœåŠŸèƒ½æ˜¯åˆç†çš„ï¼Œä½†æ˜¯å®ƒæœ‰ç‚¹ç¬¨æ‹™ï¼Œå› ä¸ºé‡å ï¼Œé˜»æ­¢ä½ å°†é¼ æ ‡æ‚¬åœåœ¨æ¯ä¸ªç©å®¶èº«ä¸Šã€‚å¦‚æœæˆ‘ä»¬èƒ½ä»¥ä¸€ç§æ˜æ™ºçš„å’Œæœ‰æ•ˆçš„æ–¹å¼æ¥ç®€åŒ–å®ƒï¼Œæˆ‘ä»¬ä¼šå¾ˆé«˜å…´ã€‚è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œè€Œä¸”ï¼Œå¦‚æœæˆ‘ä»¬çœŸçš„æ˜¯è¯šå®çš„ï¼Œå¤§å¤šæ•°é—®é¢˜ï¼Œæ˜¯ä½¿æˆ‘ä»¬çš„ Voronoi æ›´åŠ ç»†è‡´å…¥å¾®ã€‚</p><p id="da4f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸€ä¸ªç®€å•çš„è†è·³æ˜¯ä¸ºæ¯ä¸ªæ•°æ®ç‚¹å»ºæ¨¡åˆ›å»º Voronoi å•å…ƒã€‚è™½ç„¶è¿™æ ·åšæ˜¯å®Œå…¨å¯èƒ½çš„ï¼Œä½†æ˜¯ä¼šäº§ç”Ÿå¤§é‡çš„ç»†èƒã€‚å¦‚æœåœ¨ 750 åç©å®¶çš„èµ›å­£ä¸­æœ‰ 82 åœºæ¯”èµ›ï¼Œé‚£å°†æ˜¯ 61ï¼Œ500 ä¸ªä¸åŒçš„å•å…ƒï¼æ ¹æ®ä¸€èˆ¬ç»éªŒï¼Œæµè§ˆå™¨æœ€å¤šåªèƒ½å¤„ç†å‡ åƒä¸ª SVG å…ƒç´ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´åŠ èªæ˜ã€‚</p><p id="84c6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸€ä¸ªå¼ºå¤§çš„è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡ç®€åŒ–æˆ‘ä»¬çš„æ¯ä¸€è¡Œæ¥å¼€å‘æ•°æ®é›†çš„ç®€åŒ–æ¨¡å‹ã€‚ä»¤äººæ„‰å¿«çš„æ˜¯ï¼Œæœ‰å¤§é‡å…³äºçº¿æ¡ç®€åŒ–çš„å·¥ä½œï¼Œæ¯”å¦‚éå¸¸ä¼˜ç§€çš„ Vladimir Agafonkin/monner çš„ simplify-js åº“ã€‚è®¸å¤šè¿™ç±»å·¥ä½œçš„å‡ºç°æ˜¯å› ä¸ºåˆ¶å›¾å‘˜å¯¹ä¿å­˜æµ·å²¸çº¿å’Œå…¶ä»–ä¸è§„åˆ™åœ°ç†å®ä½“çš„ç²—ç³™è¾¹ç¼˜çš„ç®€åŒ–å½¢çŠ¶æ„Ÿå…´è¶£ã€‚ä½†æ˜¯æˆ‘ä»¬ä¼šæŠŠå®ƒç”¨åœ¨ä¸åŒçš„åœ°æ–¹ã€‚</p><figure class="le lf lg lh gt nj gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi ob"><img src="../Images/729f1fd1dd7376b27344bb22bff1ba1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*w2cuVZtzoJeMdI3NiknaiQ.gif"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">mournerâ€™s <a class="ae lb" href="http://mourner.github.io/simplify-js/" rel="noopener ugc nofollow" target="_blank">simplify-js</a> demo page, simplifying complex lines.</figcaption></figure><p id="c08a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ä»¬å°†ç®€åŒ–æ¯ä¸ªçƒå‘˜çš„å¹´çº¿ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä»–ä»¬çš„çº¿çš„è¦ç‚¹ï¼Œæ²¡æœ‰å¤ªå¤šçš„ç»†èŠ‚ã€‚æˆ‘ä»¬é€šè¿‡åœ¨ utils æ–‡ä»¶ä¸­æ·»åŠ å¦ä¸€é¡¹å†…å®¹æ¥è®© simplify-js å¤„ç†æˆ‘ä»¬çš„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œäº†è¿™ä¸ªæƒ³æ³•:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="1b38" class="ln lo iq lj b gy lp lq l lr ls">const betterThanCurryLine = simplify(stephCurryRecord, 0.5)<br/>    .map(({x, y}) =&gt;<br/>        ({x, y: y + 20, pname: 'Stephen Curry', year: 2016}));</span><span id="ee32" class="ln lo iq lj b gy nt lq l lr ls">const SIMPLICATION = 3;<br/>export function buildVoronoiPointsWithSimplification(data) {<br/>  return data.reduce((acc, {player, pname, year, gameData}) =&gt; {<br/>    return acc.concat(<br/>      simplify(gameData, SIMPLICATION).map(({x, y}) =&gt; ({player, pname, year, x, y}))<br/>    );<br/>  }, betterThanCurryLine);<br/>}</span></pre><p id="0b3c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä½œä¸ºè§†è§‰åŒ–ä¸»ä¹‰è€…ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå†²åŠ¨æ˜¯æƒ³çœ‹çœ‹è¿™äº›ç®€åŒ–æ˜¯ä»€ä¹ˆæ ·å­ï¼Œç§:</p><div class="le lf lg lh gt ab cb"><figure class="oc nj od oe of og oh paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><img src="../Images/2a77f231863e470fdc8e9855a4a90297.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*YAe3HZvLp_DtOl3_Nxhcfg.png"/></div></figure><figure class="oc nj oi oe of og oh paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><img src="../Images/cdeefe946e77b2683f2db08f118e888e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*iJImkzX8LzfjYuee2Mw1QQ.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk oj di ok ol">Visualization of the simplification of our model in preparation for a modest robust voronoi strategy (left) compared to the unsimplified data (right). On the left we that there is an (comparatively) jagged line above all of the others, this line is used to specially tune the character of the resulting voronoi. Curryâ€™s record breaking trajectory plays a big role in the userâ€™s experience of this chart, so it is necessary to provide some extra polish to make sure interactions with that line really shine.</figcaption></figure></div><p id="2017" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æœ‰äº†æ‰€æœ‰è¿™äº›ä¸œè¥¿ï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥çœ‹åˆ°æœ€ç»ˆçš„ voronoi å›¾äº†ã€‚è¯·çœ‹:</p><div class="le lf lg lh gt ab cb"><figure class="oc nj om oe of og oh paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><img src="../Images/e6839dd10b038cfd1219864d4d400431.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/1*XlJrxILqlixKeql2f7R0hA.gif"/></div></figure><figure class="oc nj on oe of og oh paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><img src="../Images/f03c818d43d56bb1d9934952ba5e491a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/1*-n2TJ8w7nB-2HRTpPXAn9g.gif"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk oo di op ol">The user experience of using our line-simplified voronoi technique (left), and a visualization of whatâ€™s going on under the hood (right).</figcaption></figure></div><h2 id="d4d4" class="ln lo iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">ç»“è®º</h2><p id="f7a3" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨ react-vis é‡å»ºå‡ºç‰ˆç‰©è´¨é‡çš„äº¤äº’å¼æ•°æ®å›¾å½¢ã€‚è¿™æ¶‰åŠåˆ°ä½¿ç”¨å„ç§å„æ ·çš„äº¤äº’å¼å¯è§†åŒ–æŠ€æœ¯ï¼ŒåŒ…æ‹¬ç”»å¸ƒæ¸²æŸ“ã€å•ç¨‹æ¸²æŸ“ã€å»æŠ–åŠ¨ã€Voronois å’Œçº¿ç®€åŒ–ï¼Œä½œä¸ºè¿½è¸ªçº¿ç³»åˆ—çš„æœºåˆ¶ã€‚å¹¶ä¸æ˜¯æ¯ä¸ªå¯è§†åŒ–éƒ½éœ€è¦è¿™ä¹ˆå¤šçš„ä¼˜åŒ–å’Œé«˜çº§æŠ€æœ¯ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å¾ˆå¤šå…³äºæˆ‘ä»¬çš„æ•°æ®å’Œç›®æ ‡è¡Œä¸ºï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½å¤ŸæŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼è¿›è¡Œè°ƒæ•´ã€‚</p><p id="4257" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨æ„å»ºæˆ‘ä»¬çš„å¯è§†åŒ–æ—¶ï¼Œæˆ‘ä»¬å¤§é‡ä½¿ç”¨äº† react-vis çš„ä¸€äº›ç‰¹æ€§ï¼Œä½†æ˜¯æœ¬æ–‡ä¸­è®¨è®ºçš„æ€æƒ³é€‚ç”¨äºä»»ä½•åŸºäº web çš„å¯è§†åŒ–æ¡†æ¶ã€‚ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨æ™®é€šçš„<a class="ae lb" href="https://d3js.org/" rel="noopener ugc nofollow" target="_blank"> d3 </a>ã€<a class="ae lb" href="https://github.com/emeeks/semiotic" rel="noopener ugc nofollow" target="_blank">ç¬¦å·</a>æˆ–è€…ä»»ä½•å…¶ä»–å¯ç”¨çš„å¯è§†åŒ–å·¥å…·æ¥å®ç°è¿™äº›æŠ€æœ¯ã€‚</p><p id="8c45" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¦‚æœä½ æƒ³çœ‹ä¸Šä¸‹æ–‡ä¸­çš„ä»£ç ï¼Œ<a class="ae lb" href="https://github.com/mcnuttandrew/advanced-react-vis-tutorial" rel="noopener ugc nofollow" target="_blank">çœ‹çœ‹è¿™ä¸ªæŠ¥å‘Š</a>ã€‚å¦‚éœ€æ›´å¤šé«˜çº§ç¤ºä¾‹ï¼Œè¯·æŸ¥çœ‹ react-vis æ–‡æ¡£çš„<a class="ae lb" href="https://uber.github.io/react-vis/examples/charts/streamgraph" rel="noopener ugc nofollow" target="_blank">å›¾è¡¨éƒ¨åˆ†</a>æˆ–æˆ‘çš„ä¸€äº›ä¸ªäººä½œå“ï¼Œæ¯”å¦‚è¿™ä¸ªçš„<a class="ae lb" href="http://www.mcnutt.in/home-graphs/" rel="noopener ugc nofollow" target="_blank">ï¼Œæˆ–è€…è¿™ä¸ª</a>çš„<a class="ae lb" href="http://www.mcnutt.in/color-of-the-year/" rel="noopener ugc nofollow" target="_blank">ï¼Œæˆ–è€…ç”šè‡³æ˜¯è¿™ä¸ª</a><a class="ae lb" href="http://www.mcnutt.in/city-size/" rel="noopener ugc nofollow" target="_blank">çš„</a>ã€‚</p><p id="d606" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¿«ä¹è§‚æƒ³ï¼</p></div></div>    
</body>
</html>