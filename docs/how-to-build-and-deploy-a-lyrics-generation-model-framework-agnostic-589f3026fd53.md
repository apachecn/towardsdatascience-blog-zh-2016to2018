# å¦‚ä½•æ„å»ºå’Œéƒ¨ç½²æ­Œè¯ç”Ÿæˆæ¨¡å‹â€”â€”ä¸æ¡†æ¶æ— å…³

> åŸæ–‡ï¼š<https://towardsdatascience.com/how-to-build-and-deploy-a-lyrics-generation-model-framework-agnostic-589f3026fd53?source=collection_archive---------7----------------------->

![](img/991c155b454a48e75e8c0cd4e25c2f79.png)

ä½ ä¼šå‘ç°å¤§é‡å…³äºå¦‚ä½•å»ºç«‹æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ–‡ç« ã€‚ä½ ä¼šå‘ç°å…³äºå¦‚ä½•æ˜æ™ºåœ°æ¶ˆè´¹å®ƒçš„æ–‡ç« æ¯”è¾ƒå°‘ã€‚è€Œä¸”ä½ ä¼šå‘ç°å‡ ä¹æ²¡æœ‰å…³äºå¦‚ä½•ä»é›¶å¼€å§‹æœåŠ¡å®ƒçš„æ–‡ç« ã€‚

æˆ‘å°†è¯¦ç»†è¯´æ˜æˆ‘ä»¬åˆ°ä¸Šé¢å¯ä»¥çœ‹åˆ°çš„äº§å“çš„æ­¥éª¤:[rap lytics . eu](https://www.raplyrics.eu/?utm_source=medium.com&utm_medium=article&utm_campaign=article1-medium)æ‰€æœ‰ä»£ç éƒ½æ˜¯å¼€æºçš„ï¼Œå¯ä»¥åœ¨ GitHub ä¸Šè·å¾—ã€‚
- [å¡«è¯-åˆ®åˆ€](https://github.com/fpaupier/RapLyrics-Scraper)
- [å¡«è¯-èƒŒé¢](https://github.com/cyrilou242/RapLyrics-Back)
- [å¡«è¯-æ­£é¢](https://github.com/fpaupier/RapLyrics-Front)

**æ›´æ–°**:åœ¨[è¿™ç¯‡](/tips-for-cost-effective-machine-learning-project-6dbc715e7c59?source=friends_link&sk=355e73b806aeec8951f2fc61087144fd)å¸–å­ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§æ›´å…·æˆæœ¬æ•ˆç›Šã€æ›´ç›´æ¥çš„æ–¹å¼æ¥ä¸ºä½ çš„æœºå™¨å­¦ä¹ é¡¹ç›®æœåŠ¡ã€‚

# **ä»€ä¹ˆï¼Ÿ**

å’Œæˆ‘çš„ä¸€ä¸ªå¥½æœ‹å‹ä¸€èµ·ï¼Œæˆ‘ä»¬çœŸçš„å¾ˆå–œæ¬¢å¬è¯´å”±éŸ³ä¹ã€‚è¯´å”±éŸ³ä¹æ˜¯å¼ºå¤§çš„ï¼Œå› ä¸ºå®ƒæœ‰èƒ½åŠ›åªç”¨å‡ ä¸ªè¯å°±åˆ›é€ å‡ºé‡è›®çš„ç¬‘ç‚¹ã€‚
ç”±äºä»ç„¶å¾ˆéš¾ç”¨ RNN ç”Ÿæˆé•¿æ–‡æœ¬ï¼Œæˆ‘ä»¬è®¤ä¸ºè¯´å”±éŸ³ä¹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å€™é€‰ã€‚

![](img/86a894b2969780d1e1b867418a856a0d.png)

The final product

# æ€ä¹ˆä¼šï¼Ÿ

*å¤§å±€*

![](img/e117951aa17bc454efd441775789a012.png)

Projectâ€™s architecture

æˆ‘ä¸ä¼šåœ¨å¸–å­ä¸­è¿‡å¤šæè¿°å®ç°ï¼Œå› ä¸ºæˆ‘ä»¬è¯•å›¾åœ¨ä»£ç åº“ä¸­åšåˆ°è¯¦å°½ï¼Œè§`READMEs`ã€‚æˆ‘å°†åšæŒå¯¹æˆ‘ä»¬å…·æœ‰æŒ‘æˆ˜æ€§çš„è½¬æŠ˜ç‚¹ã€‚

åŸºæœ¬çš„ç³»ç»Ÿç®¡ç†å‘˜çŸ¥è¯†å’Œ unix ç†Ÿç»ƒç¨‹åº¦ä¼šæœ‰æ‰€å¸®åŠ©ã€‚

# **1-æ•°æ®æå–å’Œå¤„ç†**

GitHub åº“: [RapLyrics-Scraper](https://github.com/fpaupier/RapLyrics-Scraper)

***â€”åˆ®å‰Š***

![](img/6fcbdadd86a7af94dee045a061255142.png)

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°æ®é›†æ¥è®­ç»ƒæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œã€‚

è¶³å¤Ÿå¹¸è¿çš„æ˜¯ï¼Œ[Genius.com](https://genius.com)æœ‰å¤§é‡çš„åœ¨çº¿æ­Œè¯ï¼Œç”šè‡³è¿˜æœ‰ä¸€ä¸ªä¸é”™çš„ [API](https://docs.genius.com) ã€‚

å®ƒå¯èƒ½ä¸æ˜¯ä¸ºåºŸå¼ƒæ­Œè¯è€Œè®¾è®¡çš„ï¼Œä½†é€šè¿‡ä¸€äº›å˜é€šæ–¹æ³•ï¼Œæˆ‘ä»¬è®¾æ³•åœ¨å®ƒä¸Šé¢å»ºç«‹äº†ä¸€ä¸ªæ­Œè¯åˆ®åˆ€ã€‚

å¦‚æœæ‚¨éœ€è¦æŠ€æœ¯ç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹æºä»£ç æˆ–åœ¨è¯„è®ºä¸­å¯»æ±‚å¸®åŠ©ã€‚
ç»è¿‡å¤šæ¬¡æ‹æ‘„ï¼Œæˆ‘ä»¬æ„è¯†åˆ°ä¸“æ³¨äºé«˜è´¨é‡çš„è‡ªç„¶è¯­è¨€å¤„ç†æ•°æ®é›†éå¸¸é‡è¦ã€‚æˆ‘ä»¬å†³å®šå…³æ³¨ 40 ä½ç¾å›½è‰ºæœ¯å®¶çš„ 60 é¦–æœ€å—æ¬¢è¿çš„æ­Œæ›²ã€‚

âœ”:æŠ¥åºŸäº†ã€‚

*â€”* ***é¢„å¤„ç†***

æŠ“å–éƒ¨åˆ†ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª`.txt`æ•°æ®é›†ã€‚æˆ‘ä»¬ç°åœ¨å¿…é¡»æ¸…ç†å®ƒâ€” *å³*åˆ é™¤éæŠ’æƒ…å†…å®¹:*ã€*ã€æ¼”èŒå‘˜è¡¨ã€é”™åˆ«å­—å’ŒåŒä¸€å•è¯çš„å„ç§æ‹¼å†™ã€‚æƒ³æƒ³`gettin'`ã€`getting`ä¹‹ç±»çš„ä¸œè¥¿ã€‚

æˆ‘ä»¬éµå¾ªçš„æ–¹æ³•:
1ã€‚è¯†åˆ«æ¨¡å¼ä»¥æ¶ˆé™¤
2ã€‚æ‰‹å·¥æ­£åˆ™è¡¨è¾¾å¼æ•æ‰é‚£äº›æ¨¡å¼â€” *æ­£åˆ™è¡¨è¾¾å¼æµ‹è¯•èµ„æº:*[*pythex.org*](https://pythex.org)
3 .ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ç›´æ¥åœ¨æ•°æ®é›†ä¸Šæ‰§è¡Œè¿™äº›æ­£åˆ™è¡¨è¾¾å¼

å¦‚æœä½ æƒ³è‡ªåŠ¨æ¸…ç†æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¦çŸ¥é“è¿™æ˜¯æœ‰é£é™©çš„ã€‚æ‚¨å¿…é¡»å½»åº•è€ƒè™‘æ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„é¡ºåºã€‚

*â€”* ***æ‰©å……æ•°æ®é›†*** *ã€å¯é€‰ã€‘*

æˆ‘ä»¬åªé€‰æ‹©äº†æ­Œè¯çœŸæ­£æœ‰æ„ä¹‰çš„è‰ºæœ¯å®¶ï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä»–ä»¬æœ€å—æ¬¢è¿çš„æ­Œæ›²ã€‚è¿™å¹¶ä¸æ„æˆä¸€ä¸ªåºå¤§çš„è¯­æ–™åº“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†³å®šæ‰§è¡Œä¸€ä¸ªæ•°æ®æ‰©å……æ­¥éª¤ï¼Œä»¥ä¾¿*å®é™…ä¸Š*å¢åŠ æˆ‘ä»¬æ•°æ®é›†çš„å¤§å°ã€‚

> ğŸ“–æ•°æ®æ‰©å……æ„å‘³ç€å¢åŠ æ•°æ®ç‚¹çš„æ•°é‡ã€‚åœ¨æˆ‘ä»¬çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå®ƒæ„å‘³ç€å¢åŠ å¥å­çš„æ•°é‡ã€‚

æˆ‘ä»¬å¤åˆ¶äº†æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œæ‰“ä¹±äº†æ‰€æœ‰çš„è¯—å¥ï¼Œç„¶åæŠŠå®ƒç²˜è´´åˆ°åŸå§‹æ•°æ®é›†çš„æœ«å°¾ã€‚

> ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªå…³äºå¦‚ä½•æ‰“ä¹±æ®µè½[çš„ç‰‡æ®µã€‚](https://gist.github.com/fpaupier/08475906e6bf97035a012a051dbb7b71)

ä½¿ç”¨è¿™ä¸ªæŠ€å·§ï¼Œæˆ‘ä»¬å°†æ•°æ®é›†çš„å¤§å°åŠ å€ã€‚è¿™å°†å¯¹ç¥ç»ç½‘ç»œçš„è®­ç»ƒäº§ç”Ÿç§¯æçš„å½±å“ã€‚å®é™…ä¸Šï¼Œç”±äºæ´—ç‰Œï¼Œæ¯ä¸ªæ–°æ‰¹æ¬¡éƒ½æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥ç½‘ç»œæƒé‡ç”¨ä¸åŒçš„è¾“å…¥æ¥æ›´æ–°ã€‚

âœ”:æ•°æ®æ‰©å……åˆ°æ­¤ç»“æŸã€‚

# **2-å»ºç«‹æ­Œè¯ç”Ÿæˆæ¨¡å‹**

*   GitHub èµ„æºåº“: [RapLyrics-Back](https://github.com/cyrilou242/RapLyrics-Back)

*â€”* ***æ ‡æ³¨æ–‡æœ¬åˆ›æˆå¼æ¨¡å‹***

![](img/2f5486b1167c22f3b04a729e3c3da3fd.png)

è®¸å¤šç¥ç»ç½‘ç»œå®ç°å¯åœ¨çº¿è·å¾—ã€‚æˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªå¹¶å¯¹å…¶è¿›è¡Œäº†å¾®è°ƒä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚: [textgenrnn](https://github.com/minimaxir/textgenrnn) â€” *ä¸€ä¸ªä½¿ç”¨ç¥ç»ç½‘ç»œç”Ÿæˆæ–‡æœ¬çš„ python é¡¹ç›®*ã€‚

æ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„ä»£ç åº“ä¸­æ‰¾åˆ°æ¨¡å‹è¶…å‚æ•°å’Œè®­ç»ƒè®¾ç½®çš„åŸºæœ¬æè¿°`READMEs`

æœ¬æ–‡çš„ç›®çš„ä¸æ˜¯æ·±å…¥ç ”ç©¶ç¥ç»ç½‘ç»œè®¾è®¡ã€‚å®ç°å°±ä¸ç»†è¯´äº†ã€‚æ‚¨å¯ä»¥æŸ¥çœ‹æºä»£ç æˆ–åœ¨è¯„è®ºä¸­ ping æˆ‘ä»¬ã€‚

*â€”* ***è®­ç»ƒæ–‡æœ¬ç”Ÿæˆæ¨¡å‹***

æ ¹æ®æ‚¨çš„æ•°æ®é›†å’Œé…ç½®ï¼Œæ‚¨å¯ä»¥è€ƒè™‘ä½¿ç”¨äº‘è®¡ç®—æ¥åŠ é€Ÿè®­ç»ƒã€‚æˆ‘ä»¬ä½¿ç”¨ AWSâ€”â€”äºšé©¬é€Šç½‘ç»œæœåŠ¡ã€‚

å¦‚æœæ‚¨åœ¨æœ¬åœ°åŸ¹è®­æ‚¨çš„æ¨¡å‹ï¼Œæ‚¨å¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚å¦åˆ™ï¼Œè€ƒè™‘åˆ°ä¸‹é¢çš„éƒ¨åˆ†ä¼šå˜å¾—æœ‰ç‚¹æŠ€æœ¯æ€§ã€‚

æˆ‘ä¼šæ›´è¯¦ç»†åœ°ä»‹ç»æˆ‘ä»¬çš„è®­ç»ƒè®¾ç½®ï¼Œå› ä¸ºè¿™éœ€è¦æˆ‘ä»¬èŠ±æ—¶é—´å»é€‚åº”ã€‚

æˆ‘ä»¬å¯åŠ¨äº† aws ec2 spot å®ä¾‹æ¥é™ä½æˆæœ¬ã€‚æˆ‘ä»¬éœ€è¦è‡³å°‘ 3gb çš„å†…å­˜å’Œ 8gb çš„é»˜è®¤å›ºæ€ç¡¬ç›˜è¶³å¤Ÿäº†ã€‚è®­ç»ƒä¸æ˜¯ GPU åŠ é€Ÿçš„(ä¸€ä¸ªæ”¹è¿›ç‚¹)ã€‚

![](img/b7715c4c58efef272116e79fec14eb5c.png)

83% savings on a spot instance comparing to a classic ec2 instance

ec2 spot å®ä¾‹ä¸ä¼ ç»Ÿ ec2 å®ä¾‹æœ‰ä½•ä¸åŒï¼Ÿ

> æ‚¨å‡ºä»·è´­ä¹°ä¸€ä¸ªå…·æœ‰ç‰¹å®šè§„æ ¼çš„ ec2 å®ä¾‹ï¼Œåªè¦æ‚¨çš„å‡ºä»·é«˜äºå¹³å‡å¸‚åœºä»·æ ¼ï¼Œæ‚¨å°±æ‹¥æœ‰äº†ä¸€ä¸ªè¡Œä¸ºç±»ä¼¼ç»å…¸ ec2 çš„å®ä¾‹ã€‚
> 
> å¦‚æœä½ çš„å‡ºä»·ä½äºå¸‚åœºä»·æ ¼ï¼Œä½ çš„å®ä¾‹åœ¨ä¸€ä¸ªçŸ­æ—¶é—´é€šçŸ¥åè¢«ç»ˆæ­¢ã€‚å…³äº[èšå…‰ç¯å®ä¾‹](https://aws.amazon.com/fr/ec2/spot/)çš„æ›´å¤šä¿¡æ¯ã€‚

æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªç°åœºè¯·æ±‚ï¼Œå¾ˆå¿«å°±å®Œæˆäº†ï¼Œç„¶åæˆ‘ä»¬å…‹éš†äº†æˆ‘ä»¬çš„ repo å¹¶å®‰è£…äº†ä¸€ä¸ªåŒ…å«æ‰€æœ‰é¡¹ç›®éœ€æ±‚çš„ python3 è™šæ‹Ÿç¯å¢ƒã€‚

*æ³¨æ„:å¦‚æœæ‚¨æƒ³è¦ä¿å­˜æ‚¨çš„æ¨¡å‹æ£€æŸ¥ç‚¹ï¼Œæ‚¨éœ€è¦ä½¿æ‚¨çš„å®ä¾‹èƒ½å¤Ÿåœ¨ s3 å­˜å‚¨æ¡¶ä¸Šå†™å…¥(å¦‚å›¾æ‰€ç¤ºğŸ‘‡)*

*texgenrnn* åœ¨æ¯ä¸ªæ—¶æœŸä¿å­˜ä¸€ä¸ªæ¨¡å‹æ£€æŸ¥ç‚¹ã€‚

*   ä¸ºäº†åº”å¯¹å®ä¾‹ç»ˆæ­¢çš„é£é™©å¹¶åœ¨å®‰å…¨çš„åœ°æ–¹ä¿å­˜æˆ‘ä»¬çš„æ£€æŸ¥ç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨`aws cli`åœ¨ aws s3 æ¡¶ä¸­å¤åˆ¶æ£€æŸ¥ç‚¹ã€‚`cd`åˆ°æ‚¨çš„æ£€æŸ¥ç‚¹æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬å¤åˆ¶åˆ°æ‚¨çš„ s3 å­˜å‚¨æ¡¶ã€‚

```
# run `pip install awscli` beforehand
aws s3 cp my-checkpoint-file.ckpt s3:*//my-s3-bucket/model-saves/*
```

æ³¨æ„:è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ‚¨éœ€è¦å‘å®ä¾‹æˆäºˆå¯¹ ec2 çš„å†™æƒé™ã€‚ä¸ºæ­¤ï¼Œå‘æ‚¨çš„ ec2 å®ä¾‹æ·»åŠ ä¸€ä¸ªè§’è‰²ï¼Œä½¿ç”¨ s3 å®Œå…¨è®¿é—®å’Œ ec2 å®Œå…¨è®¿é—®ç­–ç•¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](img/9e11c7fe7fb6fdb43accbe399830b93e.png)

Attach those 2 policies to the IAM role attached to your ec2 instance.

æ”¿ç­–å¤„ç†ä¸­æœ‰è®¸å¤šå·å·æ‘¸æ‘¸çš„ç»†èŠ‚ï¼Œä¸è¦çŠ¹è±«ï¼Œåœ¨è¯„è®ºä¸­é—®æˆ‘ä»¬ã€‚

*â€”â€”*â€”â€”**â€”â€”*æµ‹è¯•æ–‡æœ¬ç”Ÿæˆ*â€”â€”**

ä¸€æ—¦ä½ è®­ç»ƒå¥½äº†ä½ çš„æ¨¡å‹ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ Jupyter ç¬”è®°æœ¬`[RapLyrics-Back/exploration/sample_explorator.ipynb](https://github.com/cyrilou242/RapLyrics-Back/blob/master/exploration/sample_explorator.ipynb)`æ¥ç”Ÿæˆä½ çš„ç¬¬ä¸€é¦–äººå·¥æ™ºèƒ½æ­Œè¯ã€‚

# ***3ã€‚æœåŠ¡äºæ–‡æœ¬ç”Ÿæˆæ¨¡å‹***

ä¸ºäº†ç»™ç”¨æˆ·æä¾›æ›´å¥½çš„æ­Œè¯ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª[è‡ªå®šä¹‰ç”Ÿæˆå‡½æ•°](https://github.com/cyrilou242/RapLyrics-Back/blob/master/sampler.py)ã€‚

![](img/38cab77b0dec0452a6162c9d7f908a8a.png)

æˆ‘ä»¬ä½¿ç”¨ [gunicorn](http://gunicorn.org) åœ¨[çƒ§ç“¶](http://flask.pocoo.org/docs/1.0/)ä¸Šæä¾›åº”ç”¨ç¨‹åºã€‚è¿™ä¸ªæƒ³æ³•æ˜¯ä¸è¦åœ¨æ¯æ¬¡ API è°ƒç”¨æ—¶é‡æ–°åŠ è½½æ¨¡å‹â€”â€”è¿™ä¼šå¯¼è‡´å¾ˆé•¿çš„å“åº”æ—¶é—´ã€‚
æˆ‘ä»¬åªåœ¨åº”ç”¨ç¨‹åºåˆå§‹åŒ–æ—¶æ¢å¤ä¸€æ¬¡ä¼šè¯ï¼Œå®ƒåœ¨ API è°ƒç”¨ä¹‹é—´æŒç»­å­˜åœ¨ã€‚

API è°ƒç”¨åŠå…¶å“åº”çš„æ¼”ç¤ºã€‚

![](img/65b2492200ab043ca6bd376cfcff4707.png)

curl on back-end

å¦‚æœæ‚¨è¿˜æ²¡æœ‰å®ç°è¯¥æ¨¡å‹ï¼Œè¯·éšæ—¶è°ƒç”¨æˆ‘ä»¬çš„ API:

```
curl '[https://raplyrics.eu/apiUS'](https://raplyrics.eu/apiUS') -X POST -H "Content-Type: application/x-www-form-urlencoded" -d "input=struggle"
```

å‚è§[ä¸Š`api/serve_us.py`ä¸­çš„`get_model_api_us`å‡½æ•°ï¼Œäº†è§£æˆ‘ä»¬å¦‚ä½•å»ºç«‹ä¸€ä¸ªæŒä¹…çš„å¼ é‡æµä¼šè¯](https://github.com/cyrilou242/RapLyrics-Back/blob/master/server.py)ã€‚åªéœ€ä» shell ä¸­è¿è¡Œ`gunicorn app:app`æ¥å¯åŠ¨åº”ç”¨ç¨‹åºã€‚æ¨¡å‹é»˜è®¤åœ¨`127.0.0.1:8000`ç«¯ä¸Šã€‚

ä½ ç°åœ¨å¯ä»¥åœ¨å°†è¢«ç”¨ä½œç½‘ç»œæœåŠ¡å™¨çš„æœºå™¨ä¸Šå…‹éš† [RapLyrics-Back](https://github.com/cyrilou242/RapLyrics-Back) ã€‚

# 4-æ’å…¥å‰ç«¯

GitHub èµ„æºåº“: [RapLyrics-Front](https://github.com/fpaupier/RapLyrics-Front)

æœ¬æ–‡æè¿°äº† apache web æœåŠ¡å™¨çš„å¿…è¦æ­¥éª¤ã€‚å¦‚æœæ²¡æœ‰å®ƒ`sudo apt-get install apache`ã€‚

å°†æ‰€æœ‰è¦æä¾›çš„æ–‡ä»¶ä» [RapLyrics-Front](https://github.com/fpaupier/RapLyrics-Front) ç§»åŠ¨åˆ°`/var/www/html/`
è®°ä½åœ¨`index.html` ä¸­æ›´æ–°ä½ çš„ç«¯ç‚¹çš„`"url"`è®¾ç½®å°±è¿™æ ·ï¼Œä½ å°±å¤§åŠŸå‘Šæˆäº†(å·®ä¸å¤š)ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡ç½‘ç»œæµè§ˆå™¨è®¿é—®æ‚¨çš„æœåŠ¡å™¨`ip`æ¥è®¿é—®ç½‘ç«™ã€‚

*â€”* ***ç”Ÿäº§è®¾ç½®*** *ã€å¯é€‰ã€‘*

å¦‚æœæ‚¨æƒ³è®©å‰ç«¯å’Œåç«¯åœ¨åŒä¸€å°æœºå™¨ä¸Šä½¿ç”¨ https è¿æ¥ï¼Œä¸‹é¢æ˜¯å‡ ä¸ªæ­¥éª¤ã€‚

1.è®©æˆ‘ä»¬åŠ å¯†æˆ‘ä»¬çš„ç½‘ç«™ğŸ”’â†’æŒ‰ç…§[å¦‚ä½•ç”¨åŠ å¯†æ¥ä¿æŠ¤ Apache çš„æ­¥éª¤è¿›è¡Œ](https://www.digitalocean.com/community/tutorials/how-to-secure-apache-with-let-s-encrypt-on-ubuntu-16-04)(æ•°å­—æµ·æ´‹æœ‰éå¸¸æ£’çš„æ•™ç¨‹)

2.å½“ç”¨æˆ·æäº¤è¾“å…¥æ—¶ï¼Œapache æœåŠ¡çš„`index.html`è°ƒç”¨`raplyrics.eu/apiUS`ã€‚äº‹å®ä¸Šï¼Œé˜¿å¸•å¥‡ä¸Šæ²¡æœ‰`/apiUS`èˆªçº¿ã€‚æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªè°ƒç”¨é‡å®šå‘åˆ°è¿è¡Œåœ¨åŒä¸€å°æœºå™¨ä¸Šçš„`gunicorn`æœåŠ¡å™¨ã€‚è¿™å°±æ˜¯æ‰€è°“çš„*åå‘ä»£ç†ã€‚*

è®©æˆ‘ä»¬æ¥å¤„ç†è¿™ä¸¤ä¸ªæ­¥éª¤ã€‚
ç”±äºä»£ç ä¸ apache é…ç½®ç›¸å…³ï¼Œå› æ­¤ä¸å—ç‰ˆæœ¬æ§åˆ¶ã€‚

*   å»`/etc/apache2/sites-available`

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ª`000-default.conf`å’Œä¸€ä¸ª`000-default-le-ssl.conf`æ–‡ä»¶ã€‚å®ƒä»¬æ˜¯æ¨¡æ¿æ–‡ä»¶ï¼Œå¤„ç† apache å¦‚ä½•æœåŠ¡äº http å’Œ https ( `le-ssl`)ç½‘ç«™çš„é…ç½®ã€‚

æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„ç½‘ç«™å¤åˆ¶äº†ä¸€ä»½ã€‚(ç”¨æ‚¨çš„åŸŸåæ›¿æ¢`raplyrics.eu`ğŸ‘‡)

`sudo cp 000-default.conf raplyrics.eu.conf`
`sudo cp 000-default-le-ssl.conf raplyrics.eu-le-ssl.conf`

**1ã€‚å°†æµé‡ä»** `**http**` **é‡å®šå‘åˆ°** `**https**`

ç¼–è¾‘`raplyrics.eu.conf`ä»¥åŒ…æ‹¬ä»¥ä¸‹é‡å†™æ¡ä»¶:

Rewrite rules to redirect traffic from http to https. Remember to replace raplyrics.eu by your site name.

**2ã€‚åå‘ä»£ç† API è°ƒç”¨**

ç¼–è¾‘`raplyrics.eu-le-ssl.conf`ä»¥åŒ…å«ä»£ç†åå‘æŒ‡ä»¤ã€‚

Reverse proxy to redirect the API call to the gunicorn app

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¤„ç†ä»`raplyrics.eu/apiUS`åˆ°`127.0.0.1:8000`çš„æœ¬åœ° gunicorn æœåŠ¡å™¨çš„ä»£ç†ä¼ é€’

ç°åœ¨æˆ‘ä»¬å‘Šè¯‰ apache æ›´æ–°ç½‘ç«™é…ç½®:

`sudo a2ensite raplyrics.eu.conf`
`sudo a2ensite raplyrics.eu-le-ssl.conf`

æœ€åï¼Œ`sudo systemctl restart apache2`è¦æŠŠå˜åŒ–è€ƒè™‘è¿›å»ã€‚

å°±è¿™æ ·ï¼Œä½ åœ¨åˆ¶ä½œä¸­ã€‚ğŸš€
ä½ å¯ä»¥åœ¨ [raplyrics.eu](https://www.raplyrics.eu/?utm_source=medium.com&utm_medium=article&utm_campaign=article1-medium) ä¸ŠæŸ¥çœ‹æˆ‘ä»¬çš„

# å‚è€ƒğŸ“š

å…³äºåœ¨ heroku ä¸Šæä¾› python åº”ç”¨çš„æœ‰è¶£åšå®¢æ–‡ç« (Heroku dynos æ— æ³•å¤„ç†æˆ‘ä»¬çš„åº”ç”¨â€”â€”æ²¡æœ‰è¶³å¤Ÿçš„ ram)å¾ˆå¥½åœ°æè¿°äº†æ­¥éª¤ã€‚

[Apache 2 ä¸Šçš„åå‘ä»£ç†](https://httpd.apache.org/docs/2.4/howto/reverse_proxy.html)

æ•°å­—æµ·æ´‹åœ¨ apache ä¸Šçš„åå‘ä»£ç†ï¼Œæ•°å­—æµ·æ´‹å†æ¬¡åšäº†ä¸€ä¸ªéå¸¸å€¼å¾—èµèµçš„æ–‡æ¡£å·¥ä½œï¼Œéå¸¸è¯¦ç»†ã€‚

éå¸¸æœ‰è¶£ï¼Œæ‰€ä»¥åœ¨[ä¸Šå‘å¸ƒå¦‚ä½•ç”¨ GitLab å’Œ AWS æ„å»º CI / CD ç®¡é“](https://stackoverflow.com/questions/38671818/how-to-deploy-with-gitlab-ci-to-ec2-using-aws-codedeploy-codepipeline-s3)

[ç¥ç»ç½‘ç»œå‚æ•°å¾®è°ƒçš„å¯ç¤º](https://skymind.ai/wiki/lstm)

æœ‰è¶£çš„[å…³äºå¾®è°ƒæ‰¹é‡è®­ç»ƒå‚æ•°](https://stats.stackexchange.com/questions/153531/what-is-batch-size-in-neural-network?newreg=e96dc96f976b43e0a6a21955daa54498)çš„äº¤å‰éªŒè¯å¸–å­ã€‚

[è°·æ­Œå¤§è„‘è®ºæ–‡æå‡ºäº†ä¸€ç»„æ–‡æœ¬ç”Ÿæˆ LSTM çš„è¶…çº§å‚æ•°](https://arxiv.org/pdf/1409.2329v4.pdf)(å°¤å…¶æ˜¯ 4ã€‚æˆ‘ä»¬ç”¨ä¾‹çš„å®éªŒå’Œ 4.1 è¯­è¨€å»ºæ¨¡ã€‚)