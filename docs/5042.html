<html>
<head>
<title>Pytorch: how and when to use Module, Sequential, ModuleList and ModuleDict</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pytorch:å¦‚ä½•ä»¥åŠä½•æ—¶ä½¿ç”¨æ¨¡å—ã€é¡ºåºã€æ¨¡å—åˆ—è¡¨å’Œæ¨¡å—æŒ‡ä»¤</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/pytorch-how-and-when-to-use-module-sequential-modulelist-and-moduledict-7a54597b5f17?source=collection_archive---------3-----------------------#2018-09-24">https://towardsdatascience.com/pytorch-how-and-when-to-use-module-sequential-modulelist-and-moduledict-7a54597b5f17?source=collection_archive---------3-----------------------#2018-09-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f4cb6bdd9cde347a31e6e675fd3b4b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G02W6-MM2CSCsa9DiA5NFg.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/photos/C0koz3G1I4I?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae jg" href="https://unsplash.com/search/photos/lego?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="9e53" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">å˜¿ï¼Œæˆ‘åœ¨</em><a class="ae jg" href="https://www.linkedin.com/in/francesco-saverio-zuppichini-94659a150/" rel="noopener ugc nofollow" target="_blank"><em class="le">LinkedIn</em></a><em class="le">è¿‡æ¥æ‰“ä¸ªæ‹›å‘¼ğŸ‘‹</em></p><p id="016d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">åœ¨ Pytorch 1.7 æ›´æ–°</em></p><p id="ac5c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä»£ç <a class="ae jg" href="https://github.com/FrancescoSaverioZuppichini/Pytorch-how-and-when-to-use-Module-Sequential-ModuleList-and-ModuleDict" rel="noopener ugc nofollow" target="_blank"/></p><p id="0092" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae jg" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> Pytorch </a>æ˜¯ä¸€ä¸ªå¼€æºçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæä¾›äº†ä¸€ç§åˆ›å»º ML æ¨¡å‹çš„æ™ºèƒ½æ–¹å¼ã€‚å³ä½¿æ–‡æ¡£åšå¾—å¾ˆå¥½ï¼Œæˆ‘ä»ç„¶å‘ç°å¤§å¤šæ•°äººä»ç„¶èƒ½å¤Ÿå†™å‡ºç³Ÿç³•çš„ã€æ²¡æœ‰æ¡ç†çš„ PyTorch ä»£ç ã€‚</p><p id="611b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä»Šå¤©æˆ‘ä»¬æ¥çœ‹çœ‹ PyTorch çš„ä¸‰ä¸ªä¸»è¦æ„å»ºæ¨¡å—æ˜¯å¦‚ä½•ä½¿ç”¨çš„:<code class="fe lf lg lh li b">Module, Sequential and ModuleList</code>ã€‚æˆ‘ä»¬å°†ä»ä¸€ä¸ªä¾‹å­å¼€å§‹ï¼Œå¹¶ä¸æ–­æ”¹è¿›ã€‚</p><p id="03df" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™å››ä¸ªç±»éƒ½åŒ…å«åœ¨<code class="fe lf lg lh li b">torch.nn</code>ä¸­</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><h1 id="bb35" class="lp lq jj bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">æ¨¡å—:ä¸»è¦æ„å»ºæ¨¡å—</h1><p id="6593" class="pw-post-body-paragraph kg kh jj ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated"><a class="ae jg" href="https://pytorch.org/docs/stable/nn.html?highlight=module" rel="noopener ugc nofollow" target="_blank">æ¨¡å—</a>æ˜¯ä¸»è¦çš„æ„å»ºæ¨¡å—ï¼Œå®ƒå®šä¹‰äº†æ‰€æœ‰ç¥ç»ç½‘ç»œçš„åŸºç±»ï¼Œæ‚¨å¿…é¡»å¯¹å…¶è¿›è¡Œå­ç±»åŒ–ã€‚</p><p id="5631" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç»å…¸çš„ CNN åˆ†ç±»å™¨ä½œä¸ºç¤ºä¾‹:</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="37d8" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (conv2): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (fc1): Linear(in_features=25088, out_features=1024, bias=True) (fc2): Linear(in_features=1024, out_features=10, bias=True) )</span></pre><p id="edf5" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„åˆ†ç±»å™¨ï¼Œç¼–ç éƒ¨åˆ†ä½¿ç”¨ä¸¤å±‚ 3x3 convs + batchnorm + reluï¼Œè§£ç éƒ¨åˆ†ä½¿ç”¨ä¸¤ä¸ªçº¿æ€§å±‚ã€‚å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰ PyTorchï¼Œæ‚¨å¯èƒ½ä»¥å‰è§è¿‡è¿™ç§ç±»å‹çš„ç¼–ç ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªé—®é¢˜ã€‚</p><p id="0891" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœæˆ‘ä»¬æƒ³å¢åŠ ä¸€å±‚ï¼Œæˆ‘ä»¬å¿…é¡»å†æ¬¡åœ¨<code class="fe lf lg lh li b">__init__</code>å’Œ<code class="fe lf lg lh li b">forward</code>å‡½æ•°ä¸­å†™å¾ˆå¤šä»£ç ã€‚æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€äº›æƒ³è¦åœ¨å¦ä¸€ä¸ªæ¨¡å‹ä¸­ä½¿ç”¨çš„å…¬å…±å—ï¼Œä¾‹å¦‚ 3x3 conv + batchnorm + reluï¼Œæˆ‘ä»¬å¿…é¡»é‡æ–°ç¼–å†™å®ƒã€‚</p><h1 id="cd5e" class="lp lq jj bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">è¿ç»­:å †å å’Œåˆå¹¶å±‚</h1><p id="1a24" class="pw-post-body-paragraph kg kh jj ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated"><a class="ae jg" href="https://pytorch.org/docs/stable/nn.html?highlight=sequential#torch.nn.Sequential" rel="noopener ugc nofollow" target="_blank">é¡ºåº</a>æ˜¯æ¨¡å—çš„å®¹å™¨ï¼Œå¯ä»¥å †å åœ¨ä¸€èµ·ï¼ŒåŒæ—¶è¿è¡Œã€‚</p><p id="0061" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½ å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬å·²ç»æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å‚¨å­˜åˆ°<code class="fe lf lg lh li b">self</code>é‡Œäº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe lf lg lh li b">Sequential</code>æ¥æ”¹è¿›æˆ‘ä»¬çš„ä»£ç ã€‚</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="bec2" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (conv_block1): Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (conv_block2): Sequential( (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (decoder): Sequential( (0): Linear(in_features=25088, out_features=1024, bias=True) (1): Sigmoid() (2): Linear(in_features=1024, out_features=10, bias=True) ) )</span></pre><p id="c5f1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¥½å¤šäº† uhuï¼Ÿ</p><p id="5789" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°<code class="fe lf lg lh li b">conv_block1</code>å’Œ<code class="fe lf lg lh li b">conv_block2</code>çœ‹èµ·æ¥å‡ ä¹ä¸€æ ·ï¼Ÿæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªé‡è¿°<code class="fe lf lg lh li b">nn.Sequential</code>çš„å‡½æ•°æ¥ç®€åŒ–ä»£ç ï¼</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="bc3b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨æ¨¡å—ä¸­è°ƒç”¨è¿™ä¸ªå‡½æ•°</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="e764" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (conv_block1): Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (conv_block2): Sequential( (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (decoder): Sequential( (0): Linear(in_features=25088, out_features=1024, bias=True) (1): Sigmoid() (2): Linear(in_features=1024, out_features=10, bias=True) ) )</span></pre><p id="ff3b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ›´å¹²å‡€ï¼è¿˜æ˜¯<code class="fe lf lg lh li b">conv_block1</code>å’Œ<code class="fe lf lg lh li b">conv_block2</code>å·®ä¸å¤šï¼æˆ‘ä»¬å¯ä»¥ç”¨<code class="fe lf lg lh li b">nn.Sequential</code>åˆå¹¶å®ƒä»¬</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="433c" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (encoder): Sequential( (0): Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (1): Sequential( (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) ) (decoder): Sequential( (0): Linear(in_features=25088, out_features=1024, bias=True) (1): Sigmoid() (2): Linear(in_features=1024, out_features=10, bias=True) ) )</span></pre><p id="9a0a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lf lg lh li b">self.encoder</code>ç°å æ®å±•ä½<code class="fe lf lg lh li b">conv_block</code>ã€‚æˆ‘ä»¬å·²ç»ä¸ºæˆ‘ä»¬çš„æ¨¡å‹è§£è€¦äº†é€»è¾‘ï¼Œä½¿å®ƒæ›´å®¹æ˜“é˜…è¯»å’Œé‡ç”¨ã€‚æˆ‘ä»¬çš„<code class="fe lf lg lh li b">conv_block</code>åŠŸèƒ½å¯ä»¥å¯¼å…¥åˆ°å¦ä¸€ä¸ªæ¨¡å‹ä¸­ä½¿ç”¨ã€‚</p><h1 id="aa95" class="lp lq jj bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">åŠ¨æ€è¿ç»­:ä¸€æ¬¡åˆ›å»ºå¤šä¸ªå±‚</h1><p id="532d" class="pw-post-body-paragraph kg kh jj ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">å¦‚æœæˆ‘ä»¬å¯ä»¥åœ¨<code class="fe lf lg lh li b">self.encoder</code>ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„å±‚ï¼Œç¡¬ç¼–ç ä¼šä¸æ–¹ä¾¿:</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="a88f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœæˆ‘ä»¬å¯ä»¥å°†å¤§å°å®šä¹‰ä¸ºä¸€ä¸ªæ•°ç»„å¹¶è‡ªåŠ¨åˆ›å»ºæ‰€æœ‰çš„å±‚ï¼Œè€Œä¸éœ€è¦å†™å…¥æ¯ä¸€å±‚ï¼Œè¿™æ˜¯ä¸æ˜¯å¾ˆå¥½ï¼Ÿå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ•°ç»„å¹¶å°†å…¶ä¼ é€’ç»™<code class="fe lf lg lh li b">Sequential</code></p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="a8c1" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (encoder): Sequential( (0): Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (1): Sequential( (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) ) (decoder): Sequential( (0): Linear(in_features=25088, out_features=1024, bias=True) (1): Sigmoid() (2): Linear(in_features=1024, out_features=10, bias=True) ) )</span></pre><p id="be04" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹ã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„<code class="fe lf lg lh li b">self.enc_sizes</code>æ¥ä¿å­˜ç¼–ç å™¨çš„å¤§å°ã€‚ç„¶åæˆ‘ä»¬é€šè¿‡è¿­ä»£å¤§å°åˆ›å»ºä¸€ä¸ªæ•°ç»„<code class="fe lf lg lh li b">conv_blocks</code>ã€‚å› ä¸ºæˆ‘ä»¬å¿…é¡»ç»™ booth ä¸€ä¸ªå°ºå¯¸ï¼Œå¹¶ç»™æ¯ä¸€å±‚ä¸€ä¸ªç‰¹å¤§å·ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡å°†æ•°ç»„ç§»åŠ¨ä¸€ä½æ¥å®ç°æ•°ç»„æœ¬èº«ã€‚</p><p id="c13c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¸ºäº†æ¸…æ¥šèµ·è§ï¼Œçœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­:</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="e888" class="mw lq jj li b gy mx my l mz na">1 32 32 64</span></pre><p id="afcf" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç„¶åï¼Œç”±äº<code class="fe lf lg lh li b">Sequential</code>ä¸æ¥å—åˆ—è¡¨ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨<code class="fe lf lg lh li b">*</code>æ“ä½œç¬¦æ¥åˆ†è§£å®ƒã€‚</p><p id="e091" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Tadaï¼ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åªæƒ³æ·»åŠ ä¸€ä¸ªå°ºå¯¸ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„æ•°å­—ã€‚å°†å¤§å°ä½œä¸ºå‚æ•°æ˜¯ä¸€ç§å¸¸è§çš„åšæ³•ã€‚</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="740c" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (encoder): Sequential( (0): Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (1): Sequential( (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (2): Sequential( (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) ) (decoder): Sequential( (0): Linear(in_features=25088, out_features=1024, bias=True) (1): Sigmoid() (2): Linear(in_features=1024, out_features=10, bias=True) ) )</span></pre><p id="95ac" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥å¯¹è§£ç å™¨éƒ¨åˆ†åšåŒæ ·çš„äº‹æƒ…</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="f92e" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (encoder): Sequential( (0): Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (1): Sequential( (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) ) (decoder): Sequential( (0): Sequential( (0): Linear(in_features=25088, out_features=1024, bias=True) (1): Sigmoid() ) (1): Sequential( (0): Linear(in_features=1024, out_features=512, bias=True) (1): Sigmoid() ) ) (last): Linear(in_features=512, out_features=10, bias=True) )</span></pre><p id="4c32" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬éµå¾ªç›¸åŒçš„æ¨¡å¼ï¼Œæˆ‘ä»¬ä¸ºè§£ç éƒ¨åˆ†åˆ›å»ºä¸€ä¸ªæ–°çš„å—ï¼Œlinear + sigmoidï¼Œå¹¶ä¼ é€’ä¸€ä¸ªåŒ…å«å¤§å°çš„æ•°ç»„ã€‚æˆ‘ä»¬å¿…é¡»æ·»åŠ ä¸€ä¸ª<code class="fe lf lg lh li b">self.last</code>,å› ä¸ºæˆ‘ä»¬ä¸æƒ³æ¿€æ´»è¾“å‡º</p><p id="d5cb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥å°†æˆ‘ä»¬çš„æ¨¡å‹ä¸€åˆ†ä¸ºäºŒï¼ç¼–ç å™¨+è§£ç å™¨</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="49df" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (encoder): MyEncoder( (conv_blokcs): Sequential( (0): Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) (1): Sequential( (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() ) ) ) (decoder): MyDecoder( (dec_blocks): Sequential( (0): Sequential( (0): Linear(in_features=1024, out_features=512, bias=True) (1): Sigmoid() ) ) (last): Linear(in_features=512, out_features=10, bias=True) ) )</span></pre><p id="ae4a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ³¨æ„<code class="fe lf lg lh li b">MyEncoder</code>å’Œ<code class="fe lf lg lh li b">MyDecoder</code>ä¹Ÿå¯ä»¥æ˜¯è¿”å›<code class="fe lf lg lh li b">nn.Sequential</code>çš„å‡½æ•°ã€‚æˆ‘æ›´å–œæ¬¢å¯¹æ¨¡å‹ä½¿ç”¨ç¬¬ä¸€ç§æ¨¡å¼ï¼Œå¯¹æ„å»ºæ¨¡å—ä½¿ç”¨ç¬¬äºŒç§æ¨¡å¼ã€‚</p><p id="c20f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">é€šè¿‡å°†æˆ‘ä»¬çš„æ¨¡å—åˆ†æˆå­æ¨¡å—ï¼Œå…±äº«ä»£ç ã€<strong class="ki jk">è°ƒè¯•ä»£ç ã€T23 æµ‹è¯•ä»£ç å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</strong></p><h1 id="3b40" class="lp lq jj bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">ModuleList:å½“æˆ‘ä»¬éœ€è¦è¿­ä»£æ—¶</h1><p id="d817" class="pw-post-body-paragraph kg kh jj ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated"><code class="fe lf lg lh li b">ModuleList</code>å…è®¸æ‚¨å°†<code class="fe lf lg lh li b">Module</code>å­˜å‚¨ä¸ºåˆ—è¡¨ã€‚å½“ä½ éœ€è¦éå†å±‚å¹¶å­˜å‚¨/ä½¿ç”¨ä¸€äº›ä¿¡æ¯æ—¶ï¼Œæ¯”å¦‚åœ¨ U-net ä¸­ï¼Œå®ƒä¼šå¾ˆæœ‰ç”¨ã€‚</p><p id="5456" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lf lg lh li b">Sequential</code>ä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯<code class="fe lf lg lh li b">ModuleList</code>æ²¡æœ‰<code class="fe lf lg lh li b">forward</code>æ–¹æ³•ï¼Œæ‰€ä»¥å†…å±‚æ²¡æœ‰è¿æ¥ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦è§£ç å™¨ä¸­æ¯ä¸ªå±‚çš„æ¯ä¸ªè¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å­˜å‚¨å®ƒ:</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="7467" class="mw lq jj li b gy mx my l mz na">torch.Size([4, 16]) torch.Size([4, 32]) [None, None]</span></pre><h1 id="aa14" class="lp lq jj bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">ModuleDict:å½“æˆ‘ä»¬éœ€è¦é€‰æ‹©æ—¶</h1><p id="c5ac" class="pw-post-body-paragraph kg kh jj ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">å¦‚æœæˆ‘ä»¬æƒ³åœ¨æˆ‘ä»¬çš„<code class="fe lf lg lh li b">conv_block</code>ä¸­åˆ‡æ¢åˆ°<code class="fe lf lg lh li b">LearkyRelu</code>å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe lf lg lh li b">ModuleDict</code>åˆ›å»ºä¸€ä¸ª<code class="fe lf lg lh li b">Module</code>çš„å­—å…¸ï¼Œå¹¶åœ¨éœ€è¦æ—¶åŠ¨æ€åˆ‡æ¢<code class="fe lf lg lh li b">Module</code></p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="e390" class="mw lq jj li b gy mx my l mz na">Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): LeakyReLU(negative_slope=0.01) ) Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): ReLU() )</span></pre><h1 id="bb6f" class="lp lq jj bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">æœ€ç»ˆå®æ–½</h1><p id="4830" class="pw-post-body-paragraph kg kh jj ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">è®©æˆ‘ä»¬æŠŠä¸€åˆ‡éƒ½ç»“æŸå§ï¼</p><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm gt iv"><div class="bz fp l di"><div class="ln lo l"/></div></figure><pre class="lj lk ll lm gt ms li mt mu aw mv bi"><span id="6fed" class="mw lq jj li b gy mx my l mz na">MyCNNClassifier( (encoder): MyEncoder( (conv_blokcs): Sequential( (0): Sequential( (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): LeakyReLU(negative_slope=0.01) ) (1): Sequential( (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True) (2): LeakyReLU(negative_slope=0.01) ) ) ) (decoder): MyDecoder( (dec_blocks): Sequential( (0): Sequential( (0): Linear(in_features=1024, out_features=512, bias=True) (1): Sigmoid() ) ) (last): Linear(in_features=512, out_features=10, bias=True) ) )</span></pre><h1 id="4e45" class="lp lq jj bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">ç»“è®º</h1><p id="4064" class="pw-post-body-paragraph kg kh jj ki b kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä»£ç <a class="ae jg" href="https://github.com/FrancescoSaverioZuppichini/Pytorch-how-and-when-to-use-Module-Sequential-ModuleList-and-ModuleDict" rel="noopener ugc nofollow" target="_blank"/></p><p id="f804" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç»¼ä¸Šæ‰€è¿°ã€‚</p><ul class=""><li id="09e0" class="nb nc jj ki b kj kk kn ko kr nd kv ne kz nf ld ng nh ni nj bi translated">å½“ä½ æœ‰ä¸€ä¸ªç”±å¤šä¸ªå°å—ç»„æˆå¤§å—æ—¶ï¼Œä½¿ç”¨<code class="fe lf lg lh li b">Module</code></li><li id="0d0d" class="nb nc jj ki b kj nk kn nl kr nm kv nn kz no ld ng nh ni nj bi translated">å½“ä½ æƒ³ä»å±‚ä¸­åˆ›å»ºä¸€ä¸ªå°å—æ—¶ï¼Œä½¿ç”¨<code class="fe lf lg lh li b">Sequential</code></li><li id="dd03" class="nb nc jj ki b kj nk kn nl kr nm kv nn kz no ld ng nh ni nj bi translated">å½“ä½ éœ€è¦è¿­ä»£ä¸€äº›å±‚æˆ–æ„å»ºå—å¹¶åšä¸€äº›äº‹æƒ…æ—¶ï¼Œä½¿ç”¨<code class="fe lf lg lh li b">ModuleList</code></li><li id="2ddb" class="nb nc jj ki b kj nk kn nl kr nm kv nn kz no ld ng nh ni nj bi translated">å½“éœ€è¦å‚æ•°åŒ–æ¨¡å‹çš„æŸäº›æ¨¡å—æ—¶ï¼Œä¾‹å¦‚æ¿€æ´»åŠŸèƒ½ï¼Œä½¿ç”¨<code class="fe lf lg lh li b">ModuleDict</code></li></ul><p id="3907" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">é‚£éƒ½æ˜¯ä¹¡äº²ä»¬ï¼</p><p id="0311" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ„Ÿè°¢æ‚¨çš„é˜…è¯»</p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="c757" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">åŸè½½äº</em><a class="ae jg" href="https://gist.github.com/7b228760eefe8e77fb0a37b5783a379c" rel="noopener ugc nofollow" target="_blank"><em class="le">gist.github.com</em></a><em class="le">ã€‚</em></p></div></div>    
</body>
</html>