# æœ€åä¸€å¹•â€”â€”å°±åƒä¸€ä¸ªå¤©çœŸçš„è´å¶æ–¯ä¸“å®¶ï¼

> åŸæ–‡ï¼š<https://towardsdatascience.com/the-final-act-just-like-a-na%C3%AFve-bayes-pro-5c440b511b8d?source=collection_archive---------8----------------------->

## å¯¹äº ML åˆå­¦è€…

![](img/bcbbb2854adad01d02fb57851ce3407a.png)

ä»é›¶å¼€å§‹å±•å¼€æœ´ç´ è´å¶æ–¯ï¼Take-3ğŸ¬

ä½ å‡ ä¹æ˜¯åœ¨æ©ç›–æœ´ç´ è´å¶æ–¯æ–‡æœ¬åˆ†ç±»ç®—æ³•çš„æ‰€æœ‰æ–¹é¢ã€‚

> *ä»¥é˜²ä½ é”™è¿‡äº†ä¹‹å‰çš„åšæ–‡ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥*
> 
> [***ä»é›¶å¼€å§‹å±•å¼€æœ´ç´ è´å¶æ–¯ Take-1ğŸ¬***](/unfolding-naÃ¯ve-bayes-from-scratch-2e86dcae4b01) *ï¼ä¸€ä¸ªç®€å•æ˜äº†çš„æœ´ç´ è´å¶æ–¯è§£é‡Šï¼Œä»¥ä¾¿åœ¨å¼€å§‹ç¼–ç ä¹‹å‰æ¸…æ¥šåœ°äº†è§£è¿™ä¸ªç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„*
> 
> [***ä»é›¶å¼€å§‹å±•å¼€æœ´ç´ è´å¶æ–¯ï¼*take-2***ğŸ¬*](/naÃ¯ve-bayes-from-scratch-using-python-only-no-fancy-frameworks-a1904b37222d) *:åœ¨è½¬å‘ python çš„ ML å·¥å…·åŒ…ä¹‹å‰ï¼Œåœ¨åŸºæœ¬ python ä¸­ä»å¤´å®ç°æœ´ç´ è´å¶æ–¯åªæ˜¯ä¸ºäº†å·©å›ºæ ¸å¿ƒç†è§£*

## ç›®æ ‡å—ä¼—æ˜¯è°ï¼ŸğŸ—£ ğŸ—£ ğŸ—£

å°±åƒæˆ‘åœ¨ä»¥å‰çš„åšå®¢æ–‡ç« ä¸­æåˆ°çš„ä¸€æ ·ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯ä¸º ML åˆå­¦è€…å‡†å¤‡çš„â€”â€”å…³æ³¨åŸºæœ¬æ¦‚å¿µã€‚

## æœ¬æ•™ç¨‹çš„æˆæœâ€”NB çš„å®è·µ Scikit-learn å®æ–½

ä½¿ç”¨ Python çš„æœºå™¨å­¦ä¹ æ¡†æ¶ Scikit-learn å®ç° NB çš„å®Œæ•´æ¼”ç»ƒ

# å®šä¹‰è·¯çº¿å›¾â€¦..ğŸšµ

**é‡Œç¨‹ç¢‘# 1:** [**é¢„å¤„ç†è®­ç»ƒæ•°æ®é›†**](#e4a9)

**é‡Œç¨‹ç¢‘# 2:** [**åœ¨é¢„å¤„ç†çš„è®­ç»ƒæ•°æ®é›†ä¸Šè®­ç»ƒ NB æ¨¡å‹**](#6198)

**é‡Œç¨‹ç¢‘# 3:** [**ä½¿ç”¨è®­ç»ƒå¥½çš„ NB æ¨¡å‹**](#2959) è¿›è¡Œæµ‹è¯•

**é‡Œç¨‹ç¢‘# 4:** [**åŸ¹è®­&ä½¿ç”¨ Scikit æµ‹è¯•-å­¦ä¹ ç®¡é“åŠŸèƒ½**](#ad35)

> è®©æˆ‘ä»¬ä» Scikit-learn å®ç°å¼€å§‹å§ï¼

# **é¢„å¤„ç†è®­ç»ƒæ•°æ®é›†**

ä¸€äº›è¿›å£è´§â€¦

é¢„å¤„ç†å‡½æ•°ä¸[ä»å¤´å¼€å§‹å±•å¼€æœ´ç´ è´å¶æ–¯ä¸­å®šä¹‰çš„ç›¸åŒï¼Take-2ğŸ¬](/naÃ¯ve-bayes-from-scratch-using-python-only-no-fancy-frameworks-a1904b37222d)

## æ­£åœ¨åŠ è½½ 20 ä¸ªæ–°é—»ç»„æ•°æ®é›†

è¿™ä¸ä¹‹å‰åœ¨[ä»å¤´å¼€å§‹å±•å¼€æœ´ç´ è´å¶æ–¯ä¸­ä½¿ç”¨çš„æ•°æ®é›†ç›¸åŒï¼Take-2ğŸ¬](/naÃ¯ve-bayes-from-scratch-using-python-only-no-fancy-frameworks-a1904b37222d)

è¿™æ˜¯åŸå§‹å½¢å¼çš„è®­ç»ƒæ•°æ®é›†çš„æ ·å­â€¦..

![](img/c2aa4fd4812712c5a4f72e01164a0e5f.png)

è®©æˆ‘ä»¬ä»è®­ç»ƒæ•°æ®é›†çš„é¢„å¤„ç†å¼€å§‹ï¼ŒåŒ…æ‹¬

1.  æ–‡æœ¬æ¸…ç†
2.  åˆ›å»ºæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†çš„ BoW è¡¨ç¤º(æµ‹è¯•æ•°æ®é›†ä¹Ÿéœ€è¦åŒæ ·çš„è¡¨ç¤º)

**æ–‡å­—æ¸…ç†**

å¤„ç†åçš„è®­ç»ƒæ•°æ®é›†å¦‚ä¸‹æ‰€ç¤º

![](img/ab01e0b0ac49623377ed3942cb28df00.png)

**åˆ›å»ºæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†çš„ BoW è¡¨ç¤º**

> ***count vectorizer ä¸Šçš„å‡ è¡Œ***
> 
> *è®¡æ•°çŸ¢é‡å™¨çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ
> æ¥æ”¶æ–‡æœ¬è¯­æ–™åº“ï¼Œå»ºç«‹å…¶æœ¯è¯­æ–‡æ¡£çŸ©é˜µ(å³ BoW ),å¹¶å°†å…¶è¿”å›*
> 
> *æ¯ä¸ªå•è¯è¢«åˆ†é…ä¸€ä¸ªå›ºå®šçš„å”¯ä¸€æ•´æ•° idï¼Œè¯¥çŸ©é˜µçš„æ¯ä¸ªå•å…ƒçš„å€¼ä»£è¡¨å•è¯è®¡æ•°â€”â€”BoW*
> 
> *ä¾‹å¦‚ï¼ŒX_train_counts[ iï¼Œj ] ( i æŒ‡çš„æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ¯ä¸ªæ–‡æ¡£æŒ‡å®šä¸€ä¸ªè®­ç»ƒç¤ºä¾‹ï¼Œj æŒ‡çš„æ˜¯å•è¯ w åœ¨å…¶å„è‡ªçš„æ–‡æ¡£ I ä¸­çš„ç´¢å¼•)å°†è¿”å›å•è¯ j çš„è®¡æ•°*

ä¸‹é¢æ˜¯ X_train_counts çŸ©é˜µçš„æ ·å­:
X_train_counts[0ï¼Œ12048]å°†æ£€ç´¢æ•´æ•° id = 12048ã€æ–‡æ¡£/ç¤ºä¾‹ id ä¸º 0 çš„ word çš„å­—æ•°

![](img/b83993752c90d618122f4276fe4085ec.png)

**é‡Œç¨‹ç¢‘# 1 å·²å®ç°**ğŸ‘

# **åœ¨é¢„å¤„ç†çš„è®­ç»ƒæ•°æ®é›†ä¸Šè®­ç»ƒ NB æ¨¡å‹**

ç®€å•åœ°åœ¨å®ä¾‹åŒ–ä¸€ä¸ª NB å¯¹è±¡åï¼Œæˆ‘ä»¬è°ƒç”¨*æ‹Ÿåˆå‡½æ•°*æ¥è®­ç»ƒä¸€ä¸ª NB æ¨¡å‹ã€‚æˆ‘ä»¬å°†ç®€å•åœ°ä¼ é€’è®­ç»ƒç¤ºä¾‹ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°&è®­ç»ƒé›†æ ‡ç­¾ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚

> *æ³¨æ„ï¼ŒX_train_counts(æœ¯è¯­æ–‡æ¡£çŸ©é˜µ)ä½œä¸ºè®­ç»ƒç¤ºä¾‹è€Œä¸æ˜¯æ–‡æœ¬æ•°æ®è¢«ä¼ é€’*

æˆ‘ä»¬åªç”¨ 3 è¡Œä»£ç å°±å®Œæˆäº†åŸ¹è®­ï¼

**é‡Œç¨‹ç¢‘# 2 å·²å®ç°**ğŸ‘ ğŸ‘

# **ä½¿ç”¨ç»è¿‡è®­ç»ƒçš„ NB æ¨¡å‹è¿›è¡Œæµ‹è¯•**

åœ¨æˆ‘ä»¬å¼€å§‹æµ‹è¯•ä¹‹å‰ï¼Œæˆ‘ä»¬å°†é¦–å…ˆéœ€è¦ä»¥ä¸è®­ç»ƒæ•°æ®é›†ç›¸åŒçš„æ–¹å¼å¯¹å…¶è¿›è¡Œé¢„å¤„ç†

**æµ‹è¯•è®¾ç½®æ–‡æœ¬æ¸…ç†**

**åˆ›å»ºæµ‹è¯•æ•°æ®é›†çš„ BoW è¡¨ç¤º** ä¸ºè®­ç»ƒæ•°æ®é›†å®ä¾‹åŒ–çš„ç›¸åŒ count_vect å¯¹è±¡å°†ç”¨äºæµ‹è¯•æ•°æ®é›†ã€‚ä½†æ˜¯è¯·è®°ä½ï¼Œæˆ‘ä»¬ä¸æ˜¯åœ¨æµ‹è¯•é›†ä¸Šè°ƒç”¨ fit_transformï¼Œå› ä¸ºæˆ‘ä»¬åªæƒ³å°†æµ‹è¯•æ•°æ®è½¬æ¢ä¸ºæœ¯è¯­-æ–‡æ¡£çŸ©é˜µï¼Œè€Œ fit_transform é¦–å…ˆå­¦ä¹ è¯æ±‡è¯å…¸ï¼Œç„¶åè¿”å›æœ¯è¯­-æ–‡æ¡£çŸ©é˜µã€‚æˆ‘ä»¬åº”è¯¥åªå­¦ä¹ è®­ç»ƒæ•°æ®é›†ä¸­çš„è¯æ±‡

```
fit_transform : learns the vocabulary dictionary and returns term-document matrixtransform : transforms documents to document-term matrix
```

**ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•æ•°æ®é›†çš„è½¬æ¢ç‰ˆæœ¬ä¸Šè¿›è¡Œæµ‹è¯•**

æˆ‘ä»¬å°†ç®€å•åœ°è°ƒç”¨ä¸º NB æ¨¡å‹æ‹Ÿåˆ/è®­ç»ƒçš„ clf å¯¹è±¡ä¸Šçš„é¢„æµ‹å‡½æ•°

![](img/26f571155725d6defdc67dc88a4ebece.png)

> ***é‡Œç¨‹ç¢‘# 3 å®ç°*** *ğŸ‘ ğŸ‘ ğŸ‘*

# **åŸ¹è®­&ä½¿ç”¨ Scikit æµ‹è¯•-å­¦ä¹ ç®¡é“åŠŸèƒ½**

ç®¡é“åˆ›é€ å¥‡è¿¹ï¼é€šè¿‡ä½¿ç”¨ sklearn çš„ç®¡é“åŠŸèƒ½ï¼Œä¸Šè¿°ä»£ç å¯ä»¥è¿›ä¸€æ­¥å‡å°‘åˆ° 3 è¡Œä»£ç 

> æˆ‘ä»¬åªéœ€é€šè¿‡æŒ‡å®šç®¡é“åŠ¨ä½œæ¥æ„å»ºä¸€ä¸ªç®¡é“å¯¹è±¡ï¼Œä¸€æ—¦è¯¥ç®¡é“å¯¹è±¡ç”¨äºè®­ç»ƒï¼Œå®ƒå°†æŒ‰ç…§æŒ‡å®šçš„é¡ºåºè‡ªåŠ¨æ‰§è¡Œç®¡é“æ­¥éª¤ã€‚
> 
> *åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸º BoW æ„å»ºä¸€ä¸ª CountVectorizerï¼Œç„¶åæ‹Ÿåˆ/è®­ç»ƒä¸€ä¸ª NB æ¨¡å‹ï¼Œæ‰€ä»¥ä»¥å®Œå…¨ç›¸åŒçš„æ–¹å¼ï¼Œæˆ‘ä»¬å°†åœ¨ç®¡é“ä¸­æŒ‡å®šè¿™äº›æ“ä½œã€‚*
> 
> *è¯·æ³¨æ„ï¼Œç°åœ¨å½“è°ƒç”¨ fir æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å°†ä¼ é€’åŸå§‹æ–‡æœ¬æ•°æ®ï¼Œå› ä¸ºç°åœ¨ç®¡é“ä¸­çš„ count_vect å°†è‡ªå·±å°†å…¶è½¬æ¢ä¸ºæ•°å­—å½¢å¼ã€‚å› æ­¤ï¼Œåœ¨è¿™é‡Œä¼ é€’æ–‡æœ¬æ•°æ®å¾ˆé‡è¦ï¼Œå¦åˆ™ä¼šå‡ºç°ä»¤äººè®¨åŒçš„é”™è¯¯ã€‚æµ‹è¯•æ•°æ®ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¸éœ€è¦å•ç‹¬å¯¹å…¶è¿›è¡Œè®¡æ•°çŸ¢é‡åŒ–ï¼Œä½†æˆ‘ä»¬éœ€è¦ä»æ¸…ç†çš„è§’åº¦å¯¹æµ‹è¯•æ•°æ®è¿›è¡Œé¢„å¤„ç†*

æœ€åä¸€éƒ¨åˆ†â€”â€”æµ‹è¯•

> æ‰€æœ‰çš„åŸ¹è®­å’Œæµ‹è¯•åªéœ€ 3 è¡Œä»£ç ï¼

![](img/d632b226a55558d3dd5f0c7807bcb022.png)

# ä½ åšåˆ°äº†ï¼

> ***é‡Œç¨‹ç¢‘# 4 å®ç°*** *ğŸ‘ ğŸ‘ ğŸ‘ ğŸ‘*

ä½ å¯ä»¥åœ¨ Jupyter ç¬”è®°æœ¬ [**è¿™é‡Œ**](https://github.com/aishajv/Unfolding-Naive-Bayes-from-Scratch/blob/master/%23%20Unfolding%20Na%C3%AFve%20Bayes%20from%20Scratch!%20Take-3%20%F0%9F%8E%AC.ipynb) æ‰¾åˆ°æ‰€æœ‰æºä»£ç 

å¦‚æœæ‚¨æœ‰ä»»ä½•æƒ³æ³•ã€æ„è§æˆ–é—®é¢˜ï¼Œæ¬¢è¿åœ¨ä¸‹é¢è¯„è®ºæˆ–è”ç³»ğŸ“ä¸æˆ‘ä¸€èµ·ä¸Š [**LinkedIn**](https://www.linkedin.com/in/aisha-javed/)