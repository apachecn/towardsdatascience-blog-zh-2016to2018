# TensorFlow &åå…‰èƒ¶å¸¦ğŸ€(æˆ‘ç¯®çƒæ‰“å¾—ä¸å¥½å—ï¼Ÿ)

> åŸæ–‡ï¼š<https://towardsdatascience.com/tensorflow-reflective-tape-why-im-bad-at-basketball-a30a923332de?source=collection_archive---------13----------------------->

![](img/d23aecdf35069465c9dc5a1bfec6462b.png)

æœ€è¿‘ä¸€ä¸ªæœ‹å‹è®©æˆ‘è¿·ä¸Šäº†ç¯®çƒã€‚äº‹å®è¯æ˜ï¼Œè¿™æ¯”çœ‹èµ·æ¥éš¾å¤šäº†ã€‚æ²¡å…³ç³»ï¼Œæˆ‘å¯ä»¥ç”¨æœºå™¨å­¦ä¹ æ¥è®¾è®¡è§£å†³æ–¹æ¡ˆã€‚å¦‚æœä½ å¯¹ ML å’ŒæŠ•ç¯®æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆä¹Ÿæœ‰[è¿™ç¯‡æ–‡ç« ](https://medium.com/tensorflow/tf-jam-shooting-hoops-with-machine-learning-7a96e1236c32)åœ¨æ¨¡æ‹Ÿä¸­ç»“åˆäº†å¼ é‡æµå’Œç¯®çƒã€‚

![](img/90f18d0b8c98b8bcd2d5373e260c5200.png)

nothing but netâ€¦ if there was a net

ä»»åŠ¡æ˜¯æ‰¾åˆ°æˆ‘æ‹æ‘„çš„å‡†ç¡®è§’åº¦ã€‚ç„¶åï¼Œæˆ‘å°±å¯ä»¥ç§¯æä¸»åŠ¨åœ°åˆ©ç”¨è¿™äº›ä¿¡æ¯ï¼Œå˜å¾—æ›´å¥½ã€‚

*å˜¶ï¼è¿™ä¸€åˆ‡çš„ä»£ç éƒ½åœ¨æˆ‘çš„* [*Github*](https://github.com/ZackAkil/optimising-basketball) ä¸Š

# ä»»åŠ¡ 1:æ”¶é›†æ•°æ®

![](img/8d99fb323a69b04215810d88c7f89c86.png)

I didnâ€™t need to follow the seems of the ball, but it looks cool

æˆ‘æ²¡æœ‰é…å¤‡ 200 ä¸ªæ‘„åƒå¤´çš„ 3D è¿½è¸ªå·¥ä½œå®¤ï¼Œä½†æˆ‘æœ‰ Ebayã€‚ç½‘ä¸Šä¹°[åå…‰å¸¦](https://www.google.com/search?q=reflective+tape)è´´åœ¨çƒä¸Šè¿˜æ˜¯æŒºå®¹æ˜“çš„ã€‚ç„¶å(ç”±äºæˆ‘å½“åœ°çš„çƒåœºç¼ºä¹ç…§æ˜)ï¼Œæˆ‘å¯ä»¥å½•ä¸‹ä¸€äº›æˆ‘æ™šä¸Šç»ƒä¹ çš„é•œå¤´ï¼Œå¹¶æ•æ‰çƒçš„è¿åŠ¨ã€‚

æˆ‘æ‰‹æœºå†…ç½®çš„æ‰‹ç”µç­’æä¾›äº†å®Œç¾çš„å…‰æºæ¥åå°„çƒçš„åå…‰ã€‚

å› æ­¤ï¼Œæ•æ‰åˆ°çš„é•œå¤´æ˜¾ç¤ºäº†ä¸€ä¸ªé—ªé—ªå‘å…‰çš„ç‰©ä½“é£è¿‡ä¸€ä¸ªå‡ ä¹é»‘æš—çš„åœºæ™¯ï¼Œéå¸¸é€‚åˆåœ¨ python ä¸­è¿›è¡Œä¸€äº›å›¾åƒå¤„ç†ã€‚

# ä»»åŠ¡ 2:å°†æˆ‘ä»¬çš„è§†é¢‘å¯¼å…¥ python

é¦–å…ˆï¼Œæˆ‘ç”¨ Python åšæ‰€æœ‰äº‹æƒ…ï¼Œå°†è§†é¢‘å¯¼å…¥ Python çš„ä¸€ä¸ªéå¸¸ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªåä¸º' [scikit-video](http://www.scikit-video.org) 'çš„åº“ï¼Œæ‰€ä»¥æˆ‘å®‰è£…äº†:

```
pip install scikit-video
```

ç„¶åç”¨å®ƒæ¥åŠ è½½æˆ‘çš„è§†é¢‘ä½œä¸ºä¸€ä¸ªçŸ©é˜µ:

```
from skvideo.io import vreadvideo_data = vread('VID_20180930_193148_2.mp4')
```

è¿™ä¸ªæ•°æ®çš„å½¢çŠ¶(å¯ä»¥é€šè¿‡è¿è¡Œ **video_data.shape** æ‰¾åˆ°)æ˜¯(220ï¼Œ1080ï¼Œ1920ï¼Œ3)ã€‚è¿™æ„å‘³ç€ 3 ä¸ªé¢œè‰²é€šé“(çº¢ã€ç»¿ã€è“)çš„ 1080Ã—1920 åƒç´ çš„ 220 å¸§:

![](img/493a2e9b7fc191f710e43a64b6e94714.png)

raw video data

# ä»»åŠ¡ 3:æå–é•œå¤´(å›¾åƒå¤„ç†)

æ‰€ä»¥æˆ‘æƒ³å¾—åˆ°çƒè¿åŠ¨çš„æ•°æ®ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™æ˜¯è§†é¢‘ä¸­å”¯ä¸€ä¼šåŠ¨çš„ä¸œè¥¿ä¹‹ä¸€ã€‚æ‰€ä»¥æˆ‘å¯ä»¥åšæˆ‘æœ€å–œæ¬¢çš„è§†é¢‘å¤„ç†æŠ€å·§:**å¢é‡å¸§æå–**ï¼(*æˆ‘å°±æ˜¯è¿™ä¹ˆå«çš„ï¼Œä¸è¿‡å¯èƒ½è¿˜æœ‰å¦å¤–ä¸€ä¸ªåå­—*)ã€‚

é€šè¿‡ä»ä¸‹ä¸€å¸§ä¸­çš„æ‰€æœ‰åƒç´ å€¼ä¸­å‡å»ä¸€å¸§ä¸­çš„æ‰€æœ‰åƒç´ å€¼ï¼Œæ‚¨å°†åªåœ¨å·²ç»æ”¹å˜çš„åƒç´ ä¸­å¾—åˆ°éé›¶å€¼ã€‚

![](img/8dfe0fd2a8081bd23a5753c53465cba6.png)

calculating delta frame in order to isolate moving pixels

é…·é…·é…·ï¼Œç°åœ¨æˆ‘å¯¹è§†é¢‘ä¸­çš„æ¯ä¸€å¸§éƒ½è¿™æ ·åšï¼Œå¹¶å°†ç»“æœåˆå¹¶æˆä¸€å¹…å›¾åƒ:

![](img/fce1d74c6f1c94675ec296aa6ddad116.png)

adding together all of the delta frames from the video sequence

æ¥ä¸‹æ¥æ˜¯å°†æ‹æ‘„æ•°æ®æå–æˆå¯ç”¨çš„æ ¼å¼ã€‚æ‰€ä»¥æˆ‘ä»¬å°†æŠŠç²¾ç®€åçš„åƒç´ å€¼è½¬æ¢æˆä¸€ä¸ªç”±***ã€xã€‘***å’Œ ***y*** ç‚¹ç»„æˆçš„åˆ—è¡¨ã€‚å®Œæˆè¿™é¡¹å·¥ä½œçš„ä»£ç æ˜¯ä¸€ä¸ªåä¸º [**numpy.where**](https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.where.html) çš„ numpy å‡½æ•°ï¼Œå®ƒå°†åœ¨ä¸€ä¸ªæ•°ç»„ä¸­æ‰¾åˆ°æ‰€æœ‰**ä¸ºçœŸ**çš„å€¼ï¼Œå¹¶è¿”å›å®ƒä»¬çš„ç´¢å¼•(å³å®ƒä»¬åœ¨çŸ©é˜µä¸­çš„ä½ç½®)ã€‚

ä½†åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å°†å¿«é€Ÿè£å‰ªå‡ºçƒçš„è½¨è¿¹å¹¶ç¿»è½¬æ•°æ®ï¼Œä½¿å…¶ä»åŸç‚¹(åœºæ™¯çš„å·¦ä¸‹æ–¹)å¼€å§‹:

![](img/518b091a85aa4d36a4e7aac7b5418079.png)

ç”±æ­¤äº§ç”Ÿçš„å›¾åƒ:

![](img/2a4f20af2fa3827aa7373a96e7aaaad5.png)

æ³¨æ„åˆ°å®ƒçœ‹èµ·æ¥è¿˜æ˜¯ä¸Šä¸‹é¢ å€’äº†å—ï¼Ÿè¿™åªæ˜¯å› ä¸ºå›¾åƒå€¾å‘äºä»å·¦ä¸Šè§’çš„**å¼€å§‹ç»˜åˆ¶(æ³¨æ„è½´ç¼–å·)ã€‚å½“æˆ‘ä»¬å°†åƒç´ è½¬æ¢ä¸ºæ•°æ®ç‚¹å¹¶å°†å®ƒä»¬ç»˜åˆ¶åœ¨æ™®é€šå›¾ä¸Šæ—¶ï¼Œå®ƒä»¬å°†ä»åº•éƒ¨çš„**å·¦ä¸‹è§’å¼€å§‹ç»˜åˆ¶ã€‚****

ç°åœ¨æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„ **numpy.where** ä»£ç æ¥è·å–åƒç´ ä½œä¸ºæ•°æ®ç‚¹:

```
pixels_that_are_not_black = cropped_trail.sum(axis=2) > 0y_data, x_data = numpy.where(pixels_that_are_not_black)
```

![](img/616d19c2823b0173810a3e2be8caf0b3.png)

awesome! our relatively clean ball trajectory data

# ä»»åŠ¡ 4:æ„å»ºå¼ é‡æµæ¨¡å‹

è¿™å°±æ˜¯ TensorFlow å¤§æ”¾å¼‚å½©çš„åœ°æ–¹ã€‚ä½ å¯èƒ½ä¹ æƒ¯äºå¬è¯´ä½¿ç”¨ TensorFlow æ¥æ„å»ºç¥ç»ç½‘ç»œï¼Œä½†ä½ å¯ä»¥å®šä¹‰å‡ ä¹ä»»ä½•æ•°å­¦å…¬å¼ï¼Œå¹¶å‘Šè¯‰å®ƒä¼˜åŒ–ä½ æƒ³è¦çš„ä»»ä½•éƒ¨åˆ†ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»å°å­¦å°±çŸ¥é“çš„è½¨è¿¹å…¬å¼:

![](img/e44c992515a3e914b5abc025881e94b8.png)

extremely mathematical equation of trajectory that I found online

**Î¸** (theta)æ˜¯æ‹æ‘„çš„è§’åº¦(*æˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„å€¼*)

***v*** æ˜¯åˆé€Ÿåº¦

***g*** æ˜¯é‡åŠ›(9.8m/s)

***x*** æ˜¯æ°´å¹³ä½ç½®(*æ•°æ®æˆ‘ä»¬å·²ç»*)

***y*** æ˜¯å‚ç›´ä½ç½®(*æ•°æ®æˆ‘ä»¬å·²ç»*)

ä¸€ä¸ªæ›´æœ‰è¶£çš„æ–¹å¼æ¥çœ‹è¿™ä¸ªæ–¹ç¨‹çš„ä½œç”¨æ˜¯ç”¨[è¿™ä¸ªè½¨è¿¹å·¥å…·](https://www.desmos.com/calculator/gjnco6mzjo)æ¥ç©ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘å‡»çƒçš„çƒè½¨è¿¹ä½œä¸º ***x*** å’Œ*y**æ–¹ç¨‹å’Œä»»åŠ¡å¼ é‡æµï¼Œæ‰¾åˆ°é€‚åˆæˆ‘å‡»çƒçš„æ­£ç¡®è§’åº¦( **Î¸** )å’Œåˆå§‹é€Ÿåº¦( ***v*** )*

*æˆ‘ä»¬å°†å¼€å§‹åœ¨å¼ é‡æµä¸­é‡å»ºæˆ‘ä»¬çš„è½¨è¿¹æ–¹ç¨‹:*

*é¦–å…ˆå‘Šè¯‰å®ƒï¼Œå½“æˆ‘ä»¬è¿è¡Œä¼˜åŒ–æ—¶ï¼Œæˆ‘ä»¬å°†è¾“å…¥ä»€ä¹ˆæ•°æ®:*

```
*x = tf.placeholder(tf.float32, [**None**, 1])
y = tf.placeholder(tf.float32, [**None**, 1])*
```

*æ¥ä¸‹æ¥ï¼Œå‘Šè¯‰å®ƒæˆ‘ä»¬å¸Œæœ›å®ƒè°ƒæ•´å“ªäº›å˜é‡ï¼Œä»¥ä½¿è½¨è¿¹æ›²çº¿ç¬¦åˆæˆ‘ä»¬çš„æ•°æ®:*

```
*angle_variable = tf.Variable(40.0, name='angle_variable')
force_variable = tf.Variable(100.0, name='force_variable')

gravity_constant = tf.constant(9.8, name='gravity_constant')*
```

*å¹¶å°†æ‰€æœ‰è¿™äº›ç»“åˆåœ¨ä¸€èµ·(**è­¦å‘Š**:è¿™çœ‹èµ·æ¥ä¼šå¾ˆä¹±ï¼Œä½†è¿™åªæ˜¯ä¹‹å‰çœ‹åˆ°çš„ç”¨ TensorFlow è¯­æ³•ç¼–å†™çš„æ•°å­¦æ–¹ç¨‹):*

```
*left_hand_side = x * tf.tan(deg2rad(angle_variable))
top = gravity_constant * x ** 2
bottom = (2*(force_variable)**2) * 
            (tf.cos(deg2rad(angle_variable))**2)output = left_hand_side - (top / bottom)*
```

*ç„¶åå‘Šè¯‰ TensorFlow å¦‚ä½•åˆ¤æ–­å®ƒåœ¨å°†è½¨è¿¹å‡½æ•°æ‹Ÿåˆåˆ°æˆ‘ä»¬çš„æ•°æ®æ—¶æ˜¯å¦åšå¾—å¾ˆå¥½:*

```
*# the lower this score, the better
error_score = tf.losses.mean_squared_error(y, output)*
```

*åˆ›å»ºä¸€ä¸ªä¼˜åŒ–å™¨ï¼Œå¯¹å˜é‡(angle_variable å’Œ force_variable)è¿›è¡Œå®é™…è°ƒæ•´ï¼Œä»¥é™ä½ error_score:*

```
*optimiser = tf.train.AdamOptimizer(learning_rate=5) 
optimiser_op = optimiser.minimize(error_score)*
```

# *ä»»åŠ¡ 5:é­”æ³•*

*æˆ‘ä»¬ç°åœ¨å¯ä»¥è¿è¡Œä¼˜åŒ–ä»»åŠ¡æ¥æ‰¾åˆ°é€‚åˆæˆ‘çš„é•œå¤´çš„**è§’åº¦å˜é‡**å’Œ**åŠ›å˜é‡**å€¼ã€‚*

```
*sess = tf.Session()
sess.run(tf.global_variables_initializer())# do 150 steps of optimisation
for i in range(150): sess.run([optimiser_op], 
             feed_dict={x: np.array(x_data).reshape(-1, 1), 
                        y: np.array(y_data).reshape(-1, 1)})found_angle = sess.run(angle_constant.value())print(found_angle)*
```

*![](img/c741125aa9df7d4feb755e1a4ff84f55.png)*

*TensorFlow finding the angle of my shot*

*åœ¨ä¼˜åŒ–çš„æœ€åï¼Œæˆ‘ä»¬å‘ç°æœ€ç¬¦åˆæˆ‘çš„æ‹æ‘„æ•°æ®çš„è½¨è¿¹å‡½æ•°çš„è§’åº¦çº¦ä¸º 61 åº¦â€¦ä¸çŸ¥é“å¦‚ä½•å¤„ç†è¿™äº›ä¿¡æ¯â€¦æˆ‘æƒ³æˆ‘å¯ä»¥çœ‹çœ‹ä¸“ä¸šæ‹æ‘„è§’åº¦æ˜¯ä»€ä¹ˆï¼Œä»¥ä¾¿è¿›è¡Œæ¯”è¾ƒâ€¦å¾…ç»­ã€‚*

> *è¦å¸å–çš„æ•™è®­:ä½ æ€»æ˜¯å¯ä»¥ç”¨å®Œå…¨ä¸å¿…è¦(ä½†æœ‰è¶£)çš„æœºå™¨å­¦ä¹ æ¥åˆ†æ•£æ³¨æ„åŠ›ã€‚*

*æˆ‘ä½¿ç”¨çš„æ‰€æœ‰ä»£ç éƒ½å¯ä»¥åœ¨æˆ‘çš„ Github ä¸Šæ‰¾åˆ°:*

*[](https://github.com/ZackAkil/optimising-basketball) [## ZackAkil/ä¼˜åŒ–-ç¯®çƒ

### ç”¨å¼ é‡æµå’Œå›¾åƒå¤„ç†åˆ†ææˆ‘çš„ç¯®çƒæŠ€æœ¯ã€‚-ZackAkil/ä¼˜åŒ–-ç¯®çƒ

github.com](https://github.com/ZackAkil/optimising-basketball)*